(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1007:function(t,e,o){},1045:function(t,e,o){"use strict";o(1091);var n=o(30),component=Object(n.a)({},(function(){var t=this.$createElement;return(this._self._c||t)("span",{staticClass:"video-label"},[this._v("视频")])}),[],!1,null,"5e209804",null);e.a=component.exports},1091:function(t,e,o){"use strict";o(1007)},1203:function(t,e,o){},1204:function(t,e,o){},1247:function(t,e,o){"use strict";o(16),o(15),o(11),o(6),o(14),o(39);var n=o(0),r=o(4),c=o(84),l=o(68),h=o(858),d=o(178),f=o(1313),v=o(943),_=o(1045),m=o(219);function k(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function C(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var w={props:["info","newuser","inSearchFeed","searchWord","inCourseSearch"],data:function(){return{observer:null,isMobile:!1,defaultBookThumbUrl:l.c,actionItem:{more:{active:!1}}}},components:{VideoLabel:_.a,SaleTooltip:f.a,Avatar:d.a,Thumb:h.a},computed:C(C({isVideoCourse:function(){var t,e;return(null===(e=null===(t=this.info)||void 0===t?void 0:t.base_info)||void 0===e?void 0:e.course_type)===m.a.video},selfDescription:function(){return this.$userPosition(this.author)},showSearchMore:function(){return"/search"===this.$route.path&&"12"!==this.$route.query.type},userWroteBookView:function(){return"user"===this.$route.name&&"wrote"===this.$route.query.type},hidePrice:function(){return"bookWapBought"===this.$route.name},hasDiscount:function(){return Object(v.c)(this.info.discount)},isMobileBrowser:function(){return this.$device.isMobile}},Object(c.mapGetters)({user:r.USER})),{},{isAdmin:function(){var t,e=this.user||{};return null===(t=null==e?void 0:e.roles)||void 0===t?void 0:t.isAdmin},isEditor:function(){var t=this.user||{};return this.author.id===t.id},routeCoursePage:function(){var t=this.info,e=t.id,o={name:"",params:{}},n=t.readLog||{},r=n.sectionId,c=n.sign;if(r){var l=this.isMobileBrowser;o={name:this.isVideoCourse?l?"videoCourseWapSection":"videoCourseSection":l?"bookWapSection":"bookSection",params:{id:e,sectionId:r},hash:c}}else o={name:this.isVideoCourse?"videoCourseInfo":"bookInfo",params:{id:e}};return o},author:function(){var t={},e=this.info.user;return e&&(t=Object.assign(e,{id:e.user_id})),t},visibleReview:function(){return 1===this.info.verifyStatus&&"user"===this.$route.name},visibleOrderEntry:function(){var t;return"user"===this.$route.name&&this.info.user.id===(null===(t=this.user)||void 0===t?void 0:t.id)},isFree:function(){return this.info&&0===this.info.price}}),filters:{f_bookInfo:function(t){return{name:"bookInfo",params:{id:t.id}}},f_duration:function(t){if(t<0||!t)return"0秒";if(0<=t&&t<60)return t+"秒";var e=Math.floor(t/60),s=Math.floor(t%60);return s>0?e+"分"+s+"秒":e+"分"}},methods:{computeSalePrice:v.a,clickBook:function(){var t,e=this.info;this.$TEA("book_card_click",{is_purchased:(null==e?void 0:e.isBuy)?1:0,book_id:e.booklet_id,book_price:e.base_info.price,book_category:null===(t=e.base_info)||void 0===t?void 0:t.category_id,author_id:this.author.id,is_presale:e.isFinished?0:1,book_discount:this.hasDiscount?this.info.discount.rate:10,page:"courseIndex"===this.$route.name?"homepage_books":"homepage_user"})},gotoEditView:function(){var t=this.info.id;window.open("/editor/".concat(this.isVideoCourse?"video":"book","/").concat(t,"/section"),"_self")},buyBook:function(){this.isAdmin||this.isEditor||this.$emit("buyBook",this.info)},toggleActivateActionItem:function(t){var e=this;Object.keys(this.actionItem).forEach((function(o){e.actionItem[o].active=t===o&&!e.actionItem[o].active}))},gotoOrderView:function(t){window.open("/book/order/".concat(t),"_blank")},goToList:function(t){t.preventDefault(),this.$router.push({query:C(C({},this.$route.query),{},{type:12})})},handleBookVisible:function(t){if(t){var e=this.info;this.$TEA("book_card_display",{book_id:e.booklet_id,is_purchased:(null==e?void 0:e.isBuy)?1:0,book_price:e.base_info.price,book_category:e.base_info.category_id,author_id:this.author.id,is_presale:e.isFinished?0:1,book_discount:this.hasDiscount?this.info.discount.rate:10,page:"courseIndex"===this.$route.name?"homepage_books":"homepage_user"})}}},mounted:function(){var t=this,e=this.$getBean("eventBus");e.onVmLife(this,e.eventType.ROOT_CONTAINER_CLICK,(function(){Object.keys(t.actionItem).forEach((function(e){t.actionItem[e].active=!1}))})),this.isMobile=document.body.clientWidth<960||this.isMobileBrowser}},y=(o(1331),o(30)),component=Object(y.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"visible-change",rawName:"v-visible-change.once",value:t.handleBookVisible,expression:"handleBookVisible",modifiers:{once:!0}}],on:{click:t.clickBook}},[n("app-link",{staticClass:"item",class:{search:t.inSearchFeed&&!t.inCourseSearch},attrs:{tag:"div",to:t.routeCoursePage,blank:!0,"data-book-id":t.info.id}},[n("div",{staticClass:"poster"},[n("thumb",{staticClass:"poster-img",attrs:{alt:"「"+t.info.title+"」封面",url:t.info.cover,default:t.defaultBookThumbUrl,quality:95,width:100,height:140}}),t._v(" "),t.isVideoCourse?n("VideoLabel"):t._e()],1),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"title"},[t.info.is_new?n("span",{staticClass:"presale"},[t._v("新品")]):t._e(),t._v(" "),t.info.canVipBorrow?n("div",{staticClass:"vip-icon"},[t._v("VIP")]):t._e(),t._v(" "),n("TextHighlight",{attrs:{text:t.info.title,enableHighlight:!!t.inSearchFeed,keyword:t.searchWord,"highlight-class":"keyword"}})],1),t._v(" "),n("TextHighlight",{staticClass:"desc",attrs:{text:t.info.abstract,enableHighlight:!!t.inSearchFeed,keyword:t.searchWord,"highlight-class":"keyword"}}),t._v(" "),n("div",{staticClass:"author"},[n("div",{staticClass:"author-info",on:{click:function(t){t.stopPropagation()}}},[n("object",[n("app-link",{staticClass:"xiaoce-user",attrs:{to:t.$userRoute(t.author),blank:!0,"st:name":"author","st:state":t.author.id}},[n("avatar",{staticClass:"hero",attrs:{user:t.author,alt:t.author.username+"的头像"}}),t._v(" "),n("username",{staticClass:"author-name",attrs:{user:t.author}})],1)],1)]),t._v(" "),n("div",{staticClass:"author-desc"},[n("span",{staticClass:"self-description"},[t._v("\n            "+t._s(t.selfDescription)+"\n          ")])])]),t._v(" "),n("div",{staticClass:"other"},[n("object",[n("app-link",{staticClass:"full-link",attrs:{tag:"div",to:t.routeCoursePage,blank:!0}})],1),t._v(" "),!t.info.isBuy&&t.info.price>0?n("div",{staticClass:"price",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.buyBook(e)}}},[t.newuser&&!t.hasDiscount?n("div",{staticClass:"price-newuser"},[n("span",[t._v("￥"+t._s(t.computeSalePrice(t.info.price,5)))]),t._v(" "),n("span",{staticClass:"yuanjia"},[t._v("￥"+t._s(t.info.price)+" ")])]):n("div",{staticClass:"price-text"},[t._v("￥"+t._s(t.info.price))]),t._v(" "),t.hasDiscount?n("sale-tooltip",{style:{bottom:0},attrs:{"is-break":!0,info:t.info}}):t._e()],1):t._e(),t._v(" "),t.info.isBuy||0!==t.info.price?t._e():n("div",{staticClass:"price"},[t._v("免费")]),t._v(" "),t.info.isBuy&&!t.userWroteBookView?n("div",{staticClass:"price bought"},[t._v("\n          已购买\n        ")]):t._e(),t._v(" "),t.info.isBuy&&t.userWroteBookView?n("div",{staticClass:"price bought"},[0===t.info.price?n("span",[t._v("免费")]):n("span",[t._v("￥"+t._s(t.info.price)+" ")]),t._v(" "),t.hasDiscount?n("sale-tooltip",{style:{bottom:0},attrs:{"is-break":!0,info:t.info}}):t._e()],1):t._e(),t._v(" "),n("div",{staticClass:"messages"},[n("span",{class:{message:t.info.isFinished}},[t._v("\n            "+t._s(t.info.isFinished?"已完结":"")+"\n          ")]),t._v(" "),n("span",{staticClass:"message"},[n("span",[t._v("\n              "+t._s(t.info.isFinished?"":"已更新")+t._s(t.info.sectionCount||0)+"小节\n            ")])]),t._v(" "),t.isFree?t._e():n("span",{staticClass:"message"},[n("span",[t._v(t._s(t.info.buyerCount))]),t._v(" "),n("span",[t._v("人已购买")])])]),t._v(" "),t.showSearchMore&&!t.isMobile?n("div",{staticClass:"go-to-list",attrs:{"data-tea":"book"},on:{click:t.goToList}},[t._v("\n          更多课程>\n        ")]):t._e()]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.visibleReview,expression:"visibleReview"}],staticClass:"review"},[t._v("审核中")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.hasDiscount,expression:"hasDiscount"}],staticClass:"footer-bar"})],1),t._v(" "),t.isEditor?n("div",{staticClass:"more",class:{open:t.actionItem.more.active},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleActivateActionItem("more")}}},[n("img",{staticClass:"more-icon",attrs:{src:o(1328)}}),t._v(" "),n("ul",{staticClass:"more-list"},[n("li",{staticClass:"item",on:{click:t.gotoEditView}},[t._v("编辑")]),t._v(" "),t.visibleOrderEntry?n("li",{staticClass:"item",on:{click:function(e){return t.gotoOrderView(t.info.id)}}},[t._v("\n          查看订单数据\n        ")]):t._e()])]):t._e(),t._v(" "),t.hidePrice?t._e():n("div",{staticClass:"m-aside"},[!t.info.isBuy&&t.info.price>0?n("div",{staticClass:"price",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.buyBook(e)}}},[t._v("\n        ￥"+t._s(t.info.price)+"\n        "),t.hasDiscount?n("sale-tooltip",{staticClass:"tooltip",attrs:{"is-break":!0,info:t.info,direction:"right"}}):t._e()],1):t._e(),t._v(" "),!t.info.isBuy&&t.isFree?n("div",{staticClass:"price"},[t._v("免费")]):t._e(),t._v(" "),t.info.isBuy?n("div",{staticClass:"price bought"},[t._v("已购")]):t._e()])])],1)}),[],!1,null,"51afd9f7",null);e.a=component.exports},1313:function(t,e,o){"use strict";var n=o(943);function r(t){return t<10?"0".concat(t):t}var c={props:["info","direction","isBreak"],data:function(){return{date:{days:0,hours:0,minutes:0,seconds:0},timerDate:null,timerMS:null,MS:99,salePrice:0}},computed:{discountInfo:function(){return this.info.discount},toolClass:function(){return[this.direction?this.direction:"left",this.isBreak?"break-text":""]},showText:function(){return"限时优惠价 ".concat(this.salePrice," 元")},countDownText:function(){var t=this.date,e=t.days,o=t.hours,n=t.minutes,r=t.seconds;return"倒计时 ".concat(e," 天 ").concat(o,":").concat(n,":").concat(r)},showMSText:function(){var t=this.MS;return".".concat(r(t))}},methods:{computedTime:function(){var t=+new Date,e=this.discountInfo.endTime-t;if(e>0){var o=Math.floor(e/1e3/60/60/24),n=Math.floor(e/1e3/60/60%24),c=Math.floor(e/1e3/60%60),l=Math.floor(e/1e3%60);n=r(n),c=r(c),l=r(l),this.date={days:o,hours:n,minutes:c,seconds:l}}else clearInterval(this.timerMS),this.MS=0,window.location.reload();this.timerMS||this.runMSCountDown()},runDateCountDown:function(){var t=this;this.timerDate=setInterval((function(){t.computedTime()}),1e3)},runMSCountDown:function(){var t=this;this.timerMS=setInterval((function(){var e=t.MS;e>0?e-=1:e=99,t.MS=e}),10)}},mounted:function(){var t=this.discountInfo.rate;t&&(this.computedTime(),this.runDateCountDown(),this.salePrice=Object(n.a)(this.info.price,t))},beforeDestroy:function(){clearInterval(this.timerDate),clearInterval(this.timerMS)}},l=(o(1330),o(30)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tooltip",class:t.toolClass},[n("span",{staticClass:"pre-text is-count-down"},[n("img",{staticClass:"gift",attrs:{src:o(1329)}}),t._v(" "),n("span",[t._v(t._s(t.showText))])]),t._v(" "),n("span",{staticClass:"count-down"},[n("span",[t._v(t._s(t.countDownText))]),t._v(" "),n("div",{staticClass:"ms"},[t._v(t._s(t.showMSText))])])])}),[],!1,null,"4a6ac94a",null);e.a=component.exports},1328:function(t,e,o){t.exports=o.p+"3f349bb73a7294ed233c7cce27d1596d.svg"},1329:function(t,e,o){t.exports=o.p+"img/gift.9a8f3aa.png"},1330:function(t,e,o){"use strict";o(1203)},1331:function(t,e,o){"use strict";o(1204)},943:function(t,e,o){"use strict";o.d(e,"a",(function(){return n})),o.d(e,"c",(function(){return r})),o.d(e,"b",(function(){return c}));o(45),o(135),o(83),o(21),o(22),o(6);function n(t,e){if(0===t)return 0;var o=function(t,e){var o,n,r=0,c=t.toString(),l=e.toString();try{r+=(null===(o=c.split(".")[1])||void 0===o?void 0:o.length)||0}catch(t){console.error(t)}try{r+=(null===(n=l.split(".")[1])||void 0===n?void 0:n.length)||0}catch(t){console.error(t)}c=Number(c.replace(".","")),l=Number(l.replace(".",""));var h=c*l/Math.pow(10,r),d=e>0?.01:0;return Math.max(d,h)}(t,isNaN(e)?1:e/10);return 0===o?0:o.toFixed(2)}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{startTime:0,endTime:0},e=t.startTime,o=t.endTime,time=(new Date).getTime();return time>e&&time<o}function c(t){if(t<0||!t)return"0秒";if(0<=t&&t<60)return t+"秒";var e=Math.floor(t/60),s=Math.floor(t%60);return s>0?e+"分"+s+"秒":e+"分"}}}]);