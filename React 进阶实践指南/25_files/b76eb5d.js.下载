/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[58,2,4,6,149,152],{1004:function(e,t,r){"use strict";r(925)},1005:function(e,t,r){"use strict";r.r(t);r(138),r(45),r(23);var n=r(5),o=r(26),c=r(878),l=r(1100),d=r(1106),f=r.n(d),h=r(1107),v=r.n(h),m=r(1123),y=r(1108),_=r.n(y),w=r(1109),E=r.n(w),T=r(1110),S=r.n(T),O=r(1111),C=r.n(O),k=r(1112),L=r.n(k),A=r(1117),R=r.n(A),x=r(959),P=r.n(x),D=r(1126),I=r(1104),j=r(4347),M=(r(70),r(15),r(52),r(69),r(39),r(21),r(22),r(136),r(11),r(6),r(14),r(44),r(55),r(1022)),html=r(4260),F=r(271);function B(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw o}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var N=1512*r(68).l;function V(e,t){var r;e.properties.src=Object(F.d)((null===(r=e.properties)||void 0===r?void 0:r.src)||"",N,0,{supportWebP:t},"zoomInCrop"),e.properties.loading="lazy"}var H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copyable,r=e.supportWebP,n=void 0!==r&&r;return function(e,r){var c,l,d="juejin",f=null===(c=r.frontmatter)||void 0===c?void 0:c.theme;Object.keys(P.a).includes(f)&&(d=f),null===(l=e.children)||void 0===l||l.unshift({type:"element",tagName:"style",children:[{type:"text",value:P.a[d].style}]});var h=0;Object(M.a)(e,"element",(function(e,r,c){var l;switch(e.properties||(e.properties={}),e.tagName){case"a":var p=e.properties||{},d=p.href||"";d&&!d.toString().startsWith("#")&&(p.target="_blank"),p.title=d;var f=e.children;if(f&&f[0]&&"text"===f[0].type){/^(https?:\/\/)?[-a-z0-9@:%._+~#=]{1,256}\.[a-z]{2,6}/i.test(f[0].value)&&(f[0].value=f[0].value.replace(/^https?:\/\//i,"").replace(/\/(.*)$/,(function(e){return e.length>12?"".concat(e.slice(0,12),"…"):e})))}Object(o.e)(d)&&(p.ref="nofollow noopener noreferrer",p.href=Object(o.h)(d)?Object(o.d)(d):d);break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":e.properties["data-id"]="heading-".concat(h++);break;case"img":V(e,n);break;case"code":if(!c||"pre"!==c.tagName)return;e.properties.className=null!==(l=e.properties.className)&&void 0!==l?l:[];var v,m=e.properties.className;t&&!m.includes("language-mermaid")&&(m.push("copyable"),e.children.push(Object(html.a)("span.copy-code-btn",["复制代码"])));var y,_=B(m);try{for(_.s();!(y=_.n()).done;){var w=y.value;if("lang-"===w.slice(0,5)){v=w.slice(5);break}if("language-"===w.slice(0,9)){v=w.slice(9);break}}}catch(e){_.e(e)}finally{_.f()}v&&(e.properties.lang=v)}}))}},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.supportWebP,r=void 0!==t&&t;return function(e){Object(M.a)(e,"element",(function(e){switch(e.properties||(e.properties={}),e.tagName){case"img":V(e,r)}}))}},K=r(1118),$=r(8),W=r(1102),z=r(960),Y=r(1119),X=r.n(Y),Z=r(157),J=r(972),Q=r.n(J),ee=r(973),te=r.n(ee),re=r(974),ie=r.n(re),ne=r(975),oe=r.n(ne),ae=(r(1120),Object($.d)({components:{Viewer:l.b},data:function(){return{sanitize:z.c,commonPlugins:(component=this,[S()(),f()({languages:z.b,subset:z.a}),_()(),Object(m.a)(),E()(),L()(),v()({background:"rgba(0,0,0,0.7)"}),C()({test:o.e,internalProps:{target:"_blank"}}),Object(K.viewer)({auditingBackground:component.$device.isMobile?te.a:Q.a,loadingBackground:component.$device.isMobile?oe.a:ie.a}),{remark:function(p){return p.use(W.b)}},X()()])};var component},props:{markdown:{type:String},html:{type:String},copyable:{type:Boolean,default:!1},supportWebP:{type:Boolean,default:!1},cachedHtml:{type:String,default:""},needLoginBeforeCopyCode:{type:Boolean,default:!1},isLogined:{type:Boolean,default:!1}},computed:{withoutViewer:function(){return!!this.cachedHtml||!this.markdown},sanitizedHtml:function(){return this.cachedHtml?-1===this.cachedHtml.indexOf("webp")||this.supportWebP?this.cachedHtml:Object(D.a)().use(G,{supportWebP:this.supportWebP}).processSync(this.cachedHtml):this.html?Object(D.a)().use(I.a).use(j.a,{subset:z.a,languages:z.b}).use(H,{copyable:this.copyable,supportWebP:this.supportWebP}).processSync(this.html):this.cachedHtml||""},plugins:function(){var e=this,t={viewerEffect:function(e){var t,r,o=e.file,c=e.markdownBody;r=(null==o?void 0:o.frontmatter)&&"string"!=typeof o.frontmatter?o.frontmatter:{};var l=document.createElement("style");return null===(t=c||document.head)||void 0===t||t.appendChild(l),Object(n.a)(regeneratorRuntime.mark((function e(){var t,n,o,c,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=null!==(t=r.highlight)&&void 0!==t?t:null===(n=P.a[r.theme])||void 0===n?void 0:n.highlight,d=null!==(o=R.a[c])&&void 0!==o?o:R.a.github,e.next=4,d().then((function(e){return e.default}));case 4:f=e.sent,l.innerHTML=f;case 6:case"end":return e.stop()}}),e)})))(),function(){l.remove()}},rehype:function(u){return u.use(H,{copyable:e.copyable,supportWebP:e.supportWebP})}};return this.commonPlugins.concat(t)},remarkRehypeOptions:function(){return{handlers:Object.assign({},W.a)}}},mounted:function(){var e=this;this.withoutViewer&&this.plugins.forEach((function(p){var t;null===(t=p.viewerEffect)||void 0===t||t.call(p,{markdownBody:e.$el})}))},methods:{onContentElementClick:function(e){var t;if(this.copyable){var r=e.target;if("copy-code-btn"===r.className){var text=r.textContent||"",n=r.parentNode,content=null===(t=null==n?void 0:n.textContent)||void 0===t?void 0:t.replace(new RegExp("\n?".concat(text,"$")),"");try{if(this.needLoginBeforeCopyCode&&!this.isLogined)return this.$requestLogin(),void this.$TEA("login_guide_click",{from:Z.a.code});Object(c.a)(content||""),this.$alertMsg("代码复制成功")}catch(e){this.$error("代码复制失败")}}}}}})),se=(r(976),r(30)),ce=Object(se.a)(ae,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"article-content",on:{"!click":function(t){return e.onContentElementClick(t)}}},[!e.cachedHtml&&e.markdown?r("viewer",{attrs:{value:e.markdown,plugins:e.plugins,sanitize:e.sanitize,"remark-rehype":e.remarkRehypeOptions}}):r("div",{staticClass:"markdown-body",class:{cache:e.cachedHtml,html:e.html},domProps:{innerHTML:e._s(e.sanitizedHtml)}})],1)}),[],!1,null,null,null);t.default=ce.exports},1007:function(e,t,r){},1023:function(e,t,r){"use strict";r(953)},1024:function(e,t,r){"use strict";r(954)},1025:function(e,t,r){"use strict";r(955)},1045:function(e,t,r){"use strict";r(1091);var n=r(30),component=Object(n.a)({},(function(){var e=this.$createElement;return(this._self._c||e)("span",{staticClass:"video-label"},[this._v("视频")])}),[],!1,null,"5e209804",null);t.a=component.exports},1077:function(e,t,r){},1091:function(e,t,r){"use strict";r(1007)},1098:function(e,t,r){"use strict";r.d(t,"d",(function(){return h})),r.d(t,"a",(function(){return v})),r.d(t,"c",(function(){return y})),r.d(t,"b",(function(){return w}));r(23);var n=r(5),o=r(120),c=r(34),l=r(7),d=r(10),f=r(181);function h(e){var t=Object(f.j)({maxDurationMS:9e4}),r=t.stayDuration,h=t.isCancelled,v=t.cancel;function m(){return(m=Object(n.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h.value){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,o.a.AddPointReport({growth_type:c.GrowthType.JScore,task_id:c.GrowthTaskID.ViewContent,item_id:t});case 5:(r=e.sent).err_no!==d.ERROR_NO.OK?console.warn("error reportViewContentJScore reason:".concat(r.err_msg)):v(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.warn("error reportViewContentJScore err:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}Object(l.x)((function(){r.value>=9e4&&function(e){m.apply(this,arguments)}(e)}))}function v(){return m.apply(this,arguments)}function m(){return(m=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.AddPointReport({growth_type:c.GrowthType.JScore,task_id:c.GrowthTaskID.BindPhone,item_id:"0"});case 3:(t=e.sent).err_no!==d.ERROR_NO.OK&&console.warn("error reportBindPhoneJScore reason:".concat(t.err_msg)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("error reportBindPhoneJScore err:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function y(){return _.apply(this,arguments)}function _(){return(_=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.AddPointReport({growth_type:c.GrowthType.JScore,task_id:c.GrowthTaskID.UploadFavicon,item_id:"0"});case 3:(t=e.sent).err_no!==d.ERROR_NO.OK&&console.warn("error reportUploadAvatarJScore reason:".concat(t.err_msg)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("error reportUploadAvatarJScore err:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function w(){return E.apply(this,arguments)}function E(){return(E=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.AddPointReport({growth_type:c.GrowthType.JScore,task_id:c.GrowthTaskID.ModifyScreenName,item_id:"0"});case 3:(t=e.sent).err_no!==d.ERROR_NO.OK&&console.warn("error reportModifyScreenNameJScore reason:".concat(t.err_msg)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("error reportModifyScreenNameJScore err:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}},1116:function(e,t,r){var map={"./locale":968,"./locale.js":968};function n(e){var t=o(e);return r(t)}function o(e){if(!r.o(map,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return map[e]}n.keys=function(){return Object.keys(map)},n.resolve=o,e.exports=n,n.id=1116},1128:function(e,t,r){},1167:function(e,t,r){e.exports=r.p+"5e2cfe768dbb98a0bf497ff46eec11fe.svg"},1168:function(e,t,r){e.exports=r.p+"37ca4f63b2d6ce3142b550147fe4476c.svg"},1169:function(e,t,r){"use strict";r(1077)},1193:function(e,t,r){"use strict";var n=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"title"},[this._v("未登录")]),this._v(" "),t("div",{staticClass:"desc"},[this._v("注册或登录后即可继续操作")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("img",{attrs:{src:r(1167)}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("img",{attrs:{src:r(1168)}})])}],o=r(19),c={data:function(){return{show:!1}},computed:{isWechat:function(){return Object(o.f)()}},filters:{},methods:{loginWithWechat:function(){return this.$getBean("oauthBusiness").loginWithWechat()},close:function(){this.show=!1},authoLogin:function(){this.show=!1,this.$requestLogin()}},mounted:function(){var e=this,t=this.$getBean("eventBus");t.onVmLife(this,t.eventType.AUTH_WECHAT_QUICK_LOGIN,(function(){e.$requestLogin()}))}},l=(r(1169),r(30)),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.show?r("div",{staticClass:"wechat-quick-login"},[r("div",{staticClass:"quick-box"},[e._m(0),e._v(" "),r("div",{staticClass:"auth-box"},[r("div",{staticClass:"auth-btn wx",on:{click:e.loginWithWechat}},[e._m(1),e._v(" "),r("span",[e._v("微信快捷登录")])]),e._v(" "),r("div",{staticClass:"auth-btn jj",on:{click:e.authoLogin}},[e._m(2),e._v(" "),r("span",[e._v("稀土掘金账号登录")])])]),e._v(" "),r("div",{staticClass:"agreement-box"},[e._v("\n      注册登录即表示同意\n      "),r("a",{directives:[{name:"link",rawName:"v-link.blank",value:"/terms",expression:"'/terms'",modifiers:{blank:!0}}]},[e._v("用户协议")]),e._v("\n      、\n      "),r("a",{directives:[{name:"link",rawName:"v-link.blank",value:"/privacy",expression:"'/privacy'",modifiers:{blank:!0}}]},[e._v("隐私政策")])]),e._v(" "),r("div",{staticClass:"footer"},[r("div",{staticClass:"box",on:{click:e.close}},[e._v("取消")])])])]):e._e()}),n,!1,null,"3a1cf91f",null);t.a=component.exports},1194:function(e,t,r){"use strict";r(44),r(55);var n=r(7),o=r(177),c=r(24),l=r(179),d=r(104),f=Object(n.b)({components:{BTooltip:o.Tooltip},props:{bookInfo:{type:Object,default:function(){return{}}},eventPage:{type:String,default:""}},emits:["read","fetch"],setup:function(e,t){var r=Object(n.a)((function(){var e,r;return(null===(r=null===(e=t.root.$store.state)||void 0===e?void 0:e.auth)||void 0===r?void 0:r.user)||null})),o=t.root.$getBean("eventBus"),f=Object(n.u)(),h=Object(n.a)((function(){var t,n,o;if(e.bookInfo.isBorrowing){var c=null===(n=null===(t=e.bookInfo)||void 0===t?void 0:t.reading_progress)||void 0===n?void 0:n.last_section_id;return"0"!==c&&c?"继续学习":"立即学习"}return(null===(o=e.bookInfo)||void 0===o?void 0:o.borrowTimes)>0&&r.value.is_vip?"再次借阅":"VIP借阅"})),v=Object(n.a)((function(){return e.bookInfo.isBorrowing?"有效期至 ".concat(Object(c.a)(1e3*e.bookInfo.validEndTime,"YYYY-MM-DD")):"借过".concat(e.bookInfo.borrowTimes,"次")})),m=Object(n.f)("refreshBook",(function(){return null})),y=Object(d.b)((function(){t.emit("fetch"),m()}),500);Object(n.j)((function(){o.on(o.eventType.SHOW_VIP_FETCH,(function(){y()}))})),Object(n.k)((function(){o.off(o.eventType.SHOW_VIP_FETCH)}));return{buttonVipTitle:h,buttonVipDescript:v,handleClick:function(){var n={event_page:e.eventPage,book_id:e.bookInfo.id,author_id:e.bookInfo.user_info.user_id,platform:t.root.$device.isMobile?"h5":"web"};return t.root.$TEA("member_rent_click",n),r.value?r.value.isBindedPhone?void(e.bookInfo.isBorrowing?t.emit("read"):r.value.is_vip?o.emit(o.eventType.SHOW_VIP_BORROW_MODAL,e.bookInfo,n):f.push({name:"vipIndex",query:{utm_source:window.location.pathname.includes("section")?"course_section":"course_detail",utm_medium:"rent"}})):t.root.$requestBindPhoneNumber(l.b,{toUrl:location.href}):t.root.$requestLogin()},currentUser:r}}}),h=(r(1333),r(30)),component=Object(h.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vip-borrow-button"},[n("BTooltip",{staticClass:"tooltip",attrs:{content:"如果您下单购买了借阅中或曾经借阅过的课程，我们将把消耗的借阅卡退还给您，每门课程最多退还1张",theme:"light",placement:"bottom",disabled:!e.bookInfo.isBorrowing||e.$device.isMobile,"max-width":"244px"}},[e.bookInfo.canVipBorrow?n("div",{staticClass:"vip-borrow",on:{click:e.handleClick}},[e.bookInfo.isBorrowing?n("img",{staticClass:"mark",attrs:{src:r(1332),alt:"借阅中"}}):e._e(),e._v(" "),n("div",{staticClass:"title"},[e._v(e._s(e.buttonVipTitle))]),e._v(" "),e.bookInfo.borrowTimes>0&&e.currentUser.is_vip?n("div",{staticClass:"descript"},[e._v("\n        "+e._s(e.buttonVipDescript)+"\n      ")]):e._e()]):e._e()])],1)}),[],!1,null,"150d6eee",null);t.a=component.exports},1205:function(e,t,r){},1211:function(e,t,r){},1252:function(e,t,r){"use strict";r(1128)},1286:function(e,t,r){"use strict";r(16),r(15),r(11),r(6),r(14);var n=r(0),o=r(278),c=r(84),l=r(4),d=r(178),f=r(50),h=r(296);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}var m={components:{Avatar:d.a,DropDownList:h.a},data:function(){return{bdPageUrlForNav:o.e,isShowUserDropdownList:!1,translateGithubURL:f.e}},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(c.mapGetters)({user:l.USER})),methods:{hideActionList:function(){this.isShowUserDropdownList=!1},onUserActionClick:function(){this.isShowUserDropdownList=!this.isShowUserDropdownList},openEditorPage:function(){var e=this.$getBean("editorBusiness");window.location.href=e.getPostEditUrl()},openXiaoceEditorPage:function(){var e=this.$getBean("editorBusiness");window.location.href=e.getXiaoceEditUrl()},openDraftIndexPage:function(){var e=this.$getBean("editorBusiness");window.location.href=e.getDraftIndexUrl()},login:function(){this.$requestLogin()},register:function(){this.$requestRegister()},logout:function(){window.confirm("确定登出吗？每一片贫瘠的土地都需要坚定的挖掘者！")&&this.$requestLogout()}},mounted:function(){var e=this,t=this.$getBean("eventBus");t.onVmLife(this,t.eventType.ROOT_CONTAINER_CLICK,(function(){e.hideActionList()}))},watch:{isShowUserDropdownList:function(e){e&&this.$TEA("avatar_menu_visit")}}},y=(r(1252),r(30)),component=Object(y.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-auth"},[e.user?r("div",{staticClass:"nav-item menu",on:{click:function(t){return t.stopPropagation(),e.onUserActionClick(t)}}},[r("avatar",{staticClass:"avatar",attrs:{user:e.user,decorative:!0,alt:e.user.username+"的头像"}}),e._v(" "),r("DropDownList",{attrs:{"is-show-user-dropdown-list":e.isShowUserDropdownList}})],1):e._e(),e._v(" "),e.user?e._e():r("div",{staticClass:"nav-item auth"},[r("span",{staticClass:"login",on:{click:e.login}},[e._v("登录")])])])}),[],!1,null,"27c6ac96",null);t.a=component.exports},1332:function(e,t,r){e.exports=r.p+"d9fd35ba8ea6d69f1746f621a0dd8433.svg"},1333:function(e,t,r){"use strict";r(1205)},1334:function(e,t,r){},1335:function(e,t,r){},1346:function(e,t){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){"use strict";var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,r){"use strict";var n=r(12)("wks"),o=r(13),i=r(0).Symbol,u="function"==typeof i;(e.exports=function(e){return n[e]||(n[e]=u&&i[e]||(u?i:o)("Symbol."+e))}).store=n},function(e,t,r){"use strict";var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t,r){"use strict";var n=r(4);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":n(e))?null!==e:"function"==typeof e}},function(e,t,r){"use strict";var n=r(6);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){"use strict";e.exports=!r(15)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,r){"use strict";var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,r){"use strict";var n=r(3),o=r(26),i=r(27),u=Object.defineProperty;t.f=r(7)?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return u(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";e.exports=!1},function(e,t,r){"use strict";var n=r(8),o=r(1)("toStringTag"),i="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,u;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?r:i?n(t):"Object"==(u=n(t))&&"function"==typeof t.callee?"Arguments":u}},function(e,t,r){"use strict";var n=r(2),o=r(0),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(10)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){"use strict";var n=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},function(e,t,r){"use strict";var n=r(9),o=r(28);e.exports=r(7)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";var n=r(4),o=r(0).document,i=n(o)&&n(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,r){"use strict";var n=r(0),o=r(14),i=r(18),u=r(13)("src"),c=r(29),s=(""+c).split("toString");r(2).inspectSource=function(e){return c.call(e)},(e.exports=function(e,t,r,c){var l="function"==typeof r;l&&(i(r,"name")||o(r,"name",t)),e[t]!==r&&(l&&(i(r,u)||o(r,u,e[t]?""+e[t]:s.join(String(t)))),e===n?e[t]=r:c?e[t]?e[t]=r:o(e,t,r):(delete e[t],o(e,t,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[u]||c.call(this)}))},function(e,t,r){"use strict";var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";var n,o,i,u=r(5),c=r(38),s=r(39),l=r(16),a=r(0),d=a.process,p=a.setImmediate,f=a.clearImmediate,h=a.MessageChannel,v=a.Dispatch,m=0,y={},_=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},w=function(e){_.call(e.data)};p&&f||(p=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return y[++m]=function(){c("function"==typeof e?e:Function(e),t)},n(m),m},f=function(e){delete y[e]},"process"==r(8)(d)?n=function(e){d.nextTick(u(_,e,1))}:v&&v.now?n=function(e){v.now(u(_,e,1))}:h?(i=(o=new h).port2,o.port1.onmessage=w,n=u(i.postMessage,i,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts?(n=function(e){a.postMessage(e+"","*")},a.addEventListener("message",w,!1)):n="onreadystatechange"in l("script")?function(e){s.appendChild(l("script")).onreadystatechange=function(){s.removeChild(this),_.call(e)}}:function(e){setTimeout(u(_,e,1),0)}),e.exports={set:p,clear:f}},function(e,t,r){"use strict";var n=r(6);function o(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new o(e)}},function(e,t,r){e.exports=r(23)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(24);var n,i=(n=r(48))&&n.__esModule?n:{default:n};t.default={url:i.default},e.exports=t.default},function(e,t,r){"use strict";var n,o,i,u,c=r(10),s=r(0),l=r(5),a=r(11),d=r(25),p=r(4),f=r(6),h=r(30),v=r(31),m=r(37),y=r(20).set,_=r(40)(),w=r(21),b=r(41),g=r(42),E=r(43),T=s.TypeError,S=s.process,O=S&&S.versions,C=O&&O.v8||"",k=s.Promise,L="process"==a(S),A=function(){},R=o=w.f,x=!!function(){try{var e=k.resolve(1),t=(e.constructor={})[r(1)("species")]=function(e){e(A,A)};return(L||"function"==typeof PromiseRejectionEvent)&&e.then(A)instanceof t&&0!==C.indexOf("6.6")&&-1===g.indexOf("Chrome/66")}catch(e){}}(),P=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},D=function(e,t){if(!e._n){e._n=!0;var r=e._c;_((function(){for(var n=e._v,o=1==e._s,i=0,u=function(t){var r,i,u,c=o?t.ok:t.fail,s=t.resolve,l=t.reject,a=t.domain;try{c?(o||(2==e._h&&M(e),e._h=1),!0===c?r=n:(a&&a.enter(),r=c(n),a&&(a.exit(),u=!0)),r===t.promise?l(T("Promise-chain cycle")):(i=P(r))?i.call(r,s,l):s(r)):l(n)}catch(e){a&&!u&&a.exit(),l(e)}};r.length>i;)u(r[i++]);e._c=[],e._n=!1,t&&!e._h&&I(e)}))}},I=function(e){y.call(s,(function(){var t,r,n,o=e._v,i=j(e);if(i&&(t=b((function(){L?S.emit("unhandledRejection",o,e):(r=s.onunhandledrejection)?r({promise:e,reason:o}):(n=s.console)&&n.error&&n.error("Unhandled promise rejection",o)})),e._h=L||j(e)?2:1),e._a=void 0,i&&t.e)throw t.v}))},j=function(e){return 1!==e._h&&0===(e._a||e._c).length},M=function(e){y.call(s,(function(){var t;L?S.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),D(t,!0))},B=function e(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw T("Promise can't be resolved itself");(r=P(t))?_((function(){var o={_w:n,_d:!1};try{r.call(t,l(e,o,1),l(F,o,1))}catch(e){F.call(o,e)}})):(n._v=t,n._s=1,D(n,!1))}catch(e){F.call({_w:n,_d:!1},e)}}};x||(k=function(e){h(this,k,"Promise","_h"),f(e),n.call(this);try{e(l(B,this,1),l(F,this,1))}catch(e){F.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(44)(k.prototype,{then:function(e,t){var r=R(m(this,k));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=L?S.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&D(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new n;this.promise=e,this.resolve=l(B,e,1),this.reject=l(F,e,1)},w.f=R=function(e){return e===k||e===u?new i(e):o(e)}),d(d.G+d.W+d.F*!x,{Promise:k}),r(45)(k,"Promise"),r(46)("Promise"),u=r(2).Promise,d(d.S+d.F*!x,"Promise",{reject:function(e){var t=R(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(c||!x),"Promise",{resolve:function(e){return E(c&&this===u?k:this,e)}}),d(d.S+d.F*!(x&&r(47)((function(e){k.all(e).catch(A)}))),"Promise",{all:function(e){var t=this,r=R(t),n=r.resolve,o=r.reject,i=b((function(){var r=[],i=0,u=1;v(e,!1,(function(e){var c=i++,s=!1;r.push(void 0),u++,t.resolve(e).then((function(e){s||(s=!0,r[c]=e,--u||n(r))}),o)})),--u||n(r)}));return i.e&&o(i.v),r.promise},race:function(e){var t=this,r=R(t),n=r.reject,o=b((function(){v(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return o.e&&n(o.v),r.promise}})},function(e,t,r){"use strict";var n=r(0),o=r(2),i=r(14),u=r(17),c=r(5),s=function e(t,r,s){var l,a,d,p,f=t&e.F,h=t&e.G,v=t&e.P,m=t&e.B,y=h?n:t&e.S?n[r]||(n[r]={}):(n[r]||{}).prototype,_=h?o:o[r]||(o[r]={}),w=_.prototype||(_.prototype={});for(l in h&&(s=r),s)d=((a=!f&&y&&void 0!==y[l])?y:s)[l],p=m&&a?c(d,n):v&&"function"==typeof d?c(Function.call,d):d,y&&u(y,l,d,t&e.U),_[l]!=d&&i(_,l,p),v&&w[l]!=d&&(w[l]=d)};n.core=o,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,r){"use strict";e.exports=!r(7)&&!r(15)((function(){return 7!=Object.defineProperty(r(16)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){"use strict";var n=r(4);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";e.exports=r(12)("native-function-to-string",Function.toString)},function(e,t,r){"use strict";e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){"use strict";var n=r(5),o=r(32),i=r(33),u=r(3),c=r(34),s=r(36),l={},a={},d=e.exports=function(e,t,r,d,p){var f,h,v,m,y=p?function(){return e}:s(e),_=n(r,d,t?2:1),w=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(i(y)){for(f=c(e.length);f>w;w++)if((m=t?_(u(h=e[w])[0],h[1]):_(e[w]))===l||m===a)return m}else for(v=y.call(e);!(h=v.next()).done;)if((m=o(v,_,h.value,t))===l||m===a)return m};d.BREAK=l,d.RETURN=a},function(e,t,r){"use strict";var n=r(3);e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&n(i.call(e)),t}}},function(e,t,r){"use strict";var n=r(19),o=r(1)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||i[o]===e)}},function(e,t,r){"use strict";var n=r(35),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){"use strict";var n=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},function(e,t,r){"use strict";var n=r(11),o=r(1)("iterator"),i=r(19);e.exports=r(2).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[n(e)]}},function(e,t,r){"use strict";var n=r(3),o=r(6),i=r(1)("species");e.exports=function(e,t){var r,u=n(e).constructor;return void 0===u||null==(r=n(u)[i])?t:o(r)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){"use strict";var n=r(0).document;e.exports=n&&n.documentElement},function(e,t,r){"use strict";var n=r(0),o=r(20).set,i=n.MutationObserver||n.WebKitMutationObserver,u=n.process,c=n.Promise,s="process"==r(8)(u);e.exports=function(){var e,t,r,l=function(){var n,o;for(s&&(n=u.domain)&&n.exit();e;){o=e.fn,e=e.next;try{o()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(s)r=function(){u.nextTick(l)};else if(!i||n.navigator&&n.navigator.standalone)if(c&&c.resolve){var a=c.resolve(void 0);r=function(){a.then(l)}}else r=function(){o.call(n,l)};else{var d=!0,p=document.createTextNode("");new i(l).observe(p,{characterData:!0}),r=function(){p.data=d=!d}}return function(n){var o={fn:n,next:void 0};t&&(t.next=o),e||(e=o,r()),t=o}}},function(e,t,r){"use strict";e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){"use strict";var n=r(0).navigator;e.exports=n&&n.userAgent||""},function(e,t,r){"use strict";var n=r(3),o=r(4),i=r(21);e.exports=function(e,t){if(n(e),o(t)&&t.constructor===e)return t;var r=i.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){"use strict";var n=r(17);e.exports=function(e,t,r){for(var o in t)n(e,o,t[o],r);return e}},function(e,t,r){"use strict";var n=r(9).f,o=r(18),i=r(1)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},function(e,t,r){"use strict";var n=r(0),o=r(9),i=r(7),u=r(1)("species");e.exports=function(e){var t=n[e];i&&t&&!t[u]&&o.f(t,u,{configurable:!0,get:function(){return this}})}},function(e,t,r){"use strict";var n=r(1)("iterator"),o=!1;try{var i=[7][n]();i.return=function(){o=!0},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i=[7],u=i[n]();u.next=function(){return{done:r=!0}},i[n]=function(){return u},e(i)}catch(e){}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e){try{e=JSON.parse(n.default.base64decode(e))}catch(e){return Promise.reject("base64 decode error")}var i=[];for(var u in r)i.push(u+"="+r[u]);var c="//"+t+"?"+e.GetPlayInfoToken+"&ssl=true";return i.length>0&&(c+="&"+i.join("&")),new o.default({type:"json",method:"GET",url:c}).then((function(e){return e.response&&e.response.Result?e.response.Result:e.response||e}))}return Promise.reject("vid, host and token can't be empty")};var n=i(r(49)),o=i(r(50));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={base64decode:function(e){var t,r,n,o,i,u,c,s=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(u=e.length,i=0,c="";i<u;){do{t=s[255&e.charCodeAt(i++)]}while(i<u&&-1===t);if(-1===t)break;do{r=s[255&e.charCodeAt(i++)]}while(i<u&&-1===r);if(-1===r)break;c+=String.fromCharCode(t<<2|(48&r)>>4);do{if(61==(n=255&e.charCodeAt(i++)))return c;n=s[n]}while(i<u&&-1===n);if(-1===n)break;c+=String.fromCharCode((15&r)<<4|(60&n)>>2);do{if(61==(o=255&e.charCodeAt(i++)))return c;o=s[o]}while(i<u&&-1===o);if(-1===o)break;c+=String.fromCharCode((3&n)<<6|o)}return c}};t.default=n,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,o=t.method,i=void 0===o?"GET":o,u=t.type,c=void 0===u?"arraybuffer":u,s=t.data,l=void 0===s?{}:s,a=t.headers,d=void 0===a?{}:a;return n(this,e),new Promise((function(e,t){var n=new window.XMLHttpRequest,o=i.toUpperCase(),u=[];for(var s in l)u.push(s+"="+l[s]);if("GET"!==o)throw new Error("xhr "+o+" is not supported");for(var a in n.open(o,""+r),c&&(n.responseType=c),d)n.setRequestHeader(a,""+d[a]);n.send(),n.onload=function(){200===n.status||206===n.status?e(n):t(n)},n.onerror=function(){t(n)}}))},e.exports=t.default}])},1347:function(e,t,r){},1348:function(e,t,r){},1349:function(e,t,r){},1350:function(e,t){e.exports='<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.25163 12.8332C8.75789 12.8332 9.16829 13.2436 9.16829 13.7499V19.7082C9.16829 19.9613 8.96309 20.1665 8.70996 20.1665H7.79329C7.54016 20.1665 7.33496 19.9613 7.33496 19.7082V14.6665H2.29329C2.04016 14.6665 1.83496 14.4613 1.83496 14.2082V13.2915C1.83496 13.0384 2.04016 12.8332 2.29329 12.8332H8.25163ZM14.21 1.83319C14.4631 1.83319 14.6683 2.03839 14.6683 2.29152V7.33319H19.71C19.9631 7.33319 20.1683 7.53839 20.1683 7.79152V8.70819C20.1683 8.96132 19.9631 9.16652 19.71 9.16652H13.7516C13.2454 9.16652 12.835 8.75612 12.835 8.24986V2.29152C12.835 2.03839 13.0402 1.83319 13.2933 1.83319H14.21Z" fill="white"/>\n</svg>\n'},1351:function(e,t){e.exports='<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1.8333 3.83334C1.8333 2.72877 2.72873 1.83334 3.8333 1.83334H6.41663C6.9229 1.83334 7.3333 2.24375 7.3333 2.75001C7.3333 3.25627 6.9229 3.66668 6.41663 3.66668H3.66663V6.41668C3.66663 6.92294 3.25623 7.33334 2.74997 7.33334C2.24371 7.33334 1.8333 6.92294 1.8333 6.41668V3.83334ZM20.1667 18.1666C20.1667 19.2712 19.2713 20.1666 18.1667 20.1666H15.5834C15.0771 20.1666 14.6667 19.7562 14.6667 19.2499C14.6667 18.7437 15.0771 18.3333 15.5834 18.3333H18.3334V15.5833C18.3334 15.077 18.7438 14.6666 19.25 14.6666C19.7563 14.6666 20.1667 15.077 20.1667 15.5833V18.1666ZM3.83301 20.1666C2.72844 20.1666 1.83301 19.2712 1.83301 18.1666V15.5833C1.83301 15.077 2.24341 14.6666 2.74967 14.6666C3.25594 14.6666 3.66634 15.077 3.66634 15.5833V18.3333H6.41634C6.9226 18.3333 7.33301 18.7437 7.33301 19.2499C7.33301 19.7562 6.9226 20.1666 6.41634 20.1666H3.83301ZM18.1667 1.83325C19.2713 1.83325 20.1667 2.72868 20.1667 3.83325V6.41659C20.1667 6.92285 19.7563 7.33325 19.25 7.33325C18.7438 7.33325 18.3334 6.92285 18.3334 6.41659V3.66659H15.5834C15.0771 3.66659 14.6667 3.25618 14.6667 2.74992C14.6667 2.24366 15.0771 1.83325 15.5834 1.83325H18.1667Z" fill="white"/>\n</svg>\n'},1352:function(e,t){e.exports='<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.2 2C8.64183 2 9 2.41041 9 2.91667V19.4167C9 19.9229 8.64183 20.3333 8.2 20.3333H5.8C5.35817 20.3333 5 19.9229 5 19.4167V2.91667C5 2.41041 5.35817 2 5.8 2H8.2Z" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16.2 2C16.6418 2 17 2.41041 17 2.91667V19.4167C17 19.9229 16.6418 20.3333 16.2 20.3333H13.8C13.3582 20.3333 13 19.9229 13 19.4167V2.91667C13 2.41041 13.3582 2 13.8 2H16.2Z" fill="white"/>\n</svg>\n'},1353:function(e,t){e.exports='<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5.07935 1.9805L17.9127 10.2291C18.474 10.5899 18.474 11.4103 17.9127 11.7711L5.07935 20.0197C4.4693 20.4118 3.66699 19.9739 3.66699 19.2488V2.75145C3.66699 2.02633 4.4693 1.58838 5.07935 1.9805Z" fill="white"/>\n</svg>\n'},1354:function(e,t){e.exports='<svg width="96" height="96" viewBox="0 0 96 96" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M48 31.9668C42.7607 31.9668 38.1082 34.4796 35.182 38.367L42.1667 38.3668C42.9767 38.3668 43.6333 39.0235 43.6333 39.8335V42.1668C43.6333 42.9768 42.9767 43.6335 42.1667 43.6335H29.3333V43.6337L29.3223 43.6333L29.1482 43.6269L29.1482 43.6271L29.1371 43.6263C27.7743 43.5257 26.7 42.3885 26.7 41.0002V28.1668C26.7 27.3568 27.3567 26.7002 28.1667 26.7002H30.5C31.31 26.7002 31.9667 27.3568 31.9667 28.1668V28.1669L31.9655 33.9789C35.8693 29.5181 41.6057 26.7002 48 26.7002C59.7637 26.7002 69.3 36.2365 69.3 48.0002C69.3 59.7638 59.7637 69.3002 48 69.3002C38.0401 69.3002 29.6775 62.4643 27.3466 53.2288C27.2348 52.7861 27.574 52.3676 28.0215 52.3676L32.045 52.3677C32.3562 52.3677 32.625 52.5725 32.7171 52.8623C34.7762 59.3406 40.8405 64.0335 48 64.0335C56.855 64.0335 64.0333 56.8551 64.0333 48.0002C64.0333 39.1452 56.855 31.9668 48 31.9668Z" fill="white" stroke="white" stroke-width="0.6"/>\n</svg>\n'},1355:function(e,t){e.exports='<svg width="96" height="96" viewBox="0 0 96 96" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M48 4C72.3005 4 92 23.6995 92 48C92 72.3005 72.3005 92 48 92C23.6995 92 4 72.3005 4 48C4 23.6995 23.6995 4 48 4Z" fill="black" fill-opacity="0.4"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M42 28C43.1046 28 44 28.8954 44 30V66C44 67.1046 43.1046 68 42 68H36C34.8954 68 34 67.1046 34 66V30C34 28.8954 34.8954 28 36 28H42Z" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M60 28C61.1046 28 62 28.8954 62 30V66C62 67.1046 61.1046 68 60 68H54C52.8954 68 52 67.1046 52 66V30C52 28.8954 52.8954 28 54 28H60Z" fill="white"/>\n</svg>\n'},1356:function(e,t){e.exports='<svg width="96" height="96" viewBox="0 0 96 96" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M40.896 28.5117L66.496 45.1739C68.5013 46.4791 68.5013 49.5205 66.496 50.8257L40.896 67.488C38.7646 68.8752 36 67.2795 36 64.6621V31.3376C36 28.7202 38.7646 27.1245 40.896 28.5117Z" fill="white"/>\n</svg>\n'},1357:function(e,t){e.exports='<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1.29617 1.02794C1.11742 1.20669 1.11742 1.49728 1.29617 1.67603L19.4453 19.8251C19.6245 20.0043 19.9146 20.0043 20.0938 19.8251L20.7419 19.177C20.9206 18.9978 20.9206 18.7077 20.7419 18.5289L18.6125 16.3995L17.3122 15.0988L16.0078 13.7948L14.6933 12.4799L12.375 10.1621L10.5417 8.32873L8.69596 6.48257L7.38834 5.1754L2.5928 0.379859C2.41359 0.200651 2.12346 0.200651 1.94471 0.379859L1.29617 1.02794ZM4.58369 7.78479C4.58369 7.54966 4.67398 7.32508 4.83257 7.15641L6.41702 8.74087V13.7637L10.542 16.9368V12.8659L12.3754 14.6992V18.3333C12.3754 18.8398 11.9651 19.25 11.4587 19.25H10.8537C10.6516 19.25 10.4549 19.1831 10.295 19.0598L4.94165 14.9417C4.71569 14.7684 4.58369 14.4998 4.58369 14.2152V7.78479ZM10.5417 6.38409V5.06318L9.79503 5.63747L8.4874 4.32984L10.2946 2.94018C10.4546 2.81689 10.6512 2.74997 10.8533 2.74997H11.4583C11.9648 2.74997 12.375 3.16018 12.375 3.66664V8.21743L10.5417 6.38409ZM16.6942 12.5367L15.1249 10.9674C15.1166 10.2918 14.8655 9.6749 14.4544 9.20053C14.2751 8.99336 14.2536 8.67528 14.447 8.48186L15.0827 7.84661C15.2528 7.67611 15.5282 7.66511 15.6941 7.83974C16.4774 8.66199 16.9582 9.77482 16.9582 10.9999C16.9582 11.5389 16.8652 12.0564 16.6942 12.5367ZM19.4321 15.2748L18.0856 13.9283C18.5366 13.0505 18.7914 12.055 18.7914 11C18.7914 9.28763 18.1208 7.73204 17.0277 6.58163C16.8476 6.39142 16.8389 6.09029 17.0241 5.90513L17.6694 5.25979C17.8436 5.08563 18.125 5.07921 18.2969 5.25613C19.7379 6.74158 20.6247 8.76696 20.6247 11C20.6247 12.5652 20.1888 14.0282 19.4321 15.2748ZM1.83333 7.33326C1.58033 7.33326 1.375 7.53859 1.375 7.79159V14.2083C1.375 14.4613 1.58033 14.6666 1.83333 14.6666H2.75C3.003 14.6666 3.20833 14.4613 3.20833 14.2083V7.79159C3.20833 7.53859 3.003 7.33326 2.75 7.33326H1.83333Z" fill="white"/>\n</svg>\n'},1358:function(e,t){e.exports='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4.89549 4.29745L15.8541 11.3411C16.3334 11.6492 16.3334 12.3497 15.8541 12.6578L4.89549 19.7014C4.37456 20.0362 3.68945 19.6623 3.68945 19.0431V4.95578C3.68945 4.33659 4.37456 3.96262 4.89549 4.29745Z" fill="white"/>\n<rect x="17.9453" y="4.17578" width="2.36553" height="15.6551" rx="0.5" fill="white"/>\n</svg>\n'},1359:function(e,t){e.exports='<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M10.8537 2.75H11.4587C11.9421 2.75 12.3379 3.12376 12.3728 3.59823L12.3754 3.66667V18.3333C12.3754 18.8168 12.0016 19.2125 11.5271 19.2475L11.4587 19.25H10.8537C10.6804 19.25 10.5112 19.2008 10.3657 19.1091L10.295 19.0598L4.94165 14.9417C4.73623 14.7842 4.60847 14.5479 4.58694 14.2924L4.58369 14.2152V7.78479C4.58369 7.52604 4.69278 7.28055 4.88238 7.10789L4.94165 7.05833L10.295 2.94021C10.4321 2.83453 10.5961 2.77027 10.7675 2.75407L10.8537 2.75H11.4587H10.8537ZM10.5413 5.0632L6.41631 8.23624V13.7637L10.5413 16.9368V5.0632ZM18.2975 5.25616C19.7385 6.74161 20.6253 8.76699 20.6253 11C20.6253 13.2394 19.733 15.2707 18.2842 16.7576C18.1128 16.9336 17.8313 16.9272 17.6576 16.753L17.0123 16.1081C16.8267 15.9225 16.8358 15.62 17.0169 15.4302C18.1169 14.2784 18.792 12.7183 18.792 11C18.792 9.28766 18.1215 7.73207 17.0283 6.58166C16.8482 6.39145 16.8395 6.09032 17.0247 5.90516L17.67 5.25982C17.8442 5.08566 18.1256 5.07924 18.2975 5.25616ZM2.75 7.33329C3.003 7.33329 3.20833 7.53862 3.20833 7.79162V14.2083C3.20833 14.4613 3.003 14.6666 2.75 14.6666H1.83333C1.58033 14.6666 1.375 14.4613 1.375 14.2083V7.79162C1.375 7.53862 1.58033 7.33329 1.83333 7.33329H2.75ZM15.6944 7.83977C16.4772 8.66202 16.958 9.77485 16.958 11C16.958 12.232 16.4717 13.3508 15.6806 14.1744C15.5143 14.3476 15.2402 14.3362 15.0701 14.1666L14.4354 13.5314C14.241 13.337 14.2635 13.0176 14.4445 12.8104C14.868 12.3269 15.1247 11.6934 15.1247 11C15.1247 10.312 14.8717 9.68273 14.4541 9.20056C14.2749 8.99339 14.2534 8.67531 14.4468 8.48189L15.0825 7.84664C15.253 7.67614 15.528 7.66514 15.6944 7.83977Z" fill="white"/>\n</svg>\n'},1360:function(e,t,r){var n;e.exports=(n=r(1097),function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=r(2),n=d(r(3)),s=d(r(4)),o=d(r(5)),c=d(r(6)),u=d(r(7)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(8));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function t(){return f(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return g(t,e),i(t,[{key:"afterCreate",value:function(){var e=this;this.onTimeupdate=this.onTimeupdate.bind(this),this.onDestroy=this.onDestroy.bind(this),this._errReqCount=0,this._curDefinitionIndex=0,this._autoplay=this.playerConfig.autoplay,this.hls=null,this.hlsOpts=this.config.hlsOpts,this.hlsAlias={},this.getUrlTime=(new Date).getTime()/1e3,this.__startInit=!1,this._addHlsFLoader(),this.config.checkHlsOffline&&s.default.on(this,"timeupdate",this.onTimeupdate,"destroy"),this.hlsTimer=new c.default,this.hlsTimer.repeat((function(){e.onRepeat()}),this.config.checkExpireInterval),s.default.on(this,"destroy",this.onDestroy,"destroy"),this._proxyPlayerSrc(),this._proxyPlayerStartInit()}},{key:"_proxyPlayerSrc",value:function(){var e=this.player,t=this;Object.defineProperty(e,"src",{get:function(){return e.currentSrc},set:function(r){e.config.url=r,e.video.autoplay=!0,e.paused||e.pause();var i=function(r){t.hls?(t.hls.stopLoad(),t.hls.originUrl=r.url||"",t.register(),t.hls.attachMedia(e.video),t.hls.loadSource(r.url)):e.video.src=r.url};t.loadSource(r,(function(e){if(e.length)i({url:e});else{var t=new FileReader;t.onload=function(){i({url:t.result})},t.readAsDataURL(e)}}))},configurable:!0})}},{key:"_proxyPlayerStartInit",value:function(){var e=this;this.__startInit=this.player._startInit;var t=this.config,r=t.vid,i=t.playAuthToken,a=t.playDomain,s=t.testUrl,o=t.testUrlExpire,c={url:this.playerConfig.url,playAuthToken:i,vid:r,playDomain:a,testUrl:s,testUrlExpire:o},u=function(t){e.hls?(e.hls.once(n.default.Events.MEDIA_ATTACHED,(function(t){e.__startInit.call(e.player,e.player.video.currentSrc)})),e.hls.attachMedia(e.player.video),e.hls.loadSource(t.url)):e.__startInit.call(e.player,t.url)};this.player._startInit=function(){e.start(c).then((function(t){t.url&&(e.player.config.url=t.url);var r=e.player.config.url;e.init1(),e.loadSource(r,(function(e){if(e.length)u({url:e});else{var t=new FileReader;t.onload=function(){u({url:t.result})},t.readAsDataURL(e)}}))})).catch((function(e){console.error(e)}))}}},{key:"start",value:function(e){var t=this,r=this.player;return e||((e=this.config).url=null),new Promise((function(i,a){var n,s,o;e.url&&(/\.(mp3|m4a)/.test(e.url)||/(mp3|m4a)/.test(e.type))||e.url?(t.emit("can_start"),i({url:e.url})):(e.playAuthToken||e.vid)&&(n=e.playAuthToken,s=e.playDomain,o=function(n){var s=n.videoList,o=n.rawData;if(t.emit("get_play_info",o),s&&s.length>0&&(s[0].MainPlayUrl||s[0].src)){!function(e){if(e.sort((function(e,t){return t.Bitrate-e.Bitrate})),e[0].Bitrate){var t=0;e.every((function(r,i){return e[0].Bitrate===r.Bitrate&&(t=i,!0)})),t>0&&e.splice(t)}}(s),t.getUrlTime=(new Date).getTime()/1e3;var c=r.config.definition||{},u=c.defaultDefinition||r.config.defaultDefinition,l=s[0].Format;s[0].UrlExpire&&(t.urlExpireTimestamp=e.testUrlExpire||s[0].UrlExpire);var d=function(e,t,r){if(r||(r=[]),e.sort((function(e,t){return t.Bitrate-e.Bitrate})),e[0].Bitrate){var i=0;e.every((function(t,r){return e[0].Bitrate===t.Bitrate&&(i=r,!0)})),i>0&&e.splice(i)}e.map((function(e){var t,i,a={name:e.Definition||"标清",definition:e.Definition,url:e.MainPlayUrl||e.src,backupUrl:e.BackupPlayUrl,bitrate:e.Bitrate,size:e.size},n=function(e){for(var t=0;t<r.length;t++)if(e.Definition.toLocaleLowerCase()===r[t].definition.toLocaleLowerCase())return t;return-1}(e);return n>=0?(t=a,(i=r[n])||(i=t),Object.keys(t).map((function(e){i[e]=t[e]}))):r.push(a),{name:e.Definition||"标清",text:e.Definition,definition:e.Definition,url:e.MainPlayUrl||e.src,backupUrl:e.BackupPlayUrl,bitrate:e.Bitrate,size:e.size}}));var a=-1;if(t)for(var n=0;n<e.length;n++)e[n].Definition.toLocaleLowerCase()===t.toLocaleLowerCase()&&(a=n);return a<0&&(a=0),{index:a,list:r}}(s,u,c.list);t._curDefinitionIndex=d.index;var f=d.list[d.index];r.url=r.config.url=f.url,r.emit("resourceReady",d.list),s[0]&&s[0].type&&/(mp3|m4a|mp4)/.test(s[0].type)||l&&"m3u8"!==l&&"hls"!==l?(t.emit("can_start"),i({url:r.config.url})):(i({url:r.config.url}),t.emit("can_start"))}else{var h=o||{ResponseMetadata:{Error:{CodeN:0,Message:""},RequestId:""}};t.emit("playInterfaceInfo",{code:h.ResponseMetadata.Error.CodeN,message:h.ResponseMetadata.Error.Message,logid:h.ResponseMetadata.RequestId});var g={msg:"HAS NO VIDEO INFORMATION CORRECTLY, PLEASE CHRECK THE TOKEN.",errorCode:-9998};t.emit("error",g),a(g)}},u.default.url(n,s).then((function(e){var t=[],r=e.Data||e;r&&r.PlayInfoList&&r.PlayInfoList.length>0?(t=r.PlayInfoList,o({videoList:t,rawData:e})):(console.error("HAS NO VIDEO INFORMATION CORRECTLY, PLEASE CHRECK THE TOKEN."),o({videoList:[],rawData:e}))})))}))}},{key:"_processRetData",value:function(e,t,r,i){if(e.sort((function(e,t){return t.Bitrate-e.Bitrate})),e[0].Bitrate){var a=0;e.every((function(t,r){return e[0].Bitrate===t.Bitrate&&(a=r,!0)})),a>0&&e.splice(a)}}},{key:"_addHlsFLoader",value:function(){var e=function(e){function t(e){f(this,t);var r=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i=r.load.bind(r);return r.load=function(e,t,r){var a=r.onError;r.onError=function(e,t,r){403===e.code&&(this._errReqCount++,this._errReqCount>2&&this.emitExpireEvent()),a(e,t,r)},i(e,t,r)},r}return g(t,e),t}(n.default.DefaultConfig.loader);this.hlsOpts.fLoader=e}},{key:"onTimeupdate",value:function(){this.hlsAlias&&this.player.video&&!this.player.video.videoHeight?(this.hlsAlias.hlsOfflineCount=void 0===this.hlsAlias.hlsOfflineCount?1:this.hlsAlias.hlsOfflineCount+1,this.hlsAlias.hlsOfflineCount>3&&(this.pause(),this.emit("error",{msg:"OFFLINE",errorCode:-9997}),this.onError())):this.hlsAlias&&(this.hlsAlias.hlsOfflineCount=0)}},{key:"onDestroy",value:function(){this.hlsTimer&&(this.hlsTimer.clear(),this.hlsTimer=null)}},{key:"onRepeat",value:function(){var e=this,t=this.config,r=this.player;t.expireDetectType.indexOf("getUrlTime")>-1&&this.getUrlTime&&r.duration&&(new Date).getTime()/1e3>this.getUrlTime+3300+r.duration&&(this.getUrlTime=0,this.emitExpireEvent()),t.expireDetectType.indexOf("xhrStatus")>-1&&this.hlsAlias&&this.hlsAlias.manifestUrl&&Math.random()<1/7.5&&new o.default({url:this.hlsAlias.manifestUrl,type:""}).catch((function(t){t&&void 0!==t.status&&(e.hlsAlias.hlsExpireCount=void 0===e.hlsAlias.hlsExpireCount?1:e.hlsAlias.hlsExpireCount+1,e.hlsAlias.hlsExpireCount>3&&(e.hlsAlias.hlsExpireCount=0,e.emitExpireEvent()))})),t.expireDetectType.indexOf("urlExpire")>-1&&this.urlExpireTimestamp&&(new Date).getTime()/1e3>=this.urlExpireTimestamp&&(this.urlExpireTimestamp=l.MAX_TIMESTAMP,this.emitExpireEvent())}},{key:"emitExpireEvent",value:function(){var e=this.player,t=(new Date).getTime()/1e3;e.emitExpireTimestamp?t-e.emitExpireTimestamp>l.MIN_EXPIRE_INTERVAL&&(e.emitExpireTimestamp=t,e.emit("MEDIA_EXPIRED")):(e.emitExpireTimestamp=t,e.emit("MEDIA_EXPIRED"))}},{key:"switchURL",value:function(e){console.log("switchURL",e),this.player.src=e}},{key:"_createHLS",value:function(){var e=this,t=this.player;this.hls=new n.default(this.hlsOpts),this.hlsAlias=this.hls,this.hlsAlias.originUrl=t.config.url||"",this.register(),s.default.once(this,"complete",(function(){e.hls.attachMedia(t.video)})),s.default.once(this,"destroy",(function(){e.hls.stopLoad()}))}},{key:"init1",value:function(){this.browser=s.default.getBrowserVersion(),(void 0===this.config.useHls||this.config.useHls)&&(s.default.isMobile()||this._createHLS())}},{key:"updateM3U8",value:function(e,t,r){var i=this.player;"TOP"!==this.config.getKeyType&&(e=window.atob(e));var a=void 0;try{a=new Blob([e],{type:"text/html"})}catch(t){(a=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder)).append(e),a=a.getBlob()}var n=URL.createObjectURL(a);t=t.replace(/,URI="([^"]+)"/,',URI="'+n+'"');var o=s.default.isRelativeURL(i.url)?s.default.getAbsoluteURL(i.url):i.url,c=o.match(/((http|https):?\/\/.+)\/\w+\.\w+/)||[],u=o&&c.length>1?c[1]+"/":"";t=t.replace(/(#EXTINF:)(\d+\.?\d*)(?:,(?:[^\r|\n]*)(?:\r|\n)*)(.*(?!#))/g,(function(e,t,r,i){return/(http|https)?\:?\/\//.test(i)?t+r+",\n"+i:t+r+",\n"+u+i}));var l=void 0;try{l=new Blob([t],{type:"application/x-mpegURL"})}catch(e){(l=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder)).append(t),l=l.getBlob()}if(s.default.isMobile())r&&r(l);else{var d=URL.createObjectURL(l);r&&r(d)}}},{key:"loadSource",value:function(e,t){var r=this,i=this.player;new o.default({type:"",url:e}).then((function(e){var a=e.responseText;if(a.match(/#EXT-X-KEY:(\w+=\w+)+/)){var n=a.match(/,URI="([^"]+)"/)[1],o=s.default.parseUrl(n);if(o&&o.ak)if("TOP"===r.config.getKeyType){var c=s.default.isBase64(r.config.keyToken)?window.atob(r.config.keyToken):r.config.keyToken;n="//"+(r.config.playDomain||"")+"?"+c+"&Source=jarvis&Ak="+o.ak}else n=(r.config.keyDomain||"")+"/kds/api/v1/keys?source=jarvis&ak="+o.ak+"&token="+(r.config.keyToken||"");return{keyUrl:n,ctx:a}}t&&t(i.config.url)})).then((function(e){if(e&&e.keyUrl){var i=e.keyUrl,a=e.ctx,n=function(e){var i=void 0;try{i=JSON.parse(e.responseText),"TOP"===r.config.getKeyType&&(i.data=i.Result.SecretKey)}catch(t){i={data:s.default.isBase64(e.responseText)?e.responseText:window.btoa(e.responseText)}}r.updateM3U8(i.data,a,t)};if(r.config.keyToken&&("TOP"===r.config.getKeyType?r.config.playDomain:r.config.keyDomain))if("IE 11"!==r.browser)new o.default({url:i,type:"text"}).then((function(e){n(e)}));else{var c=new XMLHttpRequest;c.open("get",i),c.send(),c.onload=function(){200!==c.status&&206!==c.status||n(c)}}else r.config.keyValue&&r.updateM3U8(r.config.keyValue,a,t)}}))}},{key:"register",value:function(){var e=this.hlsAlias,t=this.player;t.once("playing",(function(){var e=!1,r=t.video.querySelector("track");r&&("hidden"===r.track.mode&&(e=!0),r.track.mode="hidden",t.video.removeChild(r)),t.config.textTrack&&t.config.textTrack.length>0&&t.config.textTrack.some((function(r){if(r.src&&r.label&&r.default){var i=document.createElement("track");return i.src=r.src,i.kind=r.kind,i.label=r.label,i.srclang=r.srclang,i.default=!0,t.video.appendChild(i),e&&(i.track.mode="hidden"),!0}}))})),e.on(n.default.Events.LEVEL_LOADED,(function(r,i){if(!e.inited&&(e.inited=!0,i&&i.details&&i.details.live)){a.Util.addClass(t.root,"xgplayer-is-live");var n=a.Util.createDom("xg-live","LIVE",{},"xgplayer-live");t.controls.appendChild(n)}})),e.on(n.default.Events.ERROR,(function(e,r){"internalException"!==r.details&&r.fatal&&t.emit("error",r)}))}},{key:"versionNum",get:function(){return this.version&&this.version[0]&&parseInt(this.version[0])}}],[{key:"pluginName",get:function(){return"EncryptHlsPlugin"}},{key:"defaultConfig",get:function(){return{expireDetectType:[],hlsOpts:{},checkExpireInterval:400,type:"",playAuthToken:"",vid:"",checkHlsOffline:!1}}}]),t}(a.BasePlugin);v.isSupported=function(e){e=e||navigator.userAgent.toLocaleLowerCase();var t=/(iphone)/.test(e)||/(ipad)/.test(e),r=/(android)/.test(e),i=/(windows phone)/.test(e),a=!(t||r||i),n=/(xiaomi)/.test(e),s=/(quark)/.test(e);return!(n||(a||r?!window.MediaSource||!window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'):!t||s||e.indexOf("iphone os 11_4")>-1||e.indexOf("iphone os 11_2")>-1))},v.HlsJs=n.default,t.default=v,e.exports=t.default},function(e,t){e.exports=n},function(e,t,r){var i;"undefined"!=typeof window&&(i=function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,a="~";function n(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new s(r,i||e,n),c=a?a+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function u(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(a=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)i.call(e,t)&&r.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=a?a+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,s=new Array(n);i<n;i++)s[i]=r[i].fn;return s},u.prototype.listenerCount=function(e){var t=a?a+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,i,n,s){var o=a?a+e:e;if(!this._events[o])return!1;var c,u,l=this._events[o],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,n),!0;case 6:return l.fn.call(l.context,t,r,i,n,s),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var f,h=l.length;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,i);break;default:if(!c)for(f=1,c=new Array(d-1);f<d;f++)c[f-1]=arguments[f];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,i){var n=a?a+e:e;if(!this._events[n])return this;if(!t)return c(this,n),this;var s=this._events[n];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||c(this,n);else{for(var o=0,u=[],l=s.length;o<l;o++)(s[o].fn!==t||i&&!s[o].once||r&&s[o].context!==r)&&u.push(s[o]);u.length?this._events[n]=1===u.length?u[0]:u:c(this,n)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&c(this,t)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=a,u.EventEmitter=u,e.exports=u},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){var i,a,n,s,o;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,a=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=o.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=o.normalizePath(i.path),o.buildURLFromParts(i)}var n=o.parseURL(t);if(!n)throw new Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=o.normalizePath(n.path),o.buildURLFromParts(n)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var c=a.exec(s.path);s.netLoc=c[1],s.path=c[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(u.netLoc=s.netLoc,"/"!==n.path[0]))if(n.path){var l=s.path,d=l.substring(0,l.lastIndexOf("/")+1)+n.path;u.path=o.normalizePath(d)}else u.path=s.path,n.params||(u.params=s.params,n.query||(u.query=s.query));return null===u.path&&(u.path=r.alwaysNormalize?o.normalizePath(n.path):n.path),o.buildURLFromParts(u)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},"./node_modules/webworkify-webpack/index.js":function(e,t,r){function i(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var i=r(r.s=ENTRY_MODULE);return i.default||i}function a(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function n(e,t,i){var n={};n[i]=[];var s=t.toString(),o=s.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!o)return n;for(var c,u=o[1],l=new RegExp("(\\\\n|\\W)"+a(u)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");c=l.exec(s);)"dll-reference"!==c[3]&&n[i].push(c[3]);for(l=new RegExp("\\("+a(u)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");c=l.exec(s);)e[c[2]]||(n[i].push(c[1]),e[c[2]]=r(c[1]).m),n[c[2]]=n[c[2]]||[],n[c[2]].push(c[4]);for(var d,f=Object.keys(n),h=0;h<f.length;h++)for(var g=0;g<n[f[h]].length;g++)d=n[f[h]][g],isNaN(1*d)||(n[f[h]][g]=1*n[f[h]][g]);return n}function s(e){return Object.keys(e).reduce((function(t,r){return t||e[r].length>0}),!1)}e.exports=function(e,t){t=t||{};var a={main:r.m},o=t.all?{main:Object.keys(a.main)}:function(e,t){for(var r={main:[t]},i={main:[]},a={main:{}};s(r);)for(var o=Object.keys(r),c=0;c<o.length;c++){var u=o[c],l=r[u].pop();if(a[u]=a[u]||{},!a[u][l]&&e[u][l]){a[u][l]=!0,i[u]=i[u]||[],i[u].push(l);for(var d=n(e,e[u][l],u),f=Object.keys(d),h=0;h<f.length;h++)r[f[h]]=r[f[h]]||[],r[f[h]]=r[f[h]].concat(d[f[h]])}}return i}(a,e),c="";Object.keys(o).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;o[e][t];)t++;o[e].push(t),a[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",c=c+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map((function(t){return JSON.stringify(t)+": "+a[e][t].toString()})).join(",")+"});\n"})),c=c+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map((function(e){return JSON.stringify(e)+": "+a.main[e].toString()})).join(",")+"}))(self);";var u=new window.Blob([c],{type:"text/javascript"});if(t.bare)return u;var l=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),d=new window.Worker(l);return d.objectURL=l,d}},"./src/crypt/decrypter.js":function(e,t,r){"use strict";r.r(t);var i=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),a=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),n=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),i=0;i<4;i++)r[i]=t.getUint32(4*i);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],a=r[1],n=r[2],s=r[3],o=this.invSubMix,c=o[0],u=o[1],l=o[2],d=o[3],f=new Uint32Array(256),h=0,g=0,p=0;for(p=0;p<256;p++)f[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){var v=g^g<<1^g<<2^g<<3^g<<4;v=v>>>8^255&v^99,e[h]=v,t[v]=h;var m=f[h],y=f[m],_=f[y],w=257*f[v]^16843008*v;i[h]=w<<24|w>>>8,a[h]=w<<16|w>>>16,n[h]=w<<8|w>>>24,s[h]=w,w=16843009*_^65537*y^257*m^16843008*h,c[v]=w<<24|w>>>8,u[v]=w<<16|w>>>16,l[v]=w<<8|w>>>24,d[v]=w,h?(h=m^f[f[f[_^m]]],g^=f[f[g]]):h=g=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,i=0;i<t.length&&r;)r=t[i]===this.key[i],i++;if(!r){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var n,s,o,c,u=this.ksRows=4*(a+6+1),l=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),f=this.sBox,h=this.rcon,g=this.invSubMix,p=g[0],v=g[1],m=g[2],y=g[3];for(n=0;n<u;n++)n<a?o=l[n]=t[n]:(c=o,n%a==0?(c=f[(c=c<<8|c>>>24)>>>24]<<24|f[c>>>16&255]<<16|f[c>>>8&255]<<8|f[255&c],c^=h[n/a|0]<<24):a>6&&n%a==4&&(c=f[c>>>24]<<24|f[c>>>16&255]<<16|f[c>>>8&255]<<8|f[255&c]),l[n]=o=(l[n-a]^c)>>>0);for(s=0;s<u;s++)n=u-s,c=3&s?l[n]:l[n-4],d[s]=s<4||n<=4?c:p[f[c>>>24]]^v[f[c>>>16&255]]^m[f[c>>>8&255]]^y[f[255&c]],d[s]=d[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r,i){for(var a,n,s,o,c,u,l,d,f,h,g,p,v,m,y,_,w,b=this.keySize+6,E=this.invKeySchedule,T=this.invSBox,S=this.invSubMix,O=S[0],C=S[1],k=S[2],L=S[3],A=this.uint8ArrayToUint32Array_(r),R=A[0],x=A[1],P=A[2],D=A[3],I=new Int32Array(e),j=new Int32Array(I.length),M=this.networkToHostOrderSwap;t<I.length;){for(f=M(I[t]),h=M(I[t+1]),g=M(I[t+2]),p=M(I[t+3]),c=f^E[0],u=p^E[1],l=g^E[2],d=h^E[3],v=4,m=1;m<b;m++)a=O[c>>>24]^C[u>>16&255]^k[l>>8&255]^L[255&d]^E[v],n=O[u>>>24]^C[l>>16&255]^k[d>>8&255]^L[255&c]^E[v+1],s=O[l>>>24]^C[d>>16&255]^k[c>>8&255]^L[255&u]^E[v+2],o=O[d>>>24]^C[c>>16&255]^k[u>>8&255]^L[255&l]^E[v+3],c=a,u=n,l=s,d=o,v+=4;a=T[c>>>24]<<24^T[u>>16&255]<<16^T[l>>8&255]<<8^T[255&d]^E[v],n=T[u>>>24]<<24^T[l>>16&255]<<16^T[d>>8&255]<<8^T[255&c]^E[v+1],s=T[l>>>24]<<24^T[d>>16&255]<<16^T[c>>8&255]<<8^T[255&u]^E[v+2],o=T[d>>>24]<<24^T[c>>16&255]<<16^T[u>>8&255]<<8^T[255&l]^E[v+3],v+=3,j[t]=M(a^R),j[t+1]=M(o^x),j[t+2]=M(s^P),j[t+3]=M(n^D),R=f,x=h,P=g,D=p,t+=4}return i?(w=(_=(y=j.buffer).byteLength)&&new DataView(y).getUint8(_-1))?y.slice(0,_-w):y:j.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),s=r("./src/errors.ts"),o=r("./src/utils/logger.js"),c=r("./src/events.js"),u=r("./src/utils/get-self-scope.js"),l=Object(u.getSelfScope)(),d=function(){function e(e,t,r){var i=(void 0===r?{}:r).removePKCS7Padding,a=void 0===i||i;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=a,a)try{var n=l.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,r,s){var c=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.logger.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new n),u.expandKey(t),s(u.decrypt(e,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(o.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var l=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new a(l,t)),this.fastAesKey.expandKey().then((function(a){new i(l,r).decrypt(e,a).catch((function(i){c.onWebCryptoError(i,e,t,r,s)})).then((function(e){s(e)}))})).catch((function(i){c.onWebCryptoError(i,e,t,r,s)}))}},t.onWebCryptoError=function(e,t,r,i,a){this.config.enableSoftwareAES?(o.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,i,a)):(o.logger.error("decrypting error : "+e.message),this.observer.trigger(c.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.default=d},"./src/demux/demuxer-inline.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/events.js"),a=r("./src/errors.ts"),n=r("./src/crypt/decrypter.js"),s=r("./src/polyfills/number.js"),o=r("./src/utils/logger.js"),c=r("./src/utils/get-self-scope.js");function u(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function d(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function f(e,t){return!!(t+1<e.length&&u(e,t))}function h(e,t){if(f(e,t)){var r=l(e,t);if(t+r>=e.length)return!1;var i=d(e,t);if(i<=r)return!1;var a=t+i;if(a===e.length||a+1<e.length&&u(e,a))return!0}return!1}function g(e,t,r,n,s){if(!e.samplerate){var c=function(e,t,r,n){var s,c,u,l,d,f=navigator.userAgent.toLowerCase(),h=n,g=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[r+2])>>>6),!((c=(60&t[r+2])>>>2)>g.length-1))return l=(1&t[r+2])<<2,l|=(192&t[r+3])>>>6,o.logger.log("manifest codec:"+n+",ADTS data:type:"+s+",sampleingIndex:"+c+"["+g[c]+"Hz],channelConfig:"+l),/firefox/i.test(f)?c>=6?(s=5,d=new Array(4),u=c-3):(s=2,d=new Array(2),u=c):-1!==f.indexOf("android")?(s=2,d=new Array(2),u=c):(s=5,d=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&c>=6?u=c-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(c>=6&&1===l||/vivaldi/i.test(f))||!n&&1===l)&&(s=2,d=new Array(2)),u=c)),d[0]=s<<3,d[0]|=(14&c)>>1,d[1]|=(1&c)<<7,d[1]|=l<<3,5===s&&(d[1]|=(14&u)>>1,d[2]=(1&u)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:g[c],channelCount:l,codec:"mp4a.40."+s,manifestCodec:h};e.trigger(i.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+c})}(t,r,n,s);e.config=c.config,e.samplerate=c.samplerate,e.channelCount=c.channelCount,e.codec=c.codec,e.manifestCodec=c.manifestCodec,o.logger.log("parsed codec:"+e.codec+",rate:"+c.samplerate+",nb channel:"+c.channelCount)}}function p(e){return 9216e4/e}function v(e,t,r,i,a){var n=function(e,t,r,i,a){var n,s,o=e.length;if(n=l(e,t),s=d(e,t),(s-=n)>0&&t+n+s<=o)return{headerLength:n,frameLength:s,stamp:r+i*a}}(t,r,i,a,p(e.samplerate));if(n){var s=n.stamp,o=n.headerLength,c=n.frameLength,u={unit:t.subarray(r+o,r+o+c),pts:s,dts:s};return e.samples.push(u),{sample:u,length:c+o}}}var m=r("./src/demux/id3.js"),y=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(m.default.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(h(e,t))return o.logger.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,r,i){for(var a=this._audioTrack,n=m.default.getID3Data(e,0)||[],c=m.default.getTimeStamp(n),u=Object(s.isFiniteNumber)(c)?90*c:9e4*t,l=0,d=u,h=e.length,p=n.length,y=[{pts:d,dts:d,data:n}];p<h-1;)if(f(e,p)&&p+5<h){g(a,this.observer,e,p,a.manifestCodec);var _=v(a,e,p,u,l);if(!_){o.logger.log("Unable to parse AAC frame");break}p+=_.length,d=_.sample.pts,l++}else m.default.isHeader(e,p)?(n=m.default.getID3Data(e,p),y.push({pts:d,dts:d,data:n}),p+=n.length):p++;this.remuxer.remux(a,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,r,i)},t.destroy=function(){},e}(),_=r("./src/demux/mp4demuxer.js"),w={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,i,a){if(!(r+24>t.length)){var n=this.parseHeader(t,r);if(n&&r+n.frameLength<=t.length){var s=i+a*(9e4*n.samplesPerFrame/n.sampleRate),o={unit:t.subarray(r,r+n.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=n.channelCount,e.samplerate=n.sampleRate,e.samples.push(o),{sample:o,length:n.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,a=e[t+2]>>4&15,n=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!==r&&0!==a&&15!==a&&3!==n){var o=3===r?3-i:3===i?3:4,c=1e3*w.BitratesMap[14*o+a-1],u=3===r?0:2===r?1:2,l=w.SamplingRateMap[3*u+n],d=e[t+3]>>6==3?1:2,f=w.SamplesCoefficients[r][i],h=w.BytesInSlot[i],g=8*f*h;return{sampleRate:l,channelCount:d,frameLength:parseInt(f*c/l+s,10)*h,samplesPerFrame:g}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),i=4;r&&r.frameLength&&(i=r.frameLength);var a=t+i;if(a===e.length||a+1<e.length&&this.isHeaderPattern(e,a))return!0}return!1}},b=w,E=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");i.set(e.subarray(r,r+a)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&o.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,r=8,i=8;for(t=0;t<e;t++)0!==i&&(i=(r+this.readEG()+256)%256),r=0===i?r:i},t.readSPS=function(){var e,t,r,i,a,n,s,o=0,c=0,u=0,l=0,d=this.readUByte.bind(this),f=this.readBits.bind(this),h=this.readUEG.bind(this),g=this.readBoolean.bind(this),p=this.skipBits.bind(this),v=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(d(),e=d(),f(5),p(3),d(),m(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var _=h();if(3===_&&p(1),m(),m(),p(1),g())for(n=3!==_?8:12,s=0;s<n;s++)g()&&y(s<6?16:64)}m();var w=h();if(0===w)h();else if(1===w)for(p(1),v(),v(),t=h(),s=0;s<t;s++)v();m(),p(1),r=h(),i=h(),0===(a=f(1))&&p(1),p(1),g()&&(o=h(),c=h(),u=h(),l=h());var b=[1,1];if(g()&&g())switch(d()){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(r+1)-2*o-2*c),height:(2-a)*(i+1)*16-(a?2:4)*(u+l),pixelRatio:b}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),T=function(){function e(e,t,r,i){this.decryptdata=r,this.discardEPB=i,this.decrypter=new n.default(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,r,i){var a=e[t].unit,n=a.subarray(16,a.length-a.length%16),s=n.buffer.slice(n.byteOffset,n.byteOffset+n.length),o=this;this.decryptBuffer(s,(function(n){n=new Uint8Array(n),a.set(n,16),i||o.decryptAacSamples(e,t+1,r)}))},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,i),!i)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),i=0,a=32;a<=e.length-16;a+=160,i+=16)r.set(e.subarray(a,a+16),i);return r},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,i=32;i<=e.length-16;i+=160,r+=16)e.set(t.subarray(r,r+16),i);return e},t.decryptAvcSample=function(e,t,r,i,a,n){var s=this.discardEPB(a.data),o=this.getAvcEncryptedData(s),c=this;this.decryptBuffer(o.buffer,(function(o){a.data=c.getAvcDecryptedUnit(s,o),n||c.decryptAvcSamples(e,t,r+1,i)}))},t.decryptAvcSamples=function(e,t,r,i){for(;;t++,r=0){if(t>=e.length)return void i();for(var a=e[t].units;!(r>=a.length);r++){var n=a[r];if(!(n.data.length<=48||1!==n.type&&5!==n.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,i,n,s),!s)return}}}},e}(),S={video:1,audio:2,id3:3,text:4},O=function(){function e(e,t,r,i){this.observer=e,this.config=r,this.typeSupported=i,this.remuxer=t,this.sampleAes=null,this.pmtUnknownTypes={}}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new T(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0||(r&&o.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:S[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},t.resetInitSegment=function(t,r,i,a){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=e.createTrack("video",a),this._audioTrack=e.createTrack("audio",a),this._id3Track=e.createTrack("id3",a),this._txtTrack=e.createTrack("text",a),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=i,this._duration=a},t.resetTimeStamp=function(){},t.append=function(t,r,n,s){var c,u,l,d,f,h=t.length,g=!1;this.pmtUnknownTypes={},this.contiguous=n;var p=this.pmtParsed,v=this._avcTrack,m=this._audioTrack,y=this._id3Track,_=v.pid,w=m.pid,b=y.pid,E=this._pmtId,T=v.pesData,S=m.pesData,O=y.pesData,C=this._parsePAT,k=this._parsePMT.bind(this),L=this._parsePES,A=this._parseAVCPES.bind(this),R=this._parseAACPES.bind(this),x=this._parseMPEGPES.bind(this),P=this._parseID3PES.bind(this),D=e._syncOffset(t);for(h-=(h+D)%188,c=D;c<h;c+=188)if(71===t[c]){if(u=!!(64&t[c+1]),l=((31&t[c+1])<<8)+t[c+2],(48&t[c+3])>>4>1){if((d=c+5+t[c+4])===c+188)continue}else d=c+4;switch(l){case _:u&&(T&&(f=L(T))&&A(f,!1),T={data:[],size:0}),T&&(T.data.push(t.subarray(d,c+188)),T.size+=c+188-d);break;case w:u&&(S&&(f=L(S))&&(m.isAAC?R(f):x(f)),S={data:[],size:0}),S&&(S.data.push(t.subarray(d,c+188)),S.size+=c+188-d);break;case b:u&&(O&&(f=L(O))&&P(f),O={data:[],size:0}),O&&(O.data.push(t.subarray(d,c+188)),O.size+=c+188-d);break;case 0:u&&(d+=t[d]+1),E=this._pmtId=C(t,d);break;case E:u&&(d+=t[d]+1);var I=k(t,d,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(_=I.avc)>0&&(v.pid=_),(w=I.audio)>0&&(m.pid=w,m.isAAC=I.isAAC),(b=I.id3)>0&&(y.pid=b),g&&!p&&(o.logger.log("reparse from beginning"),g=!1,c=D-188),p=this.pmtParsed=!0;break;case 17:case 8191:break;default:g=!0}}else this.observer.trigger(i.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});T&&(f=L(T))?(A(f,!0),v.pesData=null):v.pesData=T,S&&(f=L(S))?(m.isAAC?R(f):x(f),m.pesData=null):(S&&S.size&&o.logger.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=S),O&&(f=L(O))?(P(f),y.pesData=null):y.pesData=O,null==this.sampleAes?this.remuxer.remux(m,v,y,this._txtTrack,r,n,s):this.decryptAndRemux(m,v,y,this._txtTrack,r,n,s)},t.decryptAndRemux=function(e,t,r,i,a,n,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){o.decryptAndRemuxAvc(e,t,r,i,a,n,s)}))}else this.decryptAndRemuxAvc(e,t,r,i,a,n,s)},t.decryptAndRemuxAvc=function(e,t,r,i,a,n,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){o.remuxer.remux(e,t,r,i,a,n,s)}))}else this.remuxer.remux(e,t,r,i,a,n,s)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._trackUnknownPmt=function(e,t,r){var i=this.pmtUnknownTypes[e]||0;return 0===i&&(this.pmtUnknownTypes[e]=0,t.call(o.logger,r)),this.pmtUnknownTypes[e]++,i},t._parsePMT=function(e,t,r,i){var a,n,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(a=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){switch(n=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!i){this._trackUnknownPmt(e[t],o.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===s.audio&&(s.audio=n);break;case 21:-1===s.id3&&(s.id3=n);break;case 219:if(!i){this._trackUnknownPmt(e[t],o.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===s.avc&&(s.avc=n);break;case 3:case 4:r?-1===s.audio&&(s.audio=n,s.isAAC=!1):this._trackUnknownPmt(e[t],o.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(e[t],o.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(e[t],o.logger.log,"Unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},t._parsePES=function(e){var t,r,i,a,n,s,c,u,l=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var f=new Uint8Array(d[0].length+d[1].length);f.set(d[0]),f.set(d[1],d[0].length),d[0]=f,d.splice(1,1)}if(1===((t=d[0])[0]<<16)+(t[1]<<8)+t[2]){if((i=(t[4]<<8)+t[5])&&i>e.size-6)return null;if(192&(r=t[7])&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&r?s-(c=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(o.logger.warn(Math.round((s-c)/9e4)+"s delta between PTS and DTS, align them"),s=c):c=s),u=(a=t[8])+9,e.size<=u)return null;e.size-=u,n=new Uint8Array(e.size);for(var h=0,g=d.length;h<g;h++){var p=(t=d[h]).byteLength;if(u){if(u>p){u-=p;continue}t=t.subarray(u),p-=u,u=0}n.set(t,l),l+=p}return i&&(i-=a+3),{data:n,pts:s,dts:c,len:i}}return null},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,i=r.length;if(isNaN(e.pts)){if(!i)return void t.dropped++;var a=r[i-1];e.pts=a.pts,e.dts=a.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(i||this.contiguous)?(e.id=i,r.push(e)):t.dropped++}e.debug.length&&o.logger.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var r,i,a,n=this,s=this._avcTrack,o=this._parseAVCNALu(e.data),c=this.avcSample,u=!1,l=this.pushAccesUnit.bind(this),d=function(e,t,r,i){return{key:e,pts:t,dts:r,units:[],debug:i}};e.data=null,c&&o.length&&!s.audFound&&(l(c,s),c=this.avcSample=d(!1,e.pts,e.dts,"")),o.forEach((function(t){switch(t.type){case 1:i=!0,c||(c=n.avcSample=d(!0,e.pts,e.dts,"")),c.frame=!0;var o=t.data;if(u&&o.length>4){var f=new E(o).readSliceType();2!==f&&4!==f&&7!==f&&9!==f||(c.key=!0)}break;case 5:i=!0,c||(c=n.avcSample=d(!0,e.pts,e.dts,"")),c.key=!0,c.frame=!0;break;case 6:i=!0,(r=new E(n.discardEPB(t.data))).readUByte();for(var h=0,g=0,p=!1,v=0;!p&&r.bytesAvailable>1;){h=0;do{h+=v=r.readUByte()}while(255===v);g=0;do{g+=v=r.readUByte()}while(255===v);if(4===h&&0!==r.bytesAvailable){if(p=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var y=r.readUByte(),_=31&y,w=[y,r.readUByte()];for(a=0;a<_;a++)w.push(r.readUByte()),w.push(r.readUByte()),w.push(r.readUByte());n._insertSampleInOrder(n._txtTrack.samples,{type:3,pts:e.pts,bytes:w})}}else if(5===h&&0!==r.bytesAvailable){if(p=!0,g>16){var b=[];for(a=0;a<16;a++)b.push(r.readUByte().toString(16)),3!==a&&5!==a&&7!==a&&9!==a||b.push("-");var T=g-16,S=new Uint8Array(T);for(a=0;a<T;a++)S[a]=r.readUByte();n._insertSampleInOrder(n._txtTrack.samples,{pts:e.pts,payloadType:h,uuid:b.join(""),userDataBytes:S,userData:Object(m.utf8ArrayToStr)(S.buffer)})}}else if(g<r.bytesAvailable)for(a=0;a<g;a++)r.readUByte()}break;case 7:if(i=!0,u=!0,!s.sps){var O=(r=new E(t.data)).readSPS();s.width=O.width,s.height=O.height,s.pixelRatio=O.pixelRatio,s.sps=[t.data],s.duration=n._duration;var C=t.data.subarray(1,4),k="avc1.";for(a=0;a<3;a++){var L=C[a].toString(16);L.length<2&&(L="0"+L),k+=L}s.codec=k}break;case 8:i=!0,s.pps||(s.pps=[t.data]);break;case 9:i=!1,s.audFound=!0,c&&l(c,s),c=n.avcSample=d(!1,e.pts,e.dts,"");break;case 12:i=!1;break;default:i=!1,c&&(c.debug+="unknown NAL "+t.type+" ")}c&&i&&c.units.push(t)})),t&&c&&(l(c,s),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var i=r-1;i>=0;i--)if(t.pts<e[i].pts){e.splice(i,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var i=t.units;e=i[i.length-1]}return e},t._parseAVCNALu=function(e){var t,r,i,a,n=0,s=e.byteLength,o=this._avcTrack,c=o.naluState||0,u=c,l=[],d=-1;for(-1===c&&(d=0,a=31&e[0],c=0,n=1);n<s;)if(t=e[n++],c)if(1!==c)if(t)if(1===t){if(d>=0)i={data:e.subarray(d,n-c-1),type:a},l.push(i);else{var f=this._getLastNalUnit();if(f&&(u&&n<=4-u&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-u)),(r=n-c-1)>0)){var h=new Uint8Array(f.data.byteLength+r);h.set(f.data,0),h.set(e.subarray(0,r),f.data.byteLength),f.data=h}}n<s?(d=n,a=31&e[n],c=0):c=-1}else c=0;else c=3;else c=t?0:2;else c=t?0:1;if(d>=0&&c>=0&&(i={data:e.subarray(d,s),type:a,state:c},l.push(i)),0===l.length){var g=this._getLastNalUnit();if(g){var p=new Uint8Array(g.data.byteLength+e.byteLength);p.set(g.data,0),p.set(e,g.data.byteLength),g.data=p}}return o.naluState=c,l},t.discardEPB=function(e){for(var t,r,i=e.byteLength,a=[],n=1;n<i-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(a.push(n+2),n+=2):n++;if(0===a.length)return e;t=i-a.length,r=new Uint8Array(t);var s=0;for(n=0;n<t;s++,n++)s===a[0]&&(s++,a.shift()),r[n]=e[s];return r},t._parseAACPES=function(e){var t,r,n,s,c,u,l,d=this._audioTrack,h=e.data,m=e.pts,y=this.aacOverFlow,_=this.aacLastPTS;if(y){var w=new Uint8Array(y.byteLength+h.byteLength);w.set(y,0),w.set(h,y.byteLength),h=w}for(n=0,c=h.length;n<c-1&&!f(h,n);n++);if(!n||(n<c-1?(u="AAC PES did not start with ADTS header,offset:"+n,l=!1):(u="no ADTS header found in AAC PES",l=!0),o.logger.warn("parsing error:"+u),this.observer.trigger(i.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:l,reason:u}),!l)){if(g(d,this.observer,h,n,this.audioCodec),r=0,t=p(d.samplerate),y&&_){var b=_+t;Math.abs(b-m)>1&&(o.logger.log("AAC: align PTS for overlapping frames by "+Math.round((b-m)/90)),m=b)}for(;n<c;){if(f(h,n)){if(n+5<c){var E=v(d,h,n,m,r);if(E){n+=E.length,s=E.sample.pts,r++;continue}}break}n++}y=n<c?h.subarray(n,c):null,this.aacOverFlow=y,this.aacLastPTS=s}},t._parseMPEGPES=function(e){for(var t=e.data,r=t.length,i=0,a=0,n=e.pts;a<r;)if(b.isHeader(t,a)){var s=b.appendFrame(this._audioTrack,t,a,n,i);if(!s)break;a+=s.length,i++}else a++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),C=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,r,i=m.default.getID3Data(e,0);if(i&&void 0!==m.default.getTimeStamp(i))for(t=i.length,r=Math.min(e.length-1,t+100);t<r;t++)if(b.probe(e,t))return o.logger.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,r,i){for(var a=m.default.getID3Data(e,0)||[],n=m.default.getTimeStamp(a),s=void 0!==n?90*n:9e4*t,o=a.length,c=e.length,u=0,l=0,d=this._audioTrack,f=[{pts:s,dts:s,data:a}];o<c;)if(b.isHeader(e,o)){var h=b.appendFrame(d,e,o,s,u);if(!h)break;o+=h.length,l=h.sample.pts,u++}else m.default.isHeader(e,o)?(a=m.default.getID3Data(e,o),f.push({pts:l,dts:l,data:a}),o+=a.length):o++;this.remuxer.remux(d,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},t,r,i)},t.destroy=function(){},e}(),k=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),L=Math.pow(2,32)-1,A=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:i};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=n,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,c,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))},e.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),i=8,a=r.length,n=a;a--;)i+=r[a].byteLength;for((t=new Uint8Array(i))[0]=i>>24&255,t[1]=i>>16&255,t[2]=i>>8&255,t[3]=255&i,t.set(e,4),a=0,i=8;a<n;a++)t.set(r[a],i),i+=r[a].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var i=Math.floor(r/(L+1)),a=Math.floor(r%(L+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,r))},e.moov=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(i))},e.mvhd=function(t,r){r*=t;var i=Math.floor(r/(L+1)),a=Math.floor(r%(L+1)),n=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,n)},e.sdtp=function(t){var r,i,a=t.samples||[],n=new Uint8Array(4+a.length);for(i=0;i<a.length;i++)r=a[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,n)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,i,a,n=[],s=[];for(r=0;r<t.sps.length;r++)a=(i=t.sps[r]).byteLength,n.push(a>>>8&255),n.push(255&a),n=n.concat(Array.prototype.slice.call(i));for(r=0;r<t.pps.length;r++)a=(i=t.pps[r]).byteLength,s.push(a>>>8&255),s.push(255&a),s=s.concat(Array.prototype.slice.call(i));var o=e.box(e.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(s))),c=t.width,u=t.height,l=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,255&c,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,i=t.duration*t.timescale,a=t.width,n=t.height,s=Math.floor(i/(L+1)),o=Math.floor(i%(L+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,n>>8&255,255&n,0,0]))},e.traf=function(t,r){var i=e.sdtp(t),a=t.id,n=Math.floor(r/(L+1)),s=Math.floor(r%(L+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,i.length+16+20+8+16+8+8),i)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var i,a,n,s,o,c,u=t.samples||[],l=u.length,d=12+16*l,f=new Uint8Array(d);for(r+=8+d,f.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,255&l,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),i=0;i<l;i++)n=(a=u[i]).duration,s=a.size,o=a.flags,c=a.cts,f.set([n>>>24&255,n>>>16&255,n>>>8&255,255&n,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*i);return e.box(e.types.trun,f)},e.initSegment=function(t){e.types||e.init();var r,i=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+i.byteLength)).set(e.FTYP),r.set(i,e.FTYP.byteLength),r},e}();function R(e,t,r,i){void 0===r&&(r=1),void 0===i&&(i=!1);var a=e*t*r;return i?Math.round(a):a}function x(e,t){return void 0===t&&(t=!1),R(e,1e3,1/9e4,t)}function P(e,t){return void 0===t&&(t=1),R(e,9e4,1/t)}var D=P(10),I=P(.2),j=null;function M(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}var F,B=function(){function e(e,t,r,i){if(this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,null===j){var a=navigator.userAgent.match(/Chrome\/(\d+)/i);j=a?parseInt(a[1]):0}}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,r=e.reduce((function(e,r){var i=r.pts-e;return i<-4294967296?(t=!0,M(e,r.pts)):i>0?e:r.pts}),e[0].pts);return t&&o.logger.debug("PTS rollover detected"),r},t.remux=function(e,t,r,a,n,s,c){if(this.ISGenerated||this.generateIS(e,t,n),this.ISGenerated){var u=e.samples.length,l=t.samples.length,d=n,f=n;if(u&&l){var h=this.getVideoStartPts(t.samples),g=(M(e.samples[0].pts,h)-h)/t.inputTimeScale;d+=Math.max(0,g),f+=Math.max(0,-g)}if(u){e.timescale||(o.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,n));var p,v=this.remuxAudio(e,d,s,c);l&&(v&&(p=v.endPTS-v.startPTS),t.timescale||(o.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,n)),this.remuxVideo(t,f,s,p))}else if(l){var m=this.remuxVideo(t,f,s,0,c);m&&e.codec&&this.remuxEmptyAudio(e,d,s,m)}}r.samples.length&&this.remuxID3(r,n),a.samples.length&&this.remuxText(a,n),this.observer.trigger(i.default.FRAG_PARSED)},t.generateIS=function(e,t,r){var n,s,c=this.observer,u=e.samples,l=t.samples,d=this.typeSupported,f="audio/mp4",h={},g={tracks:h},p=void 0===this._initPTS;if(p&&(n=s=1/0),e.config&&u.length&&(e.timescale=e.samplerate,o.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(d.mpeg?(f="audio/mpeg",e.codec=""):d.mp3&&(e.codec="mp3")),h.audio={container:f,codec:e.codec,initSegment:!e.isAAC&&d.mpeg?new Uint8Array:A.initSegment([e]),metadata:{channelCount:e.channelCount}},p&&(n=s=u[0].pts-Math.round(e.inputTimeScale*r))),t.sps&&t.pps&&l.length){var v=t.inputTimeScale;if(t.timescale=v,h.video={container:"video/mp4",codec:t.codec,initSegment:A.initSegment([t]),metadata:{width:t.width,height:t.height}},p){var m=this.getVideoStartPts(l),y=Math.round(v*r);s=Math.min(s,M(l[0].dts,m)-y),n=Math.min(n,m-y),this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:n})}}else p&&h.audio&&this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:n});Object.keys(h).length?(c.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,g),this.ISGenerated=!0,p&&(this._initPTS=n,this._initDTS=s)):c.trigger(i.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,r,n){var s,c,u,l,d,f=e.timescale,h=e.samples,g=[],p=h.length,v=this._initPTS,m=8,y=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,w=0,b=!1,E=this.nextAvcDts;if(0!==p){r||(E=t*f-(h[0].pts-M(h[0].dts,h[0].pts)));for(var T=0;T<p;T++){var S=h[T];S.pts=M(S.pts-v,E),S.dts=M(S.dts-v,E),S.dts>S.pts&&(w=Math.max(Math.min(w,S.pts-S.dts),-1*I)),S.dts<h[T>0?T-1:T].dts&&(b=!0)}b&&h.sort((function(e,t){var r=e.dts-t.dts,i=e.pts-t.pts;return r||i||e.id-t.id})),l=h[0].dts,d=h[p-1].dts;var O=Math.round((d-l)/(p-1));if(w<0){if(w<-2*O){o.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+x(-O,!0)+" ms");for(var C=w,k=0;k<p;k++)h[k].dts=C=Math.max(C,h[k].pts-O),h[k].pts=Math.max(C,h[k].pts)}else{o.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+x(w,!0)+" ms to overcome this issue");for(var L=0;L<p;L++)h[L].dts=h[L].dts+w}l=h[0].dts,d=h[p-1].dts}if(r){var R=l-E,P=R>O;if(P||R<-1){P?o.logger.warn("AVC: "+x(R,!0)+" ms ("+R+"dts) hole between fragments detected, filling it"):o.logger.warn("AVC: "+x(-R,!0)+" ms ("+R+"dts) overlapping between fragments detected"),l=E;var D=h[0].pts-R;h[0].dts=l,h[0].pts=D,o.logger.log("Video: First PTS/DTS adjusted: "+x(D,!0)+"/"+x(l,!0)+", delta: "+x(R,!0)+" ms")}}j&&j<75&&(l=Math.max(0,l));for(var F=0,B=0,U=0;U<p;U++){for(var N=h[U],V=N.units,H=V.length,G=0,K=0;K<H;K++)G+=V[K].data.length;B+=G,F+=H,N.length=G,N.dts=Math.max(N.dts,l),N.pts=Math.max(N.pts,N.dts,0),y=Math.min(N.pts,y),_=Math.max(N.pts,_)}d=h[p-1].dts;var $=B+4*F+8;try{c=new Uint8Array($)}catch(e){return void this.observer.trigger(i.default.ERROR,{type:a.ErrorTypes.MUX_ERROR,details:a.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:$,reason:"fail allocating video mdat "+$})}var W=new DataView(c.buffer);W.setUint32(0,$),c.set(A.types.mdat,4);for(var q=0;q<p;q++){for(var z,Y=h[q],X=Y.units,Z=0,J=0,Q=X.length;J<Q;J++){var ee=X[J],te=ee.data,re=ee.data.byteLength;W.setUint32(m,re),m+=4,c.set(te,m),m+=re,Z+=4+re}if(q<p-1)s=h[q+1].dts-Y.dts;else{var ie=this.config,ne=Y.dts-h[q>0?q-1:q].dts;if(ie.stretchShortVideoTrack){var oe=ie.maxBufferHole,ae=Math.floor(oe*f),se=(n?y+n*f:this.nextAudioPts)-Y.pts;se>ae?((s=se-ne)<0&&(s=ne),o.logger.log("It is approximately "+x(se,!1)+" ms to the next segment; using duration "+x(s,!1)+" ms for the last video frame.")):s=ne}else s=ne}z=Math.round(Y.pts-Y.dts),g.push({size:Z,duration:s,cts:z,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:Y.key?2:1,isNonSync:Y.key?0:1}})}this.nextAvcDts=d+s;var ce=e.dropped;if(e.nbNalu=0,e.dropped=0,g.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var le=g[0].flags;le.dependsOn=2,le.isNonSync=0}e.samples=g,u=A.moof(e.sequenceNumber++,l,e),e.samples=[];var ue={data1:u,data2:c,startPTS:y/f,endPTS:(_+s)/f,startDTS:l/f,endDTS:this.nextAvcDts/f,type:"video",hasAudio:!1,hasVideo:!0,nb:g.length,dropped:ce};return this.observer.trigger(i.default.FRAG_PARSING_DATA,ue),ue}},t.remuxAudio=function(e,t,r,n){var s,c,u,l,d,f,h=e.inputTimeScale,g=e.timescale,p=h/g,v=(e.isAAC?1024:1152)*p,m=this._initPTS,y=!e.isAAC&&this.typeSupported.mpeg,_=y?0:8,w=e.samples,b=[],E=this.nextAudioPts;if(r|=w.length&&E&&(n&&Math.abs(t-E/h)<.1||Math.abs(w[0].pts-E-m)<20*v),w.forEach((function(e){e.pts=e.dts=M(e.pts-m,t*h)})),0!==(w=w.filter((function(e){return e.pts>=0}))).length){if(r||(E=n?Math.max(0,t*h):w[0].pts),e.isAAC)for(var T=this.config.maxAudioFramesDrift,S=0,O=E;S<w.length;){var C=w[S],L=C.pts,R=L-O;if(R<=-T*v)r||S>0?(o.logger.warn("Dropping 1 audio frame @ "+x(O,!0)/1e3+"s due to "+x(R,!0)+" ms overlap."),w.splice(S,1)):(o.logger.warn("Audio frame @ "+x(L,!0)/1e3+"s overlaps nextAudioPts by "+x(R,!0)+" ms."),O=L+v,S++);else if(R>=T*v&&R<D&&O){var P=Math.round(R/v);o.logger.warn("Injecting "+P+" audio frames @ "+x(O,!0)/1e3+"s due to "+x(R,!0)+" ms gap.");for(var I=0;I<P;I++){var j=Math.max(O,0);(c=k.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),c=C.unit.subarray()),w.splice(S,0,{unit:c,pts:j,dts:j}),O+=v,S++}C.pts=C.dts=O,O+=v,S++}else Math.abs(R),C.pts=C.dts=O,O+=v,S++}for(var F=w.length,B=0;F--;)B+=w[F].unit.byteLength;for(var U=0,N=w.length;U<N;U++){var V=w[U],H=V.unit,G=V.pts;if(void 0!==f&&s)s.duration=Math.round((G-f)/p);else{var K=G-E,$=0;if(r&&e.isAAC&&K){if(K>0&&K<D)$=Math.round((G-E)/v),o.logger.log(x(K,!0)+" ms hole between AAC samples detected,filling it"),$>0&&((c=k.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(c=H.subarray()),B+=$*c.length);else if(K<-12){o.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+x(E,!0)+" ms / "+x(G,!0)+" ms / "+x(-K,!0)+" ms"),B-=H.byteLength;continue}G=E}if(d=G,!(B>0))return;B+=_;try{u=new Uint8Array(B)}catch(e){return void this.observer.trigger(i.default.ERROR,{type:a.ErrorTypes.MUX_ERROR,details:a.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating audio mdat "+B})}y||(new DataView(u.buffer).setUint32(0,B),u.set(A.types.mdat,4));for(var W=0;W<$;W++)(c=k.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),c=H.subarray()),u.set(c,_),_+=c.byteLength,s={size:c.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},b.push(s)}u.set(H,_);var q=H.byteLength;_+=q,s={size:q,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},b.push(s),f=G}var z=0;if((F=b.length)>=2&&(z=b[F-2].duration,s.duration=z),F){this.nextAudioPts=E=f+p*z,e.samples=b,l=y?new Uint8Array:A.moof(e.sequenceNumber++,d/p,e),e.samples=[];var Y=d/h,X=E/h,Z={data1:l,data2:u,startPTS:Y,endPTS:X,startDTS:Y,endDTS:X,type:"audio",hasAudio:!0,hasVideo:!1,nb:F};return this.observer.trigger(i.default.FRAG_PARSING_DATA,Z),Z}return null}},t.remuxEmptyAudio=function(e,t,r,i){var a=e.inputTimeScale,n=a/(e.samplerate?e.samplerate:a),s=this.nextAudioPts,c=(void 0!==s?s:i.startDTS*a)+this._initDTS,u=i.endDTS*a+this._initDTS,l=1024*n,d=Math.ceil((u-c)/l),f=k.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.logger.warn("remux empty Audio"),f){for(var h=[],g=0;g<d;g++){var p=c+g*l;h.push({unit:f,pts:p,dts:p})}e.samples=h,this.remuxAudio(e,t,r)}else o.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e,t){var r=e.samples.length;if(r){for(var a=e.inputTimeScale,n=this._initPTS,s=this._initDTS,o=0;o<r;o++){var c=e.samples[o];c.pts=M(c.pts-n,t*a)/a,c.dts=M(c.dts-s,t*a)/a}this.observer.trigger(i.default.FRAG_PARSING_METADATA,{samples:e.samples}),e.samples=[]}},t.remuxText=function(e,t){var r=e.samples.length,a=e.inputTimeScale,n=this._initPTS;if(r){for(var s=0;s<r;s++){var o=e.samples[s];o.pts=M(o.pts-n,t*a)/a}e.samples.sort((function(e,t){return e.pts-t.pts})),this.observer.trigger(i.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e}(),U=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,r,a,n,s,o,c){var u=this.observer,l="";e&&(l+="audio"),t&&(l+="video"),u.trigger(i.default.FRAG_PARSING_DATA,{data1:c,startPTS:n,startDTS:n,type:l,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),u.trigger(i.default.FRAG_PARSED)},e}(),N=Object(c.getSelfScope)();try{F=N.performance.now.bind(N.performance)}catch(e){o.logger.debug("Unable to use Performance API on this environment"),F=N.Date.now}var V=function(){function e(e,t,r,i){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=i}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,r,a,s,o,c,u,l,d,f,h){var g=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var p=this.decrypter;null==p&&(p=this.decrypter=new n.default(this.observer,this.config));var v=F();p.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var n=F();g.observer.trigger(i.default.FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:n}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),a,s,o,c,u,l,d,f,h)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),a,s,o,c,u,l,d,f,h)},t.pushDecrypted=function(e,t,r,n,s,o,c,u,l,d,f,h){var g=this.demuxer,p=this.remuxer;if(!g||c||u){for(var v,m=this.observer,w=this.typeSupported,b=this.config,E=[{demux:O,remux:B},{demux:_.default,remux:U},{demux:y,remux:B},{demux:C,remux:B}],T=0,S=E.length;T<S&&!(v=E[T]).demux.probe(e);T++);if(!v)return void m.trigger(i.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});p&&p instanceof v.remux||(p=new v.remux(m,b,w,this.vendor)),g&&g instanceof v.demux||(g=new v.demux(m,p,b,w),this.probe=v.demux.probe),this.demuxer=g,this.remuxer=p}(c||u)&&(g.resetInitSegment(r,n,s,d),p.resetInitSegment()),c&&(g.resetTimeStamp(h),p.resetTimeStamp(h)),"function"==typeof g.setDecryptData&&g.setDecryptData(t),g.append(e,o,l,f)},e}();t.default=V},"./src/demux/demuxer-worker.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/demux/demuxer-inline.js"),a=r("./src/events.js"),n=r("./src/utils/logger.js"),s=r("./node_modules/eventemitter3/index.js");t.default=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];t.emit.apply(t,[e,e].concat(i))},t.off=function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];t.removeListener.apply(t,[e].concat(i))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",(function(a){var s=a.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new i.default(t,s.typeSupported,o,s.vendor),Object(n.enableLogs)(o.debug),r("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}})),t.on(a.default.FRAG_DECRYPTED,r),t.on(a.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(a.default.FRAG_PARSED,r),t.on(a.default.ERROR,r),t.on(a.default.FRAG_PARSING_METADATA,r),t.on(a.default.FRAG_PARSING_USERDATA,r),t.on(a.default.INIT_PTS_FOUND,r),t.on(a.default.FRAG_PARSING_DATA,(function(t,r){var i=[],a={event:t,data:r};r.data1&&(a.data1=r.data1.buffer,i.push(r.data1.buffer),delete r.data1),r.data2&&(a.data2=r.data2.buffer,i.push(r.data2.buffer),delete r.data2),e.postMessage(a,i)}))}},"./src/demux/id3.js":function(e,t,r){"use strict";r.r(t),r.d(t,"utf8ArrayToStr",(function(){return o}));var i,a=r("./src/utils/get-self-scope.js"),n=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var i=r,a=0;e.isHeader(t,r);)a+=10,a+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(a+=10),r+=a;if(a>0)return t.subarray(i,i+a)},e._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),i=0;i<r.length;i++){var a=r[i];if(e.isTimeStampFrame(a))return e._readTimeStamp(a)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),i=e._readSize(t,4);return{type:r,size:i,data:t.subarray(10,10+i)}},e.getID3Frames=function(t){for(var r=0,i=[];e.isHeader(t,r);){for(var a=e._readSize(t,r+6),n=(r+=10)+a;r+8<n;){var s=e._getFrameData(t.subarray(r)),o=e._decodeFrame(s);o&&i.push(o),r+=s.size+10}e.isFooter(t,r)&&(r+=10)}return i},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):e._decodeTextFrame(t)},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data,!0),i=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:i.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,i=e._utf8ArrayToStr(t.data.subarray(r),!0);r+=i.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:a}}var n=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:n}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,i=e._utf8ArrayToStr(t.data.subarray(r),!0);r+=i.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:a}}var n=e._utf8ArrayToStr(t.data);return{key:t.type,data:n}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var r=s();if(r){var i=r.decode(e);if(t){var a=i.indexOf("\0");return-1!==a?i.substring(0,a):i}return i.replace(/\0/g,"")}for(var n,o,c,u=e.length,l="",d=0;d<u;){if(0===(n=e[d++])&&t)return l;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(n);break;case 12:case 13:o=e[d++],l+=String.fromCharCode((31&n)<<6|63&o);break;case 14:o=e[d++],c=e[d++],l+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&c)<<0)}}return l},e}();function s(){var e=Object(a.getSelfScope)();return i||void 0===e.TextDecoder||(i=new e.TextDecoder("utf-8")),i}var o=n._utf8ArrayToStr;t.default=n},"./src/demux/mp4demuxer.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/utils/logger.js"),a=r("./src/events.js"),n=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,r,i,n){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==r&&(r="mp4a.40.5"),null==i&&(i="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:r+","+i,initSegment:n?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:r,initSegment:n?t:null}),s.video&&(o.video={container:"video/mp4",codec:i,initSegment:n?t:null})),this.observer.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else r&&(this.audioCodec=r),i&&(this.videoCodec=i)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var i,a,n,s,o,c,u=[];if(t.data?(o=t.start,n=t.end,t=t.data):(o=0,n=t.byteLength),!r.length)return null;for(i=o;i<n;)c=(a=e.readUint32(t,i))>1?i+a:n,e.bin2str(t.subarray(i+4,i+8))===r[0]&&(1===r.length?u.push({data:t,start:i+8,end:c}):(s=e.findBox({data:t,start:i+8,end:c},r.slice(1))).length&&(u=u.concat(s))),i=c;return u},e.parseSegmentIndex=function(t){var r,i=e.findBox(t,["moov"])[0],a=i?i.end:null,n=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;r=[];var o=(s=s[0]).data[0];n=0===o?8:16;var c=e.readUint32(s,n);n+=4,n+=0===o?8:16,n+=2;var u=s.end+0,l=e.readUint16(s,n);n+=2;for(var d=0;d<l;d++){var f=n,h=e.readUint32(s,f);f+=4;var g=2147483647&h;if(1==(2147483648&h)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var p=e.readUint32(s,f);f+=4,r.push({referenceSize:g,subsegmentDuration:p,info:{duration:p/c,start:u,end:u+g-1}}),u+=g,n=f+=4}return{earliestPresentationTime:0,timescale:c,version:o,referencesCount:l,references:r,moovEndOffset:a}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var a=e.findBox(t,["tkhd"])[0];if(a){var n=a.data[a.start],s=0===n?12:20,o=e.readUint32(a,s),c=e.findBox(t,["mdia","mdhd"])[0];if(c){s=0===(n=c.data[c.start])?12:20;var u=e.readUint32(c,s),l=e.findBox(t,["mdia","hdlr"])[0];if(l){var d={soun:"audio",vide:"video"}[e.bin2str(l.data.subarray(l.start+8,l.start+12))];if(d){var f=e.findBox(t,["mdia","minf","stbl","stsd"]);if(f.length){f=f[0];var h=e.bin2str(f.data.subarray(f.start+12,f.start+16));i.logger.log("MP4Demuxer:"+d+":"+h+" found")}r[o]={timescale:u,type:d},r[d]={timescale:u,id:o}}}}}})),r},e.getStartDTS=function(t,r){var i,a,n;return i=e.findBox(r,["moof","traf"]),a=[].concat.apply([],i.map((function(r){return e.findBox(r,["tfhd"]).map((function(i){var a,n;return a=e.readUint32(i,4),n=t[a].timescale||9e4,e.findBox(r,["tfdt"]).map((function(t){var r,i;return r=t.data[t.start],i=e.readUint32(t,4),1===r&&(i*=Math.pow(2,32),i+=e.readUint32(t,8)),i}))[0]/n}))}))),n=Math.min.apply(null,a),isFinite(n)?n:0},e.offsetStartDTS=function(t,r,i){e.findBox(r,["moof","traf"]).map((function(r){return e.findBox(r,["tfhd"]).map((function(a){var s=e.readUint32(a,4),o=t[s].timescale||9e4;e.findBox(r,["tfdt"]).map((function(t){var r=t.data[t.start],a=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,a-i*o);else{a*=Math.pow(2,32),a+=e.readUint32(t,8),a-=i*o,a=Math.max(a,0);var s=Math.floor(a/(n+1)),c=Math.floor(a%(n+1));e.writeUint32(t,4,s),e.writeUint32(t,8,c)}}))}))}))},t.append=function(t,r,i,n){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,c=this.initPTS;if(void 0===c){var u=e.getStartDTS(s,t);this.initPTS=c=u-r,this.observer.trigger(a.default.INIT_PTS_FOUND,{initPTS:c})}e.offsetStartDTS(s,t,c),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,i,n,t)},t.destroy=function(){},e}();t.default=s},"./src/errors.ts":function(e,t,r){"use strict";var i,a;r.r(t),r.d(t,"ErrorTypes",(function(){return i})),r.d(t,"ErrorDetails",(function(){return a})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(i||(i={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException"}(a||(a={}))},"./src/events.js":function(e,t,r){"use strict";r.r(t),t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},"./src/hls.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return nr}));var i={};r.r(i),r.d(i,"newCue",(function(){return ft}));var a,n,s=r("./node_modules/url-toolkit/src/url-toolkit.js"),o=r("./src/errors.ts"),c=r("./src/polyfills/number.js"),u=r("./src/events.js"),l=r("./src/utils/logger.js"),d={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},f=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(d[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)}),this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){l.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();!function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(a||(a={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(n||(n={}));var h=r("./src/demux/mp4demuxer.js");function g(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var p,v=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,r;return t=e,(r=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(s.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&g(t.prototype,r),e}();function m(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e){e.AUDIO="audio",e.VIDEO="video"}(p||(p={}));var y=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[p.AUDIO]=!1,e[p.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,r,a=e.prototype;return a.setByteRange=function(e,t){var r=e.split("@",2),i=[];1===r.length?i[0]=t?t.byteRangeEndOffset:0:i[0]=parseInt(r[1]),i[1]=parseInt(r[0])+i[0],this._byteRange=i},a.addElementaryStream=function(e){this._elementaryStreams[e]=!0},a.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},a.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},a.setDecryptDataFromLevelKey=function(e,t){var r=e;return(null==e?void 0:e.method)&&e.uri&&!e.iv&&((r=new v(e.baseuri,e.reluri)).method=e.method,r.iv=this.createInitializationVector(t)),r},t=e,(r=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(s.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&l.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(c.isFiniteNumber)(this.programDateTime))return null;var e=Object(c.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&m(t.prototype,r),e}();function _(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var w=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,r;return t=e,(r=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(c.isFiniteNumber)(this.fragments[0].programDateTime))}}])&&_(t.prototype,r),e}(),b=/^(\d+)x(\d+)$/,E=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,T=function(){function e(t){for(var r in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=b.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,r={};for(E.lastIndex=0;null!==(t=E.exec(e));){var i=t[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),r[t[1]]=i}return r},e}(),S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function O(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var C=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,k=/#EXT-X-MEDIA:(.*)/g,L=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),A=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,R=/\.(mp4|m4s|m4v|m4a)$/i,x=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var i=e[r];if(i.id===t)return i}},e.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return s.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,r){var i,a=[],n={},s=!1;function o(e,t){["video","audio"].forEach((function(r){var i=e.filter((function(e){return function(e,t){var r=S[t];return!!r&&!0===r[e.slice(0,4)]}(e,r)}));if(i.length){var a=i.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[r+"Codec"]=a.length>0?a[0]:i[0],e=e.filter((function(e){return-1===i.indexOf(e)}))}})),t.unknownCodecs=e}for(C.lastIndex=0;null!=(i=C.exec(t));)if(i[1]){var c={},u=c.attrs=new T(i[1]);c.url=e.resolve(i[2],r);var l=u.decimalResolution("RESOLUTION");l&&(c.width=l.width,c.height=l.height),c.bitrate=u.decimalInteger("AVERAGE-BANDWIDTH")||u.decimalInteger("BANDWIDTH"),c.name=u.NAME,o([].concat((u.CODECS||"").split(/[ ,]+/)),c),c.videoCodec&&-1!==c.videoCodec.indexOf("avc1")&&(c.videoCodec=e.convertAVC1ToAVCOTI(c.videoCodec)),a.push(c)}else if(i[3]){var d=new T(i[3]);d["DATA-ID"]&&(s=!0,n[d["DATA-ID"]]=d)}return{levels:a,sessionData:s?n:null}},e.parseMasterPlaylistMedia=function(t,r,i,a){var n;void 0===a&&(a=[]);var s=[],o=0;for(k.lastIndex=0;null!==(n=k.exec(t));){var c=new T(n[1]);if(c.TYPE===i){var u={attrs:c,id:o++,groupId:c["GROUP-ID"],instreamId:c["INSTREAM-ID"],name:c.NAME||c.LANGUAGE,type:i,default:"YES"===c.DEFAULT,autoselect:"YES"===c.AUTOSELECT,forced:"YES"===c.FORCED,lang:c.LANGUAGE};if(c.URI&&(u.url=e.resolve(c.URI,r)),a.length){var l=e.findGroup(a,u.groupId);u.audioCodec=l?l.codec:a[0].codec}s.push(u)}}return s},e.parseLevelPlaylist=function(e,t,r,i,a){var n,s,o,u=0,d=0,f=new w(t),h=0,g=null,p=new y,m=null;for(L.lastIndex=0;null!==(n=L.exec(e));){var _=n[1];if(_){p.duration=parseFloat(_);var b=(" "+n[2]).slice(1);p.title=b||null,p.tagList.push(b?["INF",_,b]:["INF",_])}else if(n[3]){if(Object(c.isFiniteNumber)(p.duration)){var E=u++;p.type=i,p.start=d,o&&(p.levelkey=o),p.sn=E,p.level=r,p.cc=h,p.urlId=a,p.baseurl=t,p.relurl=(" "+n[3]).slice(1),P(p,g),f.fragments.push(p),g=p,d+=p.duration,p=new y}}else if(n[4]){var S=(" "+n[4]).slice(1);g?p.setByteRange(S,g):p.setByteRange(S)}else if(n[5])p.rawProgramDateTime=(" "+n[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),null===m&&(m=f.fragments.length);else{if(!(n=n[0].match(A))){l.logger.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<n.length&&void 0===n[s];s++);var O=(" "+n[s+1]).slice(1),C=(" "+n[s+2]).slice(1);switch(n[s]){case"#":p.tagList.push(C?[O,C]:[O]);break;case"PLAYLIST-TYPE":f.type=O.toUpperCase();break;case"MEDIA-SEQUENCE":u=f.startSN=parseInt(O);break;case"TARGETDURATION":f.targetduration=parseFloat(O);break;case"VERSION":f.version=parseInt(O);break;case"EXTM3U":break;case"ENDLIST":f.live=!1;break;case"DIS":h++,p.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":h=parseInt(O);break;case"KEY":var k=new T(O),x=k.enumeratedString("METHOD"),D=k.URI,I=k.hexadecimalInteger("IV");if("com.apple.streamingkeydelivery"===(k.KEYFORMAT||"identity")){l.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}x&&(o=new v(t,D),D&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(x)>=0&&(o.method=x,o.key=null,o.iv=I));break;case"START":var j=new T(O).decimalFloatingPoint("TIME-OFFSET");Object(c.isFiniteNumber)(j)&&(f.startTimeOffset=j);break;case"MAP":var M=new T(O);p.relurl=M.URI,M.BYTERANGE&&p.setByteRange(M.BYTERANGE),p.baseurl=t,p.level=r,p.type=i,p.sn="initSegment",f.initSegment=p,(p=new y).rawProgramDateTime=f.initSegment.rawProgramDateTime;break;default:l.logger.warn("line parsed but not handled: "+n)}}}return(p=g)&&!p.relurl&&(f.fragments.pop(),d-=p.duration),f.totalduration=d,f.averagetargetduration=d/f.fragments.length,f.endSN=u-1,f.startCC=f.fragments[0]?f.fragments[0].cc:0,f.endCC=h,!f.initSegment&&f.fragments.length&&f.fragments.every((function(e){return R.test(e.relurl)}))&&(l.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(p=new y).relurl=f.fragments[0].relurl,p.baseurl=t,p.level=r,p.type=i,p.sn="initSegment",f.initSegment=p,f.needSidxRanges=!0),m&&function(e,t){for(var r=e[t],i=t-1;i>=0;i--){var a=e[i];a.programDateTime=r.programDateTime-1e3*a.duration,r=a}}(f.fragments,m),f},e}();function P(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):(null==t?void 0:t.programDateTime)&&(e.programDateTime=t.endProgramDateTime),Object(c.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var D=window.performance,I=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.MANIFEST_LOADING,u.default.LEVEL_LOADING,u.default.AUDIO_TRACK_LOADING,u.default.SUBTITLE_TRACK_LOADING)||this).loaders={},r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i.canHaveQualityLevels=function(e){return e!==a.AUDIO_TRACK&&e!==a.SUBTITLE_TRACK},i.mapContextToLevelType=function(e){switch(e.type){case a.AUDIO_TRACK:return n.AUDIO;case a.SUBTITLE_TRACK:return n.SUBTITLE;default:return n.MAIN}},i.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r};var s=i.prototype;return s.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,i=t.loader,a=new(r||i)(t);return e.loader=a,this.loaders[e.type]=a,a},s.getInternalLoader=function(e){return this.loaders[e.type]},s.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},s.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},s.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},s.onManifestLoading=function(e){this.load({url:e.url,type:a.MANIFEST,level:0,id:null,responseType:"text"})},s.onLevelLoading=function(e){this.load({url:e.url,type:a.LEVEL,level:e.level,id:e.id,responseType:"text"})},s.onAudioTrackLoading=function(e){this.load({url:e.url,type:a.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},s.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:a.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},s.load=function(e){var t=this.hls.config;l.logger.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var r,i,n,s,o=this.getInternalLoader(e);if(o){var c=o.context;if(c&&c.url===e.url)return l.logger.trace("playlist request ongoing"),!1;l.logger.warn("aborting previous loader for type: "+e.type),o.abort()}switch(e.type){case a.MANIFEST:r=t.manifestLoadingMaxRetry,i=t.manifestLoadingTimeOut,n=t.manifestLoadingRetryDelay,s=t.manifestLoadingMaxRetryTimeout;break;case a.LEVEL:r=0,s=0,n=0,i=t.levelLoadingTimeOut;break;default:r=t.levelLoadingMaxRetry,i=t.levelLoadingTimeOut,n=t.levelLoadingRetryDelay,s=t.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(e);var u={timeout:i,maxRetry:r,retryDelay:n,maxRetryDelay:s},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return l.logger.debug("Calling internal loader delegate for URL: "+e.url),o.load(e,u,d),!0},s.loadsuccess=function(e,t,r,i){if(void 0===i&&(i=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,i);if(this.resetInternalLoader(r.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var a=e.data;t.tload=D.now(),0===a.indexOf("#EXTM3U")?a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,r,i):this._handleMasterPlaylist(e,t,r,i):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",i)},s.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},s.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},s._handleMasterPlaylist=function(e,t,r,a){var n=this.hls,s=e.data,o=i.getResponseUrl(e,r),c=x.parseMasterPlaylist(s,o),d=c.levels,f=c.sessionData;if(d.length){var h=d.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),g=x.parseMasterPlaylistMedia(s,o,"AUDIO",h),p=x.parseMasterPlaylistMedia(s,o,"SUBTITLES"),v=x.parseMasterPlaylistMedia(s,o,"CLOSED-CAPTIONS");if(g.length){var m=!1;g.forEach((function(e){e.url||(m=!0)})),!1===m&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(l.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}n.trigger(u.default.MANIFEST_LOADED,{levels:d,audioTracks:g,subtitles:p,captions:v,url:o,stats:t,networkDetails:a,sessionData:f})}else this._handleManifestParsingError(e,r,"no level found in manifest",a)},s._handleTrackOrLevelPlaylist=function(e,t,r,n){var s=this.hls,l=r.id,d=r.level,f=r.type,h=i.getResponseUrl(e,r),g=Object(c.isFiniteNumber)(l)?l:0,p=Object(c.isFiniteNumber)(d)?d:g,v=i.mapContextToLevelType(r),m=x.parseLevelPlaylist(e.data,h,p,v,g);if(m.tload=t.tload,m.fragments.length){if(f===a.MANIFEST){var y={url:h,details:m};s.trigger(u.default.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:h,stats:t,networkDetails:n,sessionData:null})}if(t.tparsed=D.now(),m.needSidxRanges){var _=m.initSegment.url;this.load({url:_,isSidxRequest:!0,type:f,level:d,levelDetails:m,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else r.levelDetails=m,this._handlePlaylistLoaded(e,t,r,n)}else s.trigger(u.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:h,reason:"no fragments found in level",level:"number"==typeof r.level?r.level:void 0})},s._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var r=h.default.parseSegmentIndex(new Uint8Array(e.data));if(r){var i=r.references,a=t.levelDetails;i.forEach((function(e,t){var r=e.info;if(a){var i=a.fragments[t];0===i.byteRange.length&&i.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}})),a&&a.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},s._handleManifestParsingError=function(e,t,r,i){this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:i})},s._handleNetworkError=function(e,t,r,i){var n,s;void 0===r&&(r=!1),void 0===i&&(i=null),l.logger.info("A network error occured while loading a "+e.type+"-type playlist");var c=this.getInternalLoader(e);switch(e.type){case a.MANIFEST:n=r?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case a.LEVEL:n=r?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case a.AUDIO_TRACK:n=r?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;default:s=!1}c&&(c.abort(),this.resetInternalLoader(e.type));var d={type:o.ErrorTypes.NETWORK_ERROR,details:n,fatal:s,url:e.url,loader:c,context:e,networkDetails:t};i&&(d.response=i),this.hls.trigger(u.default.ERROR,d)},s._handlePlaylistLoaded=function(e,t,r,n){var s=r.type,o=r.level,c=r.id,l=r.levelDetails;if(l&&l.targetduration)if(i.canHaveQualityLevels(r.type))this.hls.trigger(u.default.LEVEL_LOADED,{details:l,level:o||0,id:c||0,stats:t,networkDetails:n});else switch(s){case a.AUDIO_TRACK:this.hls.trigger(u.default.AUDIO_TRACK_LOADED,{details:l,id:c,stats:t,networkDetails:n});break;case a.SUBTITLE_TRACK:this.hls.trigger(u.default.SUBTITLE_TRACK_LOADED,{details:l,id:c,stats:t,networkDetails:n})}else this._handleManifestParsingError(e,r,"invalid target duration",n)},i}(f),j=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.FRAG_LOADING)||this).loaders={},r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.destroy=function(){var t=this.loaders;for(var r in t){var i=t[r];i&&i.destroy()}this.loaders={},e.prototype.destroy.call(this)},a.onFragLoading=function(e){var t=e.frag,r=t.type,i=this.loaders,a=this.hls.config,n=a.fLoader,s=a.loader;t.loaded=0;var o,u,d,f=i[r];f&&(l.logger.warn("abort previous fragment loader for type: "+r),f.abort()),f=i[r]=t.loader=a.fLoader?new n(a):new s(a),o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var h=t.byteRangeStartOffset,g=t.byteRangeEndOffset;Object(c.isFiniteNumber)(h)&&Object(c.isFiniteNumber)(g)&&(o.rangeStart=h,o.rangeEnd=g),u={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},f.load(o,u,d)},a.loadsuccess=function(e,t,r,i){void 0===i&&(i=null);var a=e.data,n=r.frag;n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(u.default.FRAG_LOADED,{payload:a,frag:n,stats:t,networkDetails:i})},a.loaderror=function(e,t,r){void 0===r&&(r=null);var i=t.frag,a=i.loader;a&&a.abort(),this.loaders[i.type]=void 0,this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},a.loadtimeout=function(e,t,r){void 0===r&&(r=null);var i=t.frag,a=i.loader;a&&a.abort(),this.loaders[i.type]=void 0,this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},a.loadprogress=function(e,t,r,i){void 0===i&&(i=null);var a=t.frag;a.loaded=e.loaded,this.hls.trigger(u.default.FRAG_LOAD_PROGRESS,{frag:a,stats:e,networkDetails:i})},i}(f),M=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.KEY_LOADING)||this).loaders={},r.decryptkey=null,r.decrypturl=null,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.destroy=function(){for(var t in this.loaders){var r=this.loaders[t];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},a.onKeyLoading=function(e){var t=e.frag,r=t.type,i=this.loaders[r];if(t.decryptdata){var a=t.decryptdata.uri;if(a!==this.decrypturl||null===this.decryptkey){var n=this.hls.config;if(i&&(l.logger.warn("abort previous key loader for type:"+r),i.abort()),!a)return void l.logger.warn("key uri is falsy");t.loader=this.loaders[r]=new n.loader(n),this.decrypturl=a,this.decryptkey=null;var s={url:a,frag:t,responseType:"arraybuffer"},o={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:n.fragLoadingRetryDelay,maxRetryDelay:n.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(s,o,c)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(u.default.KEY_LOADED,{frag:t}))}else l.logger.warn("Missing decryption data on fragment in onKeyLoading")},a.loadsuccess=function(e,t,r){var i=r.frag;i.decryptdata?(this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=void 0,delete this.loaders[i.type],this.hls.trigger(u.default.KEY_LOADED,{frag:i})):l.logger.error("after key load, decryptdata unset")},a.loaderror=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),delete this.loaders[r.type],this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},a.loadtimeout=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),delete this.loaders[r.type],this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},i}(f),F="NOT_LOADED",B="APPENDING",U="PARTIAL",N="OK",V=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.BUFFER_APPENDED,u.default.FRAG_BUFFERED,u.default.FRAG_LOADED)||this).bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=t.config,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,f.prototype.destroy.call(this),e.prototype.destroy.call(this)},a.getBufferedFrag=function(e,t){var r=this.fragments,i=Object.keys(r).filter((function(i){var a=r[i];if(a.body.type!==t)return!1;if(!a.buffered)return!1;var n=a.body;return n.startPTS<=e&&e<=n.endPTS}));if(0===i.length)return null;var a=i.pop();return r[a].body},a.detectEvictedFragments=function(e,t){var r=this;Object.keys(this.fragments).forEach((function(i){var a=r.fragments[i];if(a&&a.buffered){var n=a.range[e];if(n)for(var s=n.time,o=0;o<s.length;o++){var c=s[o];if(!r.isTimeBuffered(c.startPTS,c.endPTS,t)){r.removeFragment(a.body);break}}}}))},a.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),i=this.fragments[r];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach((function(r){if(e.hasElementaryStream(r)){var a=t.timeRanges[r];i.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,a)}})))},a.getBufferedTimes=function(e,t,r){for(var i,a,n=[],s=!1,o=0;o<r.length;o++){if(i=r.start(o)-this.bufferPadding,a=r.end(o)+this.bufferPadding,e>=i&&t<=a){n.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))});break}if(e<a&&t>i)n.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))}),s=!0;else if(t<=i)break}return{time:n,partial:s}},a.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},a.getPartialFragment=function(e){var t,r,i,a=this,n=null,s=0;return Object.keys(this.fragments).forEach((function(o){var c=a.fragments[o];a.isPartial(c)&&(r=c.body.startPTS-a.bufferPadding,i=c.body.endPTS+a.bufferPadding,e>=r&&e<=i&&(t=Math.min(e-r,i-e),s<=t&&(n=c.body,s=t)))})),n},a.getState=function(e){var t=this.getFragmentKey(e),r=this.fragments[t],i=F;return void 0!==r&&(i=r.buffered?!0===this.isPartial(r)?U:N:B),i},a.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},a.isTimeBuffered=function(e,t,r){for(var i,a,n=0;n<r.length;n++){if(i=r.start(n)-this.bufferPadding,a=r.end(n)+this.bufferPadding,e>=i&&t<=a)return!0;if(t<=i)return!1}return!1},a.onFragLoaded=function(e){var t=e.frag;Object(c.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},a.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)}))},a.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},a.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},a.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},a.removeAllFragments=function(){this.fragments=Object.create(null)},i}(f),H=function(e,t){for(var r=0,i=e.length-1,a=null,n=null;r<=i;){var s=t(n=e[a=(r+i)/2|0]);if(s>0)r=a+1;else{if(!(s<0))return n;i=a-1}}return null},G=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var i,a=e.buffered,n=[];for(i=0;i<a.length;i++)n.push({start:a.start(i),end:a.end(i)});return this.bufferedInfo(n,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var i=[];if(r)for(var a=0;a<e.length;a++){var n=i.length;if(n){var s=i[n-1].end;e[a].start-s<r?e[a].end>s&&(i[n-1].end=e[a].end):i.push(e[a])}else i.push(e[a])}else i=e;for(var o,c=0,u=t,l=t,d=0;d<i.length;d++){var f=i[d].start,h=i[d].end;if(t+r>=f&&t<h)u=f,c=(l=h)-t;else if(t+r<f){o=f;break}}return{len:c,start:u,end:l,nextStart:o}},e}(),K=r("./node_modules/eventemitter3/index.js"),$=r("./node_modules/webworkify-webpack/index.js"),W=r("./src/demux/demuxer-inline.js");function q(){return window.MediaSource||window.WebKitMediaSource}var z=r("./src/utils/get-self-scope.js"),Y=function(e){var t,r;function i(){return e.apply(this,arguments)||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i.prototype.trigger=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.emit.apply(this,[e,e].concat(r))},i}(K.EventEmitter),X=Object(z.getSelfScope)(),Z=q()||{isTypeSupported:function(){return!1}},J=function(){function e(e,t){var r=this;this.hls=e,this.id=t;var i=this.observer=new Y,a=e.config,n=function(t,i){(i=i||{}).frag=r.frag,i.id=r.id,e.trigger(t,i)};i.on(u.default.FRAG_DECRYPTED,n),i.on(u.default.FRAG_PARSING_INIT_SEGMENT,n),i.on(u.default.FRAG_PARSING_DATA,n),i.on(u.default.FRAG_PARSED,n),i.on(u.default.ERROR,n),i.on(u.default.FRAG_PARSING_METADATA,n),i.on(u.default.FRAG_PARSING_USERDATA,n),i.on(u.default.INIT_PTS_FOUND,n);var s={mp4:Z.isTypeSupported("video/mp4"),mpeg:Z.isTypeSupported("audio/mpeg"),mp3:Z.isTypeSupported('audio/mp4; codecs="mp3"')},c=navigator.vendor;if(a.enableWorker&&"undefined"!=typeof Worker){var d;l.logger.log("demuxing in webworker");try{d=this.w=$("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),d.addEventListener("message",this.onwmsg),d.onerror=function(t){e.trigger(u.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},d.postMessage({cmd:"init",typeSupported:s,vendor:c,id:t,config:JSON.stringify(a)})}catch(e){l.logger.warn("Error in worker:",e),l.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),d&&X.URL.revokeObjectURL(d.objectURL),this.demuxer=new W.default(i,s,a,c),this.w=void 0}}else this.demuxer=new W.default(i,s,a,c)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.push=function(e,t,r,i,a,n,s,o){var u=this.w,d=Object(c.isFiniteNumber)(a.startPTS)?a.startPTS:a.start,f=a.decryptdata,h=this.frag,g=!(h&&a.cc===h.cc),p=!(h&&a.level===h.level),v=h&&a.sn===h.sn+1,m=!p&&v;if(g&&l.logger.log(this.id+":discontinuity detected"),p&&l.logger.log(this.id+":switch detected"),this.frag=a,u)u.postMessage({cmd:"demux",data:e,decryptdata:f,initSegment:t,audioCodec:r,videoCodec:i,timeOffset:d,discontinuity:g,trackSwitch:p,contiguous:m,duration:n,accurateTimeOffset:s,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var y=this.demuxer;y&&y.push(e,f,t,r,i,d,g,p,m,n,s,o)}},t.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":X.URL.revokeObjectURL(this.w.objectURL);break;case u.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},e}();function Q(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}}function ee(e,t,r){var i=e[t],a=e[r],n=a.startPTS;if(Object(c.isFiniteNumber)(n))r>t?(i.duration=n-i.start,i.duration<0&&l.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(a.duration=i.start-n,a.duration<0&&l.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!"));else if(r>t){var s=i.cc===a.cc;a.start=i.start+(s&&i.minEndPTS?i.minEndPTS-i.start:i.duration)}else a.start=Math.max(i.start-a.duration,0)}function te(e,t,r,i,a,n){var s=r,o=i;if(Object(c.isFiniteNumber)(t.startPTS)){var u=Math.abs(t.startPTS-r);Object(c.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(u,t.deltaPTS):t.deltaPTS=u,s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),o=Math.min(i,t.endPTS),i=Math.max(i,t.endPTS),a=Math.min(a,t.startDTS),n=Math.max(n,t.endDTS)}var l=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=i,t.minEndPTS=o,t.startDTS=a,t.endDTS=n,t.duration=i-r;var d,f,h,g=t.sn;if(!e||g<e.startSN||g>e.endSN)return 0;for(d=g-e.startSN,(f=e.fragments)[d]=t,h=d;h>0;h--)ee(f,h,h-1);for(h=d;h<f.length-1;h++)ee(f,h,h+1);return e.PTSKnown=!0,l}function re(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var r,i=0;if(ie(e,t,(function(e,a){i=e.cc-a.cc,Object(c.isFiniteNumber)(e.startPTS)&&(a.start=a.startPTS=e.startPTS,a.endPTS=e.endPTS,a.duration=e.duration,a.backtracked=e.backtracked,a.dropped=e.dropped,r=a),t.PTSKnown=!0})),t.PTSKnown){if(i){l.logger.log("discontinuity sliding from playlist, take drift into account");for(var a=t.fragments,n=0;n<a.length;n++)a[n].cc+=i}r?te(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):function(e,t){var r=t.startSN-e.startSN,i=e.fragments,a=t.fragments;if(!(r<0||r>i.length))for(var n=0;n<a.length;n++)a[n].start+=i[r].start}(e,t),t.PTSKnown=e.PTSKnown}}function ie(e,t,r){if(e&&t)for(var i=Math.max(e.startSN,t.startSN)-t.startSN,a=Math.min(e.endSN,t.endSN)-t.startSN,n=t.startSN-e.startSN,s=i;s<=a;s++){var o=e.fragments[n+s],c=t.fragments[s];if(!o||!c)break;r(o,c,s)}}function ne(e,t,r){var i=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),a=i/2;return e&&t.endSN===e.endSN&&(i=a),r&&(i=Math.max(a,i-(window.performance.now()-r))),Math.round(i)}var oe=function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i).toFixed(3)+","+e.end(i).toFixed(3)+"]";return t};function ae(e,t){t.fragments.forEach((function(t){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}})),t.PTSKnown=!0}function se(e,t,r){!function(e,t,r){if(function(e,t,r){var i=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(i=!0),i}(e,r,t)){var i=function(e,t){var r=e.fragments,i=t.fragments;if(i.length&&r.length){var a=function(e,t){for(var r=null,i=0;i<e.length;i+=1){var a=e[i];if(a&&a.cc===t){r=a;break}}return r}(r,i[0].cc);if(a&&(!a||a.startPTS))return a;l.logger.log("No frag in previous level to align on")}else l.logger.log("No fragments to align")}(r.details,t);i&&(l.logger.log("Adjusting PTS using last level due to CC increase within current level"),ae(i.start,t))}}(e,r,t),!r.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=t.fragments[0].programDateTime,i=(e.fragments[0].programDateTime-r)/1e3+t.fragments[0].start;Object(c.isFiniteNumber)(i)&&(l.logger.log("adjusting PTS using programDateTime delta, sliding:"+i.toFixed(3)),ae(i,e))}}(r,t.details)}function ce(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!Object(c.isFiniteNumber)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(var i=0;i<e.length;++i){var a=e[i];if(de(t,r,a))return a}return null}function le(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var a=null;return e?a=t[e.sn-t[0].sn+1]:0===r&&0===t[0].start&&(a=t[0]),a&&0===ue(r,i,a)?a:H(t,ue.bind(null,r,i))||a}function ue(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=e?1:r.start-i>e&&r.start?-1:0}function de(e,t,r){var i=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-i>e}var fe=function(){function e(e,t,r,i){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=i,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,r=this.media,i=this.stalled,a=r.currentTime,n=r.seeking,s=this.seeking&&!n,o=!this.seeking&&n;if(this.seeking=n,a===e){if((o||s)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&r.buffered.length){var c=G.bufferInfo(r,a,0),u=c.len>0,d=c.nextStart||0;if(u||d){if(n){var f=c.len>2,h=!d||d-a>2&&!this.fragmentTracker.getPartialFragment(a);if(f||h)return;this.moved=!1}if(!this.moved&&this.stalled){var g=Math.max(d,c.start||0)-a;if(g>0&&g<=2)return void this._trySkipBufferHole(null)}var p=self.performance.now();if(null!==i){var v=p-i;!n&&v>=250&&this._reportStall(c.len);var m=G.bufferInfo(r,a,t.maxBufferHole);this._tryFixBufferStall(m,v)}else this.stalled=p}}}else if(this.moved=!0,null!==i){if(this.stallReported){var y=self.performance.now()-i;l.logger.warn("playback not stuck anymore @"+a+", after "+Math.round(y)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var r=this.config,i=this.fragmentTracker,a=this.media.currentTime,n=i.getPartialFragment(a);n&&this._trySkipBufferHole(n)||e.len>r.maxBufferHole&&t>1e3*r.highBufferWatchdogPeriod&&(l.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,l.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer (buffer="+e+")"),t.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,r=this.hls,i=this.media,a=i.currentTime,n=0,s=0;s<i.buffered.length;s++){var c=i.buffered.start(s);if(a+t.maxBufferHole>=n&&a<c){var d=Math.max(c+.05,i.currentTime+.1);return l.logger.warn("skipping hole, adjusting currentTime from "+a+" to "+d),this.moved=!0,this.stalled=null,i.currentTime=d,e&&r.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+a+" to "+d,frag:e}),d}n=i.buffered.end(s)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,i=r.currentTime,a=(this.nudgeRetry||0)+1;if(this.nudgeRetry=a,a<e.nudgeMaxRetry){var n=i+a*e.nudgeOffset;l.logger.warn("Nudging 'currentTime' from "+i+" to "+n),r.currentTime=n,t.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}();function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var pe=function(e){var t,r;function i(t){for(var r,i=arguments.length,a=new Array(i>1?i-1:0),n=1;n<i;n++)a[n-1]=arguments[n];return(r=e.call.apply(e,[this,t].concat(a))||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(he(r)),r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},a.hasInterval=function(){return!!this._tickInterval},a.hasNextTick=function(){return!!this._tickTimer},a.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},a.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},a.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},a.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},a.doTick=function(){},i}(f),ge="STOPPED",ve="STARTING",me="IDLE",ye="KEY_LOADING",be="FRAG_LOADING",_e="FRAG_LOADING_WAITING_RETRY",we="WAITING_TRACK",Ee="PARSING",Te="PARSED",Se="BUFFER_FLUSHING",Oe="ENDED",Ce="ERROR",ke="WAITING_INIT_PTS",Le="WAITING_LEVEL",Ae=function(e){var t,r;function i(){return e.apply(this,arguments)||this}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.doTick=function(){},a.startLoad=function(){},a.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ge},a._streamEnded=function(e,t){var r=this.fragCurrent,i=this.fragmentTracker;if(!t.live&&r&&!r.backtracked&&r.sn===t.endSN&&!e.nextStart){var a=i.getState(r);return a===U||a===N}return!1},a.onMediaSeeking=function(){var e=this.config,t=this.media,r=this.mediaBuffer,i=this.state,a=t?t.currentTime:null,n=G.bufferInfo(r||t,a,this.config.maxBufferHole);if(l.logger.log("media seeking to "+(Object(c.isFiniteNumber)(a)?a.toFixed(3):a)),i===be){var s=this.fragCurrent;if(0===n.len&&s){var o=e.maxFragLookUpTolerance,u=s.start-o,d=s.start+s.duration+o;a<u||a>d?(s.loader&&(l.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=me):l.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else i===Oe&&(0===n.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=me);t&&(this.lastCurrentTime=a),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=a),this.tick()},a.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},a.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},a.onHandlerDestroyed=function(){this.state=ge,this.fragmentTracker=null},a.computeLivePosition=function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},i}(pe);function Re(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xe,Pe=function(e){var t,r;function i(t,r){var i;return(i=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.LEVEL_LOADED,u.default.LEVELS_UPDATED,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.FRAG_LOAD_EMERGENCY_ABORTED,u.default.FRAG_PARSING_INIT_SEGMENT,u.default.FRAG_PARSING_DATA,u.default.FRAG_PARSED,u.default.ERROR,u.default.AUDIO_TRACK_SWITCHING,u.default.AUDIO_TRACK_SWITCHED,u.default.BUFFER_CREATED,u.default.BUFFER_APPENDED,u.default.BUFFER_FLUSHED)||this).fragmentTracker=r,i.config=t.config,i.audioCodecSwap=!1,i._state=ge,i.stallReported=!1,i.gapController=null,i.altAudio=!1,i.audioOnly=!1,i.bitrateTest=!1,i}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,s,d=i.prototype;return d.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=r.startLevel;-1===i&&(r.config.testBandwidth?(i=0,this.bitrateTest=!0):i=r.nextAutoLevel),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}t>0&&-1===e&&(l.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=me,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=ge},d.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},d.doTick=function(){switch(this.state){case Se:this.fragLoadError=0;break;case me:this._doTickIdle();break;case Le:var e=this.levels[this.level];e&&e.details&&(this.state=me);break;case _e:var t=window.performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(l.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=me)}this._checkBuffer(),this._checkFragmentChanged()},d._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch))if(this.altAudio&&this.audioOnly)this.demuxer.frag=null;else{var i;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var a=e.nextLoadLevel,n=this.levels[a];if(n){var s,o=n.bitrate;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var c=i<t.maxBufferHole?Math.max(2,t.maxBufferHole):t.maxBufferHole,d=G.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,c),f=d.len;if(!(f>=s)){l.logger.trace("buffer length of "+f.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=a;var h=n.details;if(!h||h.live&&this.levelLastLoaded!==a)this.state=Le;else{if(this._streamEnded(d,h)){var g={};return this.altAudio&&(g.type="video"),this.hls.trigger(u.default.BUFFER_EOS,g),void(this.state=Oe)}this._fetchPayloadOrEos(i,d,h)}}}}},d._fetchPayloadOrEos=function(e,t,r){var i=this.fragPrevious,a=(this.level,r.fragments),n=a.length;if(0!==n){var s,o=a[0].start,c=a[n-1].start+a[n-1].duration,u=t.end;if(r.initSegment&&!r.initSegment.data)s=r.initSegment;else if(r.live){var d=this.config.initialLiveManifestSize;if(n<d)return void l.logger.warn("Can not start playback of a level, reason: not enough fragments "+n+" < "+d);if(null===(s=this._ensureFragmentAtLivePoint(r,u,o,c,i,a)))return}else u<o&&(s=a[0]);s||(s=this._findFragment(o,i,n,a,u,c,r)),s&&(s.encrypted?this._loadKey(s,r):this._loadFragment(s,r,e,u))}},d._ensureFragmentAtLivePoint=function(e,t,r,i,a,n){var s,o=this.hls.config,u=this.media,d=1/0;if(void 0!==o.liveMaxLatencyDuration?d=o.liveMaxLatencyDuration:Object(c.isFiniteNumber)(o.liveMaxLatencyDurationCount)&&(d=o.liveMaxLatencyDurationCount*e.targetduration),t<Math.max(r-o.maxFragLookUpTolerance,i-d)){var f=this.liveSyncPosition=this.computeLivePosition(r,e);t=f,u&&!u.paused&&u.readyState&&u.duration>f&&f>u.currentTime&&(l.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),u.currentTime=f),this.nextLoadPosition=f}if(e.PTSKnown&&t>i&&u&&u.readyState)return null;if(this.startFragRequested&&!e.PTSKnown&&a)if(e.hasProgramDateTime)l.logger.log("live playlist, switching playlist, load frag with same PDT: "+a.programDateTime),s=ce(n,a.endProgramDateTime,o.maxFragLookUpTolerance);else{var h=a.sn+1;if(h>=e.startSN&&h<=e.endSN){var g=n[h-e.startSN];a.cc===g.cc&&(s=g,l.logger.log("live playlist, switching playlist, load frag with next SN: "+s.sn))}s||(s=H(n,(function(e){return a.cc-e.cc})))&&l.logger.log("live playlist, switching playlist, load frag with same CC: "+s.sn)}return s},d._findFragment=function(e,t,r,i,a,n,s){var o,c=this.hls.config;if(o=a<n?le(t,i,a,a>n-c.maxFragLookUpTolerance?0:c.maxFragLookUpTolerance):i[r-1]){var u=o.sn-s.startSN,d=t&&o.level===t.level,f=i[u-1],h=i[u+1];if(t&&o.sn===t.sn)if(d&&!o.backtracked)if(o.sn<s.endSN){var g=t.deltaPTS;g&&g>c.maxBufferHole&&t.dropped&&u?(o=f,l.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(o=h,this.fragmentTracker.getState(o)!==N&&l.logger.log("Re-loading fragment with SN: "+o.sn))}else o=null;else o.backtracked&&(h&&h.backtracked?(l.logger.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+h.sn),o=h):(l.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,f?(o=f).backtracked=!0:u&&(o=null)))}return o},d._loadKey=function(e,t){l.logger.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level),this.state=ye,this.hls.trigger(u.default.KEY_LOADING,{frag:e})},d._loadFragment=function(e,t,r,i){var a=this.fragmentTracker.getState(e);this.fragCurrent=e,"initSegment"!==e.sn&&(this.startFragRequested=!0),Object(c.isFiniteNumber)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||a===F||a===U?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,l.logger.log("Loading "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(r.toFixed(3))+", bufferEnd: "+parseFloat(i.toFixed(3))),this.hls.trigger(u.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new J(this.hls,"main")),this.state=be):a===B&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},d.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,n.MAIN)},d.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},d._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),G.isBuffered(r,t)?e=this.getBufferedFrag(t):G.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var i=e;if(i!==this.fragPlaying){this.hls.trigger(u.default.FRAG_CHANGED,{frag:i});var a=i.level;this.fragPlaying&&this.fragPlaying.level===a||this.hls.trigger(u.default.LEVEL_SWITCHED,{level:a}),this.fragPlaying=i}}},d.immediateLevelSwitch=function(){if(l.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused)||t.pause():e=!0,this.previouslyPaused=e}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},d.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,e.currentTime>0&&G.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},d.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,r=this.getBufferedFrag(e.currentTime);if(r&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),e.paused)t=0;else{var i=this.hls.nextLoadLevel,a=this.levels[i],n=this.fragLastKbps;t=n&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*n)+1:0}var s=this.getBufferedFrag(e.currentTime+t);if(s){var o=this.followingBufferedFrag(s);if(o){var c=this.fragCurrent;c&&c.loader&&c.loader.abort(),this.fragCurrent=null;var u=Math.max(s.endPTS,o.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,o.duration));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}},d.flushMainBuffer=function(e,t){this.state=Se;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(u.default.BUFFER_FLUSHING,r)},d.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new fe(r,t,this.fragmentTracker,this.hls)},d.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(l.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},d.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(c.isFiniteNumber)(t)&&l.logger.log("media seeked to "+t.toFixed(3)),this.tick()},d.onManifestLoading=function(){l.logger.log("trigger BUFFER_RESET"),this.hls.trigger(u.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},d.onManifestParsed=function(e){var t,r=!1,i=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(i=!0))})),this.audioCodecSwitch=r&&i,this.audioCodecSwitch&&l.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var a=this.config;(a.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(a.startPosition)},d.onLevelLoaded=function(e){var t=e.details,r=e.level,i=this.levels[this.levelLastLoaded],a=this.levels[r],n=t.totalduration,s=0;if(l.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+n),t.live||a.details&&a.details.live){var o=a.details;o&&t.fragments.length>0?(re(o,t),s=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,o),t.PTSKnown&&Object(c.isFiniteNumber)(s)?l.logger.log("live playlist sliding:"+s.toFixed(3)):(l.logger.log("live playlist - outdated PTS, unknown sliding"),se(this.fragPrevious,i,t))):(l.logger.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,se(this.fragPrevious,i,t))}else t.PTSKnown=!1;if(a.details=t,this.levelLastLoaded=r,this.hls.trigger(u.default.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var d=t.startTimeOffset;Object(c.isFiniteNumber)(d)?(d<0&&(l.logger.log("negative start time offset "+d+", count from end of last fragment"),d=s+n+d),l.logger.log("start time offset found in playlist, adjust startPosition to "+d),this.startPosition=d):t.live?(this.startPosition=this.computeLivePosition(s,t),l.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Le&&(this.state=me),this.tick()},d.onKeyLoaded=function(){this.state===ye&&(this.state=me,this.tick())},d.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,i=this.levels,a=this.media,n=e.frag;if(this.state===be&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var s=e.stats,o=i[t.level],c=o.details;if(this.bitrateTest=!1,this.stats=s,l.logger.log("Loaded "+t.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+t.level),n.bitrateTest&&r.nextLoadLevel)this.state=me,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),r.trigger(u.default.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=me,s.tparsed=s.tbuffered=window.performance.now(),c.initSegment.data=e.payload,r.trigger(u.default.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{l.logger.log("Parsing "+t.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+t.level+", cc "+t.cc),this.state=Ee,this.pendingBuffering=!0,this.appended=!1,n.bitrateTest&&(n.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:n}));var d=!(a&&a.seeking)&&(c.PTSKnown||!c.live),f=c.initSegment?c.initSegment.data:[],h=this._getAudioCodec(o);(this.demuxer=this.demuxer||new J(this.hls,"main")).push(e.payload,f,h,o.videoCodec,t,c.totalduration,d)}}this.fragLoadError=0},d.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===Ee){var i,a,n=e.tracks;if(this.audioOnly=n.audio&&!n.video,this.altAudio&&!this.audioOnly&&delete n.audio,a=n.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(l.logger.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==a.container&&(s="mp4a.40.2",l.logger.log("Android: force audio codec to "+s)),a.levelCodec=s,a.id=e.id}for(i in(a=n.video)&&(a.levelCodec=this.levels[this.level].videoCodec,a.id=e.id),this.hls.trigger(u.default.BUFFER_CODECS,n),n){a=n[i],l.logger.log("main track:"+i+",container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var c=a.initSegment;c&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.default.BUFFER_APPENDING,{type:i,data:c,parent:"main",content:"initSegment"}))}this.tick()}},d.onFragParsingData=function(e){var t=this,r=this.fragCurrent,i=e.frag;if(r&&"main"===e.id&&i.sn===r.sn&&i.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===Ee){var a=this.levels[this.level],n=r;if(Object(c.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),!0===e.hasAudio&&n.addElementaryStream(p.AUDIO),!0===e.hasVideo&&n.addElementaryStream(p.VIDEO),l.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(n.dropped=e.dropped,n.dropped)if(n.backtracked)l.logger.warn("Already backtracked on this fragment, appending with the gap",n.sn);else{var s=a.details;if(!s||n.sn!==s.startSN)return l.logger.warn("missing video frame(s), backtracking fragment",n.sn),this.fragmentTracker.removeFragment(n),n.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=me,this.fragPrevious=n,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),void this.tick();l.logger.warn("missing video frame(s) on first frag, appending with gap",n.sn)}else n.backtracked=!1;var o=te(a.details,n,e.startPTS,e.endPTS,e.startDTS,e.endDTS),d=this.hls;d.trigger(u.default.LEVEL_PTS_UPDATED,{details:a.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(r){r&&r.length&&t.state===Ee&&(t.appended=!0,t.pendingBuffering=!0,d.trigger(u.default.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))})),this.tick()}},d.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===Ee&&(this.stats.tparsed=window.performance.now(),this.state=Te,this._checkAppendedParsed())},d.onAudioTrackSwitching=function(e){var t=this.altAudio,r=!!e.url,i=e.id;if(!r){if(this.mediaBuffer!==this.media){l.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;a.loader&&(l.logger.log("switching to main audio track, cancel main fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=me}var n=this.hls;t&&n.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),n.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:i})}},d.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(l.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},d.onBufferCreated=function(e){var t,r,i=e.tracks,a=!1;for(var n in i){var s=i[n];"main"===s.id?(r=n,t=s,"video"===n&&(this.videoBuffer=i[n].buffer)):a=!0}a&&t?(l.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},d.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==Ee&&t!==Te||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},d._checkAppendedParsed=function(){if(!(this.state!==Te||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;l.logger.log("main buffered : "+oe(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(u.default.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=me}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},d.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=!!this.media&&G.isBuffered(this.media,this.media.currentTime)&&G.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);l.logger.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=window.performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=_e}else l.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ce;break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==Ce&&(e.fatal?(this.state=Ce,l.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==Le||(this.state=me));break;case o.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==Ee&&this.state!==Te||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=me):(l.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},d._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,l.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},d._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},d.onFragLoadEmergencyAborted=function(){this.state=me,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},d.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;if(e){var t=this.audioOnly?p.AUDIO:p.VIDEO;this.fragmentTracker.detectEvictedFragments(t,e.buffered)}this.state=me,this.fragPrevious=null},d.onLevelsUpdated=function(e){this.levels=e.levels},d.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},d._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=this.startPosition;if(t!==r&&r>=0){if(e.seeking)return void l.logger.log("could not seek to "+r+", already seeking at "+t);var i=(e.buffered.length?e.buffered.start(0):0)-r;i>0&&i<this.config.maxBufferHole&&(l.logger.log("adjusting start position by "+i+" to match buffer start"),r+=i,this.startPosition=r),l.logger.log("seek to target start position "+r+" from current time "+t+". ready state "+e.readyState),e.currentTime=r}},d._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(l.logger.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},a=i,(s=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,l.logger.log("main stream-controller: "+t+"->"+e),this.hls.trigger(u.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&Re(a.prototype,s),i}(Ae);function De(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ie=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.MANIFEST_LOADED,u.default.LEVEL_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.FRAG_LOADED,u.default.ERROR)||this).canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,xe=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,n,c=i.prototype;return c.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},c.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},c.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},c.stopLoad=function(){this.canload=!1},c.onManifestLoaded=function(e){var t,r=[],i=[],a={},n=null,s=!1,c=!1;if(e.levels.forEach((function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,s=s||!!e.videoCodec,c=c||!!e.audioCodec,xe&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(n=a[e.bitrate])?n.url.push(e.url):(e.url=[e.url],e.urlId=0,a[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&Q(n||e,"audio",t.AUDIO),t.SUBTITLES&&Q(n||e,"text",t.SUBTITLES))})),s&&c&&(r=r.filter((function(e){return!!e.videoCodec}))),r=r.filter((function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||O(t,"audio"))&&(!r||O(r,"video"))})),e.audioTracks&&(i=e.audioTracks.filter((function(e){return!e.audioCodec||O(e.audioCodec,"audio")}))).forEach((function(e,t){e.id=t})),r.length>0){t=r[0].bitrate,r.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=r;for(var d=0;d<r.length;d++)if(r[d].bitrate===t){this._firstLevel=d,l.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}var f=c&&!s;this.hls.trigger(u.default.MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:e.stats,audio:c,video:s,altAudio:!f&&i.some((function(e){return!!e.url}))})}else this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},c.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){l.logger.log("switching to level "+e),this.currentLevelIndex=e;var i=t[e];i.level=e,r.trigger(u.default.LEVEL_SWITCHING,i)}var a=t[e],n=a.details;if(!n||n.live){var s=a.urlId;r.trigger(u.default.LEVEL_LOADING,{url:a.url[s],level:e,id:s})}}else r.trigger(u.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},c.onError=function(e){if(e.fatal)e.type===o.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,i=!1;switch(e.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,i=!0;break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case o.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,i)}},c.recoverLevel=function(e,t,r,i){var a,n,s,o=this,c=this.hls.config,u=e.details,d=this._levels[t];if(d.loadError++,d.fragmentError=i,r){if(!(this.levelRetryCount+1<=c.levelLoadingMaxRetry))return l.logger.error("level controller, cannot recover from "+u+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);n=Math.min(Math.pow(2,this.levelRetryCount)*c.levelLoadingRetryDelay,c.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return o.loadLevel()}),n),e.levelRetry=!0,this.levelRetryCount++,l.logger.warn("level controller, "+u+", retry in "+n+" ms, current retry count is "+this.levelRetryCount)}(r||i)&&((a=d.url.length)>1&&d.loadError<a?(d.urlId=(d.urlId+1)%a,d.details=void 0,l.logger.warn("level controller, "+u+" for level "+t+": switching to redundant URL-id "+d.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,l.logger.warn("level controller, "+u+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):i&&(l.logger.warn("level controller, "+u+": reload a fragment"),this.currentLevelIndex=null))},c.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var r=this._levels[t.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},c.onLevelLoaded=function(e){var t=this,r=e.level,i=e.details;if(r===this.currentLevelIndex){var a=this._levels[r];if(a.fragmentError||(a.loadError=0,this.levelRetryCount=0),i.live){var n=ne(a.details,i,e.stats.trequest);l.logger.log("live playlist, reload in "+Math.round(n)+" ms"),this.timer=setTimeout((function(){return t.loadLevel()}),n)}else this.clearTimer()}},c.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var i=-1,a=0;a<r.audioGroupIds.length;a++)if(r.audioGroupIds[a]===t){i=a;break}i!==r.urlId&&(r.urlId=i,this.startLoad())}},c.loadLevel=function(){if(l.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,r=e.urlId,i=e.url[r];l.logger.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(u.default.LEVEL_LOADING,{url:i,level:t,id:r})}}},c.removeLevel=function(e,t){var r=this.levels.filter((function(r,i){return i!==e||r.url.length>1&&void 0!==t&&(r.url=r.url.filter((function(e,r){return r!==t})),r.urlId=0,!0)})).map((function(e,t){var r=e.details;return r&&r.fragments&&r.fragments.forEach((function(e){e.level=t})),e}));this._levels=r,this.hls.trigger(u.default.LEVELS_UPDATED,{levels:r})},a=i,(n=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&De(a.prototype,n),i}(f),je=r("./src/demux/id3.js");function Me(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function Fe(e){if(null==e?void 0:e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}var Be=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.FRAG_PARSING_METADATA,u.default.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,r.media=void 0,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.destroy=function(){f.prototype.destroy.call(this)},a.onMediaAttached=function(e){this.media=e.media,this.media},a.onMediaDetaching=function(){Fe(this.id3Track),this.id3Track=void 0,this.media=void 0},a.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return Me(r,this.media),r}return this.media.addTextTrack("metadata","id3")},a.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,a=0;a<r.length;a++){var n=je.default.getID3Frames(r[a].data);if(n){var s=Math.max(r[a].pts,0),o=a<r.length-1?r[a+1].pts:t.endPTS;o||(o=t.start+t.duration),o-s<=0&&(o=s+.25);for(var c=0;c<n.length;c++){var u=n[c];if(!je.default.isTimeStampFrame(u)){var l=new i(s,o,"");l.value=u,this.id3Track.addCue(l)}}}}},a.onLiveBackBufferReached=function(e){var t=e.bufferEnd,r=this.id3Track;if(r&&r.cues&&r.cues.length){var i=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var r=0,i=e.length-1;r<=i;){var a=Math.floor((i+r)/2);if(t<e[a].endTime)i=a-1;else{if(!(t>e[a].endTime))return e[a];r=a+1}}return e[r].endTime-t<t-e[i].endTime?e[r]:e[i]}(r.cues,t);if(i)for(;r.cues[0]!==i;)r.removeCue(r.cues[0])}},i}(f),Ue=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),Ne=function(){function e(e,t,r,i){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Ue(t),this.fast_=new Ue(r)}var t=e.prototype;return t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/r;this.fast_.sample(r,i),this.slow_.sample(r,i)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function Ve(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var He=window.performance,Ge=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.FRAG_LOADING,u.default.FRAG_LOADED,u.default.FRAG_BUFFERED,u.default.ERROR)||this).lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=t,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,n,d=i.prototype;return d.destroy=function(){this.clearTimer(),f.prototype.destroy.call(this)},d.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r,i,a=this.hls,n=a.config,s=t.level;a.levels[s].details.live?(r=n.abrEwmaFastLive,i=n.abrEwmaSlowLive):(r=n.abrEwmaFastVoD,i=n.abrEwmaSlowVoD),this._bwEstimator=new Ne(a,i,r,n.abrEwmaDefaultEstimate)}},d._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var i=r.loader;if(!i||i.stats&&i.stats.aborted)return l.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=i.stats;if(t&&a&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var n=He.now()-a.trequest,s=Math.abs(t.playbackRate);if(n>500*r.duration/s){var o=e.levels,c=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/n),d=o[r.level];if(!d)return;var f=d.realBitrate?Math.max(d.realBitrate,d.bitrate):d.bitrate,h=a.total?a.total:Math.max(a.loaded,Math.round(r.duration*f/8)),g=t.currentTime,p=(h-a.loaded)/c,v=(G.bufferInfo(t,g,e.config.maxBufferHole).end-g)/s;if(v<2*r.duration/s&&p>v){var m,y=e.minAutoLevel;for(m=r.level-1;m>y;m--){var _=o[m].realBitrate?Math.max(o[m].realBitrate,o[m].bitrate):o[m].bitrate;if(r.duration*_/(6.4*c)<v)break}void 0<p&&(l.logger.warn("loading too slow, abort fragment loading and switch to level "+m+":fragLoadedDelay["+m+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+p.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=m,this._bwEstimator.sample(n,a.loaded),i.abort(),this.clearTimer(),e.trigger(u.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:a}))}}}}},d.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(c.isFiniteNumber)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],i=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,a=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:i,duration:a},r.realBitrate=Math.round(8*i/a)}if(e.frag.bitrateTest){var n=e.stats;n.tparsed=n.tbuffered=n.tload,this.onFragBuffered(e)}}},d.onFragBuffered=function(e){var t=e.stats,r=e.frag;if(!0!==t.aborted&&"main"===r.type&&Object(c.isFiniteNumber)(r.sn)&&(!r.bitrateTest||t.tload===t.tbuffered)){var i=t.tparsed-t.trequest;l.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(i,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},d.onError=function(e){switch(e.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},d.clearTimer=function(){clearInterval(this.timer),this.timer=null},d._findBestLevel=function(e,t,r,i,a,n,s,o,c){for(var u=a;u>=i;u--){var d=c[u];if(d){var p,f=d.details,h=f?f.totalduration/f.fragments.length:t,g=!!f&&f.live;p=u<=e?s*r:o*r;var v=c[u].realBitrate?Math.max(c[u].realBitrate,c[u].bitrate):c[u].bitrate,m=v*h/p;if(l.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(p)+"/"+v+"/"+h+"/"+n+"/"+m),p>v&&(!m||g&&!this.bitrateTestDelay||m<n))return u}}return-1},a=i,(n=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,i=e.config,a=e.minAutoLevel,n=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,c=n?n.currentTime:0,u=n&&0!==n.playbackRate?Math.abs(n.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,f=(G.bufferInfo(n,c,i.maxBufferHole).end-c)/u,h=this._findBestLevel(s,o,d,a,t,f,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(h>=0)return h;l.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var g=o?Math.min(o,i.maxStarvationDelay):i.maxStarvationDelay,p=i.abrBandWidthFactor,v=i.abrBandWidthUpFactor;if(0===f){var m=this.bitrateTestDelay;m&&(g=(o?Math.min(o,i.maxLoadingDelay):i.maxLoadingDelay)-m,l.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms"),p=v=1)}return h=this._findBestLevel(s,o,d,a,t,f+g,p,v,r),Math.max(h,0)}}])&&Ve(a.prototype,n),i}(f),Ke=q(),$e=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.MANIFEST_PARSED,u.default.BUFFER_RESET,u.default.BUFFER_APPENDING,u.default.BUFFER_CODECS,u.default.BUFFER_EOS,u.default.BUFFER_FLUSHING,u.default.LEVEL_PTS_UPDATED,u.default.LEVEL_UPDATED)||this)._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r._needsFlush=!1,r._needsEos=!1,r.config=void 0,r.audioTimestampOffset=void 0,r.bufferCodecEventsExpected=0,r._bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.segments=[],r.parent=void 0,r.appending=!1,r.appended=0,r.appendError=0,r.flushBufferCounter=0,r.tracks={},r.pendingTracks={},r.sourceBuffer={},r.flushRange=[],r._onMediaSourceOpen=function(){l.logger.log("media source opened"),r.hls.trigger(u.default.MEDIA_ATTACHED,{media:r.media});var e=r.mediaSource;e&&e.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},r._onMediaSourceClose=function(){l.logger.log("media source closed")},r._onMediaSourceEnded=function(){l.logger.log("media source ended")},r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var e=r.sourceBuffer.audio;l.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+r.audioTimestampOffset),e.timestampOffset=r.audioTimestampOffset,delete r.audioTimestampOffset}r._needsFlush&&r.doFlush(),r._needsEos&&r.checkEos(),r.appending=!1;var t=r.parent,i=r.segments.reduce((function(e,r){return r.parent===t?e+1:e}),0),a={},n=r.sourceBuffer;for(var s in n){var o=n[s];if(!o)throw Error("handling source buffer update end error: source buffer for "+s+" uninitilized and unable to update buffered TimeRanges.");a[s]=o.buffered}r.hls.trigger(u.default.BUFFER_APPENDED,{parent:t,pending:i,timeRanges:a}),r._needsFlush||r.doAppending(),r.updateMediaElementDuration(),0===i&&r.flushLiveBackBuffer()},r._onSBUpdateError=function(e){l.logger.error("sourceBuffer error:",e),r.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.config=t.config,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.destroy=function(){f.prototype.destroy.call(this)},a.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var i=this.sourceBuffer.audio;if(!i)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(i.timestampOffset-e.start)>.1){var a=i.updating;try{i.abort()}catch(e){l.logger.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(l.logger.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+e.start),i.timestampOffset=e.start)}}},a.onManifestParsed=function(e){var t=2;(e.audio&&!e.video||!e.altAudio)&&(t=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=t,l.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},a.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&Ke){var r=this.mediaSource=new Ke;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},a.onMediaDetaching=function(){l.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){l.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):l.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(u.default.MEDIA_DETACHED)},a.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},a.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this._onSBUpdateEnd),r.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},a.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach((function(r){t.pendingTracks[r]=e[r]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},a.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var i in e)if(!t[i]){var a=e[i];if(!a)throw Error("source buffer exists for track "+i+", however track does not");var n=a.levelCodec||a.codec,s=a.container+";codecs="+n;l.logger.log("creating sourceBuffer("+s+")");try{var c=t[i]=r.addSourceBuffer(s);c.addEventListener("updateend",this._onSBUpdateEnd),c.addEventListener("error",this._onSBUpdateError),this.tracks[i]={buffer:c,codec:n,id:a.id,container:a.container,levelCodec:a.levelCodec}}catch(e){l.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(u.default.BUFFER_CREATED,{tracks:this.tracks})},a.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},a.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var r=this.sourceBuffer[t];r&&!r.ended&&(r.ended=!0,l.logger.log(t+" sourceBuffer now EOS"))}this.checkEos()},a.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var i=e[r];if(i){if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}}l.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){l.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},a.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},a.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,r=this.sourceBuffer,i=Object.keys(r),a=t-Math.max(e,this._levelTargetDuration),n=i.length-1;n>=0;n--){var s=i[n],o=r[s];if(o){var c=o.buffered;c.length>0&&a>c.start(0)&&this.removeBufferRange(s,o,0,a)&&this.hls.trigger(u.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:a})}}else l.logger.error("flushLiveBackBuffer called without attaching media")}},a.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},a.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var i=this.sourceBuffer[r];if(i&&!0===i.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(l.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(c.isFiniteNumber)(e))&&(l.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},a.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var i in r){var a=r[i];a&&(t+=a.buffered.length)}}catch(e){l.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(u.default.BUFFER_FLUSHED)}},a.doAppending=function(){var e=this.config,t=this.hls,r=this.segments,i=this.sourceBuffer;if(Object.keys(i).length){if(!this.media||this.media.error)return this.segments=[],void l.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var a=r.shift();if(a)try{var n=i[a.type];if(!n)return void this._onSBUpdateEnd();if(n.updating)return void r.unshift(a);n.ended=!1,this.parent=a.parent,n.appendBuffer(a.data),this.appendError=0,this.appended++,this.appending=!0}catch(i){l.logger.error("error while trying to append buffer:"+i.message),r.unshift(a);var s={type:o.ErrorTypes.MEDIA_ERROR,parent:a.parent,details:"",fatal:!1};22===i.code?(this.segments=[],s.details=o.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,s.details=o.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(l.logger.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0)),t.trigger(u.default.ERROR,s)}}}},a.flushBuffer=function(e,t,r){var i=this.sourceBuffer;if(!Object.keys(i).length)return!0;var a="null";if(this.media&&(a=this.media.currentTime.toFixed(3)),l.logger.log("flushBuffer,pos/start/end: "+a+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return l.logger.warn("abort flushing too many retries"),!0;var n=i[r];if(n){if(n.ended=!1,n.updating)return l.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(r,n,e,t))return this.flushBufferCounter++,!1}return l.logger.log("buffer flushed"),!0},a.removeBufferRange=function(e,t,r,i){try{for(var a=0;a<t.buffered.length;a++){var n=t.buffered.start(a),s=t.buffered.end(a),o=Math.max(n,r),c=Math.min(s,i);if(Math.min(c,s)-o>.5){var u="null";return this.media&&(u=this.media.currentTime.toString()),l.logger.log("sb remove "+e+" ["+o+","+c+"], of ["+n+","+s+"], pos:"+u),t.remove(o,c),!0}}}catch(e){l.logger.warn("removeBufferRange failed",e)}return!1},i}(f);function qe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var We=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.FPS_DROP_LEVEL_CAPPING,u.default.MEDIA_ATTACHING,u.default.MANIFEST_PARSED,u.default.LEVELS_UPDATED,u.default.BUFFER_CODECS,u.default.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,r.firstLevel=null,r.levels=[],r.media=null,r.restrictedLevels=[],r.timer=null,r.clientRect=null,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,n,s,o=i.prototype;return o.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},o.onFpsDropLevelCapping=function(e){i.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},o.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},o.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onLevelsUpdated=function(e){this.levels=e.levels},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},o.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var r=this.levels.filter((function(r,a){return i.isLevelAllowed(a,t.restrictedLevels)&&a<=e}));return this.clientRect=null,i.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},o.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t},i.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},i.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var i,a,n=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=r)&&(i=o,!(a=e[s+1])||i.width!==a.width||i.height!==a.height)){n=s;break}}return n},a=i,s=[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(n=[{key:"mediaWidth",get:function(){return this.getDimensions().width*i.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*i.contentScaleFactor}}])&&qe(a.prototype,n),s&&qe(a,s),i}(f),ze=window.performance,Ye=function(e){var t,r;function i(t){return e.call(this,t,u.default.MEDIA_ATTACHING)||this}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},a.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},a.checkFPS=function(e,t,r){var i=ze.now();if(t){if(this.lastTime){var a=i-this.lastTime,n=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*n/a,c=this.hls;if(c.trigger(u.default.FPS_DROP,{currentDropped:n,currentDecoded:s,totalDroppedFrames:r}),o>0&&n>c.config.fpsDroppedMonitoringThreshold*s){var d=c.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=d)&&(d-=1,c.trigger(u.default.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,c.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},a.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},i}(f),Xe=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new window.XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(e,t.url)}catch(r){e.open("GET",t.url,!0),i(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,i=this.stats,a=this.context,n=this.config;if(!i.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(window.performance.now(),i.trequest)),4===r){var s=t.status;if(s>=200&&s<300){var o,c;i.tload=Math.max(i.tfirst,window.performance.now()),c="arraybuffer"===a.responseType?(o=t.response).byteLength:(o=t.responseText).length,i.loaded=i.total=c;var u={url:t.responseURL,data:o};this.callbacks.onSuccess(u,i,a,t)}else i.retry>=n.maxRetry||s>=400&&s<499?(l.logger.error(s+" while loading "+a.url),this.callbacks.onError({code:s,text:t.statusText},a,t)):(l.logger.warn(s+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,n.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),n.timeout)},t.loadtimeout=function(){l.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,t)},e}();function Ze(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Je=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.AUDIO_TRACK_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.LEVEL_LOADED,u.default.ERROR)||this)._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,n,c=i.prototype;return c.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},c.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(u.default.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},c.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)l.logger.warn("Invalid audio track id:",e.id);else{if(l.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},c.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},c.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},c.onError=function(e){e.type===o.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(l.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},c._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)l.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)l.logger.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];l.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var r=t.url,i=t.type,a=t.id;this.hls.trigger(u.default.AUDIO_TRACK_SWITCHING,{id:a,type:i,url:r}),this._loadTrackDetailsIfNeeded(t)}},c.doTick=function(){this._updateTrack(this._trackId)},c._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var r=t.audioGroupIds[t.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},c._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var r=this.tracks[this._trackId],i=null;if(r&&(i=r.name),this._selectDefaultTrack){var a=t.filter((function(e){return e.default}));a.length?t=a:l.logger.warn("No default audio tracks defined")}var n=!1,s=function(){t.forEach((function(t){n||e.audioGroupId&&t.groupId!==e.audioGroupId||i&&i!==t.name||(e._setAudioTrack(t.id),n=!0)}))};s(),n||(i=null,s()),n||(l.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},c._needsTrackLoading=function(e){var t=e.details,r=e.url;return!(t&&!t.live||!r)},c._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,r=e.id;l.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(u.default.AUDIO_TRACK_LOADING,{url:t,id:r})}},c._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,l.logger.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},c._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,i=t.language,a=t.groupId;l.logger.warn("Loading failed on audio track id: "+e+", group-id: "+a+', name/language: "'+r+'" / "'+i+'"');for(var n=e,s=0;s<this.tracks.length;s++)if(!this.trackIdBlacklist[s]&&this.tracks[s].name===r){n=s;break}n!==e?(l.logger.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId),this._setAudioTrack(n)):l.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+i+'"')},a=i,(n=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&Ze(a.prototype,n),i}(pe);function Qe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var et=window.performance,rt=function(e){var t,r;function i(t,r){var i;return(i=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.AUDIO_TRACKS_UPDATED,u.default.AUDIO_TRACK_SWITCHING,u.default.AUDIO_TRACK_LOADED,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.FRAG_PARSING_INIT_SEGMENT,u.default.FRAG_PARSING_DATA,u.default.FRAG_PARSED,u.default.ERROR,u.default.BUFFER_RESET,u.default.BUFFER_CREATED,u.default.BUFFER_APPENDED,u.default.BUFFER_FLUSHED,u.default.INIT_PTS_FOUND)||this).fragmentTracker=r,i.config=t.config,i.audioCodecSwap=!1,i._state=ge,i.initPTS=[],i.waitingFragment=null,i.videoTrackCC=null,i.waitingVideoCC=null,i}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,n,d=i.prototype;return d.onInitPtsFound=function(e){var t=e.id,r=e.frag.cc,i=e.initPTS;"main"===t&&(this.initPTS[r]=i,this.videoTrackCC=r,l.logger.log("InitPTS for cc: "+r+" found from main: "+i),this.state===ke&&this.tick())},d.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(l.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=me):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=ve),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=ge},d.doTick=function(){var e,t,r,i=this.hls,a=i.config;switch(this.state){case Ce:case"PAUSED":case Se:break;case ve:this.state=we,this.loadedmetadata=!1;break;case me:var n=this.tracks;if(!n)break;if(!this.media&&(this.startFragRequested||!a.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var s=this.mediaBuffer?this.mediaBuffer:this.media,o=this.videoBuffer?this.videoBuffer:this.media,d=e<a.maxBufferHole?Math.max(2,a.maxBufferHole):a.maxBufferHole,f=G.bufferInfo(s,e,d),h=G.bufferInfo(o,e,d),g=f.len,p=f.end,v=this.fragPrevious,m=Math.min(a.maxBufferLength,a.maxMaxBufferLength),y=Math.max(m,h.len),_=this.audioSwitch,w=this.trackId;if((g<y||_)&&w<n.length){if(void 0===(r=n[w].details)){this.state=we;break}if(!_&&this._streamEnded(f,r))return this.hls.trigger(u.default.BUFFER_EOS,{type:"audio"}),void(this.state=Oe);var b,E=r.fragments,T=E.length,S=E[0].start,O=E[T-1].start+E[T-1].duration;if(_)if(r.live&&!r.PTSKnown)l.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=e,r.PTSKnown&&e<S){if(!(f.end>S||f.nextStart))return;l.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=S+.05}if(r.initSegment&&!r.initSegment.data)b=r.initSegment;else if(p<=S){if(b=E[0],null!==this.videoTrackCC&&b.cc!==this.videoTrackCC&&(b=function(e,t){return H(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(E,this.videoTrackCC)),r.live&&b.loadIdx&&b.loadIdx===this.fragLoadIdx){var C=f.nextStart?f.nextStart:S;return l.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(C+.05)),void(this.media.currentTime=C+.05)}}else{var k,L=a.maxFragLookUpTolerance,A=v?E[v.sn-E[0].sn+1]:void 0;p<O?(p>O-L&&(L=0),k=A&&!ue(p,L,A)?A:H(E,(function(e){return ue(p,L,e)}))):k=E[T-1],k&&(b=k,S=k.start,v&&b.level===v.level&&b.sn===v.sn&&(b.sn<r.endSN?(b=E[b.sn+1-r.startSN],this.fragmentTracker.getState(b)!==N&&l.logger.log("SN just loaded, load next one: "+b.sn)):b=null))}b&&(b.encrypted?(l.logger.log("Loading key for "+b.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+w),this.state=ye,i.trigger(u.default.KEY_LOADING,{frag:b})):(this.fragCurrent=b,(_||this.fragmentTracker.getState(b)===F)&&(l.logger.log("Loading "+b.sn+", cc: "+b.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+w+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+e+", bufferEnd: "+p.toFixed(3)),"initSegment"!==b.sn&&(this.startFragRequested=!0),Object(c.isFiniteNumber)(b.sn)&&(this.nextLoadPosition=b.start+b.duration),i.trigger(u.default.FRAG_LOADING,{frag:b}),this.state=be)))}break;case we:(t=this.tracks[this.trackId])&&t.details&&(this.state=me);break;case _e:var R=et.now(),x=this.retryDate,P=(s=this.media)&&s.seeking;(!x||R>=x||P)&&(l.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=me);break;case ke:var D=this.waitingFragment;if(D){var I=D.frag.cc;if(void 0!==this.initPTS[I])this.waitingFragment=null,this.state=be,this.onFragLoaded(D);else if(this.videoTrackCC!==this.waitingVideoCC)l.logger.log("Waiting fragment cc ("+I+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var j=G.bufferInfo(this.mediaBuffer,this.media.currentTime,a.maxBufferHole);ue(j.end,a.maxFragLookUpTolerance,D.frag)<0&&(l.logger.log("Waiting fragment cc ("+I+") @ "+D.frag.start+" cancelled because another fragment at "+j.end+" is needed"),this.clearWaitingFragment())}}else this.state=me}},d.clearWaitingFragment=function(){var e=this.waitingFragment;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=me)},d.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},d.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(l.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},d.onAudioTracksUpdated=function(e){l.logger.log("audio tracks updated"),this.tracks=e.audioTracks},d.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state="PAUSED",t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=me),this.tick()},d.onAudioTrackLoaded=function(e){var t=e.details,r=e.id,i=this.tracks[r],a=i.details,n=t.totalduration,s=0;if(l.logger.log("track "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+n),t.live||a&&a.live?a&&t.fragments.length>0?(re(a,t),s=t.fragments[0].start,t.PTSKnown?l.logger.log("live audio playlist sliding:"+s.toFixed(3)):l.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,l.logger.log("live audio playlist - first load, unknown sliding")):t.PTSKnown=!1,i.details=t,!this.startFragRequested){if(-1===this.startPosition){var o=t.startTimeOffset;Object(c.isFiniteNumber)(o)?(l.logger.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):t.live?(this.startPosition=this.computeLivePosition(s,t),l.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===we&&(this.state=me),this.tick()},d.onKeyLoaded=function(){this.state===ye&&(this.state=me,this.tick())},d.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===be&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var i=this.tracks[this.trackId],a=i.details,n=a.totalduration,s=t.level,o=t.sn,c=t.cc,d=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",f=this.stats=e.stats;if("initSegment"===o)this.state=me,f.tparsed=f.tbuffered=et.now(),a.initSegment.data=e.payload,this.hls.trigger(u.default.FRAG_BUFFERED,{stats:f,frag:t,id:"audio"}),this.tick();else{this.state=Ee,this.appended=!1,this.demuxer||(this.demuxer=new J(this.hls,"audio"));var h=this.initPTS[c],g=a.initSegment?a.initSegment.data:[];void 0!==h?(this.pendingBuffering=!0,l.logger.log("Demuxing "+o+" of ["+a.startSN+" ,"+a.endSN+"],track "+s),this.demuxer.push(e.payload,g,d,null,t,n,!1,h)):(l.logger.log("Unknown video PTS for cc "+c+", waiting for video PTS before demuxing audio frag "+o+" of ["+a.startSN+" ,"+a.endSN+"],track "+s),this.waitingFragment=e,this.waitingVideoCC=this.videoTrackCC,this.state=ke)}}this.fragLoadError=0},d.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===Ee){var i,a=e.tracks;if(a.video&&delete a.video,i=a.audio){i.levelCodec=i.codec,i.id=e.id,this.hls.trigger(u.default.BUFFER_CODECS,a),l.logger.log("audio track:audio,container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var n=i.initSegment;if(n){var s={type:"audio",data:n,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.default.BUFFER_APPENDING,s))}this.tick()}}},d.onFragParsingData=function(e){var t=this,r=this.fragCurrent,i=e.frag;if(r&&"audio"===e.id&&"audio"===e.type&&i.sn===r.sn&&i.level===r.level&&this.state===Ee){var a=this.trackId,n=this.tracks[a],s=this.hls;Object(c.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),r.addElementaryStream(p.AUDIO),l.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),te(n.details,r,e.startPTS,e.endPTS);var d=this.media,f=!1;if(this.audioSwitch)if(d&&d.readyState){var h=d.currentTime;l.logger.log("switching audio track : currentTime:"+h),h>=e.startPTS&&(l.logger.log("switching audio track : flushing all audio"),this.state=Se,s.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),f=!0,this.audioSwitch=!1,s.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:a}))}else this.audioSwitch=!1,s.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:a});var g=this.pendingData;if(!g)return l.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(u.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&g.push({type:e.type,data:t,parent:"audio",content:"data"})})),!f&&g.length&&(g.forEach((function(e){t.state===Ee&&(t.pendingBuffering=!0,t.hls.trigger(u.default.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},d.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===Ee&&(this.stats.tparsed=et.now(),this.state=Te,this._checkAppendedParsed())},d.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},d.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},d.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==Ee&&t!==Te||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},d._checkAppendedParsed=function(){if(!(this.state!==Te||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=et.now(),r.trigger(u.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;i&&l.logger.log("audio buffered : "+oe(i.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=me}this.tick()}},d.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:var r=e.frag;if(r&&"audio"!==r.type)break;if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var a=this.config;if(i<=a.fragLoadingMaxRetry){this.fragLoadError=i;var n=Math.min(Math.pow(2,i-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);l.logger.warn("AudioStreamController: frag loading failed, retry in "+n+" ms"),this.retryDate=et.now()+n,this.state=_e}else l.logger.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ce}break;case o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==Ce&&(this.state=e.fatal?Ce:me,l.logger.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case o.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===Ee||this.state===Te)){var s=this.mediaBuffer,c=this.media.currentTime;if(s&&G.isBuffered(s,c)&&G.isBuffered(s,c+.5)){var d=this.config;d.maxMaxBufferLength>=d.maxBufferLength&&(d.maxMaxBufferLength/=2,l.logger.warn("AudioStreamController: reduce max buffer length to "+d.maxMaxBufferLength+"s")),this.state=me}else l.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Se,this.hls.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},d.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(l.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach((function(t){e.hls.trigger(u.default.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=Te):(this.state=me,this.fragPrevious=null,this.tick())},a=i,(n=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,l.logger.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}])&&Qe(a.prototype,n),i}(Ae),tt=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function r(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]=r[i]}return e}function a(t,a,n){var s=this,o={enumerable:!0};s.hasBeenReset=!1;var c="",u=!1,l=t,d=a,f=n,h=null,g="",p=!0,v="auto",m="start",y=50,_="middle",w=50,b="middle";Object.defineProperty(s,"id",i({},o,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(s,"pauseOnExit",i({},o,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(s,"startTime",i({},o,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",i({},o,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",i({},o,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",i({},o,{get:function(){return h},set:function(e){h=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",i({},o,{get:function(){return g},set:function(t){var r=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");g=r,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",i({},o,{get:function(){return p},set:function(e){p=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",i({},o,{get:function(){return v},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",i({},o,{get:function(){return m},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",i({},o,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",i({},o,{get:function(){return _},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",i({},o,{get:function(){return w},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");w=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",i({},o,{get:function(){return b},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),s.displayState=void 0}return a.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},a}(),it=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function nt(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new it,this.regionList=[]}function ot(){this.values=Object.create(null)}function at(e,t,r,i){var a=i?e.split(i):[e];for(var n in a)if("string"==typeof a[n]){var s=a[n].split(r);2===s.length&&t(s[0],s[1])}}ot.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var st=new tt(0,0,0),ct="middle"===st.align?"middle":"center";function dt(e,t,r){var i=e;function a(){var t=function(e){function t(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function n(){e=e.replace(/^\s+/,"")}if(n(),t.startTime=a(),n(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.substr(3),n(),t.endTime=a(),n(),function(e,t){var i=new ot;at(e,(function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){i.set(e,r[a].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var n=t.split(","),s=n[0];i.integer(e,s),i.percent(e,s)&&i.set("snapToLines",!1),i.alt(e,s,["auto"]),2===n.length&&i.alt("lineAlign",n[1],["start",ct,"end"]);break;case"position":n=t.split(","),i.percent(e,n[0]),2===n.length&&i.alt("positionAlign",n[1],["start",ct,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",ct,"end","left","right"])}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");var a=i.get("line","auto");"auto"===a&&-1===st.line&&(a=-1),t.line=a,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",ct);var n=i.get("position","auto");"auto"===n&&50===st.position&&(n="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=n}(e,t)}function lt(e){return e.replace(/<br(?: \/)?>/gi,"\n")}nt.prototype={parse:function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=lt(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var i=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),i}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(i=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var n=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(n?n=!1:i=r(),t.state){case"HEADER":/:/.test(i)?at(i,(function(e,t){}),/:/):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new tt(0,0,""),t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":try{dt(i,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==i.indexOf("--\x3e");if(!i||s&&(n=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var ut=nt;function ft(e,t,r,i){for(var a,n,s,o,c,u=[],l=window.VTTCue||TextTrackCue,d=0;d<i.rows.length;d++)if(s=!0,o=0,c="",!(a=i.rows[d]).isEmpty()){for(var f=0;f<a.chars.length;f++)a.chars[f].uchar.match(/\s/)&&s?o++:(c+=a.chars[f].uchar,s=!1);a.cueStartTime=t,t===r&&(r+=1e-4),n=new l(t,r,lt(c.trim())),o>=16?o--:o++,navigator.userAgent.match(/Firefox\//)?n.line=d+1:n.line=d>7?d-2:d+1,n.align="left",n.position=Math.max(0,Math.min(100,o/32*100)),u.push(n),e&&e.addCue(n)}return u}var ht,pt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},gt=function(e){var t=e;return pt.hasOwnProperty(e)&&(t=pt[e]),String.fromCharCode(t)},vt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},mt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},yt={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},bt={25:2,26:4,29:6,30:8,31:10,27:13,28:15},_t=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(ht||(ht={}));var wt=function(){function e(){this.time=null,this.verboseLevel=ht.ERROR}return e.prototype.log=function(e,t){this.verboseLevel>=e&&l.logger.log(this.time+" ["+e+"] "+t)},e}(),Et=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},Tt=function(){function e(e,t,r,i,a){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=i||"black",this.flash=a||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),St=function(){function e(e,t,r,i,a,n){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Tt(t,r,i,a,n)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),Ot=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<100;t++)this.chars.push(new St);this.logger=e,this.pos=0,this.currPenState=new Tt}var t=e.prototype;return t.equals=function(e){for(var t=!0,r=0;r<100;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(ht.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(ht.DEBUG,"Too large cursor position "+this.pos),this.pos=100)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=gt(e);this.pos>=100?this.logger.log(ht.ERROR,"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<100;r++){var i=this.chars[r].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Ct=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<15;t++)this.rows.push(new Ot(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(ht.INFO,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(ht.INFO,"pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<15;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var n=a.rows[i].cueStartTime,s=this.logger.time;if(n&&null!==s&&n<s)for(var o=0;o<this.nrRollUpRows;o++)this.rows[t-this.nrRollUpRows+o+1].copy(a.rows[i+o])}}this.currRow=t;var c=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,l=Math.max(u-1,0);c.setCursor(e.indent),e.color=c.chars[l].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},t.setBkgData=function(e){this.logger.log(ht.INFO,"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(ht.TEXT,this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(ht.INFO,"Rolling up")}else this.logger.log(ht.DEBUG,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",i=-1,a=0;a<15;a++){var n=this.rows[a].getTextString();n&&(i=a+1,e?t.push("Row "+i+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),kt=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Ct(r),this.nonDisplayedMemory=new Ct(r),this.lastOutputScreen=new Ct(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(ht.INFO,"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(ht.INFO,r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(ht.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(ht.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(ht.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(ht.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(ht.INFO,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(ht.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(ht.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(ht.INFO,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(ht.INFO,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(ht.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(ht.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(ht.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(this.logger.log(ht.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(ht.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(ht.INFO,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(ht.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}();function Lt(e,t,r){r.a=e,r.b=t}function At(e,t,r){return r.a===e&&r.b===t}var Rt=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var i=new wt;this.channels=[null,new kt(e,t,i),new kt(e+1,r,i)],this.cmdHistory={a:null,b:null},this.logger=i}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var r,i,a,n=!1;this.logger.time=e;for(var s=0;s<t.length;s+=2)if(i=127&t[s],a=127&t[s+1],0!==i||0!==a){if(this.logger.log(ht.DATA,"["+Et([t[s],t[s+1]])+"] -> ("+Et([i,a])+")"),(r=this.parseCmd(i,a))||(r=this.parseMidrow(i,a)),r||(r=this.parsePAC(i,a)),r||(r=this.parseBackgroundAttributes(i,a)),!r&&(n=this.parseChars(i,a))){var o=this.currentChannel;o&&o>0?this.channels[o].insertChars(n):this.logger.log(ht.WARNING,"No channel found yet. TEXT-MODE?")}r||n||this.logger.log(ht.WARNING,"Couldn't parse cleaned data "+Et([i,a])+" orig: "+Et([t[s],t[s+1]]))}},t.parseCmd=function(e,t){var r=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(At(e,t,r))return Lt(null,null,r),this.logger.log(ht.DEBUG,"Repeated command ("+Et([e,t])+") is dropped"),!0;var i=20===e||21===e||23===e?1:2,a=this.channels[i];return 20===e||21===e||28===e||29===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),Lt(e,t,r),this.currentChannel=i,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&t>=32&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(ht.ERROR,"Mismatch channel in midrow parsing"),!1;var i=this.channels[r];return!!i&&(i.ccMIDROW(t),this.logger.log(ht.DEBUG,"MIDROW ("+Et([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var r,i=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(At(e,t,i))return Lt(null,null,i),!0;var a=e<=23?1:2;r=t>=64&&t<=95?1===a?vt[e]:yt[e]:1===a?mt[e]:bt[e];var n=this.channels[a];return!!n&&(n.setPAC(this.interpretPAC(r,t)),Lt(e,t,i),this.currentChannel=a,!0)},t.interpretPAC=function(e,t){var r,i={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,i.underline=1==(1&r),r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i},t.parseChars=function(e,t){var r,n,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19?(n=17===a?t+80:18===a?t+112:t+144,this.logger.log(ht.INFO,"Special char '"+gt(n)+"' in channel "+r),i=[n]):e>=32&&e<=127&&(i=0===t?[e]:[e,t]),i){var s=Et(i);this.logger.log(ht.DEBUG,"Char codes =  "+s.join(",")),Lt(e,t,this.cmdHistory)}return i},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;var i={};16===e||24===e?(r=Math.floor((t-32)/2),i.background=_t[r],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));var a=e<=23?1:2;return this.channels[a].setBkgData(i),Lt(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}(),xt=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[]},e}(),Pt=function(e,t,r){return e.substr(r||0,t.length)===t},Dt=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()},It=function(e,t,r,i,a,n){var s,o=Object(je.utf8ArrayToStr)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),u="00:00.000",l=0,d=0,f=0,h=[],g=!0,p=!1,v=new ut;v.oncue=function(e){var t=r[i],a=r.ccOffset;t&&t.new&&(void 0!==d?a=r.ccOffset=t.start:function(e,t,r){var i=e[t],a=e[i.prevCC];if(!a||!a.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;a&&a.new;)e.ccOffset+=i.start-a.start,i.new=!1,a=e[(i=a).prevCC];e.presentationOffset=r}(r,i,f)),f&&(a=f-r.presentationOffset),p&&(e.startTime+=a-d,e.endTime+=a-d),e.id=Dt(e.startTime.toString())+Dt(e.endTime.toString())+Dt(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&h.push(e)},v.onparsingerror=function(e){s=e},v.onflush=function(){s&&n?n(s):a(h)},o.forEach((function(e){if(g){if(Pt(e,"X-TIMESTAMP-MAP=")){g=!1,p=!0,e.substr(16).split(",").forEach((function(e){Pt(e,"LOCAL:")?u=e.substr(6):Pt(e,"MPEGTS:")&&(l=parseInt(e.substr(7)))}));try{t+(9e4*r[i].start||0)<0&&(t+=8589934592),l-=t,d=function(e){var t=parseInt(e.substr(-3)),r=parseInt(e.substr(-6,2)),i=parseInt(e.substr(-9,2)),a=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(c.isFiniteNumber)(t)&&Object(c.isFiniteNumber)(r)&&Object(c.isFiniteNumber)(i)&&Object(c.isFiniteNumber)(a)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,(t+=6e4*i)+36e5*a}(u)/1e3,f=l/9e4}catch(e){p=!1,s=e}return}""===e&&(g=!1)}v.parse(e+"\n")})),v.flush()};function jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mt(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var Ft=function(e){var t,r;function i(t){var r;if((r=e.call(this,t,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.FRAG_PARSING_USERDATA,u.default.FRAG_DECRYPTED,u.default.MANIFEST_LOADING,u.default.MANIFEST_LOADED,u.default.FRAG_LOADED,u.default.INIT_PTS_FOUND)||this).media=null,r.config=void 0,r.enabled=!0,r.Cues=void 0,r.textTracks=[],r.tracks=[],r.initPTS=[],r.unparsedVttFrags=[],r.captionsTracks={},r.nonNativeCaptionsTracks={},r.captionsProperties=void 0,r.cea608Parser1=void 0,r.cea608Parser2=void 0,r.lastSn=-1,r.prevCC=-1,r.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},r.hls=t,r.config=t.config,r.Cues=t.config.cueHandler,r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode},textTrack3:{label:r.config.captionsTextTrack3Label,languageCode:r.config.captionsTextTrack3LanguageCode},textTrack4:{label:r.config.captionsTextTrack4Label,languageCode:r.config.captionsTextTrack4LanguageCode}},r.config.enableCEA708Captions){var i=new xt(jt(r),"textTrack1"),a=new xt(jt(r),"textTrack2"),n=new xt(jt(r),"textTrack3"),s=new xt(jt(r),"textTrack4");r.cea608Parser1=new Rt(1,i,a),r.cea608Parser2=new Rt(3,n,s)}return r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.addCues=function(e,t,r,i,a){for(var n,s,o,c,l=!1,d=a.length;d--;){var f=a[d],h=(n=f[0],s=f[1],o=t,c=r,Math.min(s,c)-Math.max(n,o));if(h>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],r),l=!0,h/(r-t)>.5))return}if(l||a.push([t,r]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],t,r,i);else{var g=this.Cues.newCue(null,t,r,i);this.hls.trigger(u.default.CUES_PARSED,{type:"captions",cues:g,track:e})}},a.onInitPtsFound=function(e){var t=this,r=e.frag,i=e.id,a=e.initPTS,n=this.unparsedVttFrags;"main"===i&&(this.initPTS[r.cc]=a),n.length&&(this.unparsedVttFrags=[],n.forEach((function(e){t.onFragLoaded(e)})))},a.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var i=t.textTracks[r];if(i[e])return i}return null},a.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},a.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,i=this.media,a=t[e],n=a.label,s=a.languageCode,o=this.getExistingTrack(e);if(o)r[e]=o,Fe(r[e]),Me(r[e],i);else{var c=this.createTextTrack("captions",n,s);c&&(c[e]=!0,r[e]=c)}}},a.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(u.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},a.createTextTrack=function(e,t,r){var i=this.media;if(i)return i.addTextTrack(e,t,r)},a.destroy=function(){e.prototype.destroy.call(this)},a.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},a.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Fe(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},a.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},a._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)Fe(t[r])}},a.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var r=e.subtitles||[],i=this.tracks&&r&&this.tracks.length===r.length;if(this.tracks=e.subtitles||[],this.config.renderTextTracksNatively){var a=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,r){var i;if(r<a.length){for(var n=null,s=0;s<a.length;s++)if(Mt(a[s],e)){n=a[s];break}n&&(i=n)}i||(i=t.createTextTrack("subtitles",e.name,e.lang)),e.default?i.mode=t.hls.subtitleDisplay?"showing":"hidden":i.mode="disabled",t.textTracks.push(i)}))}else if(!i&&this.tracks&&this.tracks.length){var n=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(u.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:n})}}this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((function(e){var r=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(r){var i="textTrack"+r[1],a=t.captionsProperties[i];a&&(a.label=e.name,e.lang&&(a.languageCode=e.lang),a.media=e)}}))},a.onFragLoaded=function(e){var t=e.frag,r=e.payload,i=this.cea608Parser1,a=this.cea608Parser2,n=this.initPTS,s=this.lastSn,o=this.unparsedVttFrags;if("main"===t.type){var l=t.sn;t.sn!==s+1&&i&&a&&(i.reset(),a.reset()),this.lastSn=l}else if("subtitle"===t.type)if(r.byteLength){if(!Object(c.isFiniteNumber)(n[t.cc]))return o.push(e),void(n.length&&this.hls.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var d=t.decryptdata;null!=d&&null!=d.key&&"AES-128"===d.method||this._parseVTTs(t,r)}else this.hls.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},a._parseVTTs=function(e,t){var r=this,i=this.hls,a=this.prevCC,n=this.textTracks,s=this.vttCCs;s[e.cc]||(s[e.cc]={start:e.start,prevCC:a,new:!0},this.prevCC=e.cc),It(t,this.initPTS[e.cc],s,e.cc,(function(t){if(r.config.renderTextTracksNatively){var a=n[e.level];if("disabled"===a.mode)return void i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e});t.forEach((function(e){if(!a.cues.getCueById(e.id))try{if(a.addCue(e),!a.cues.getCueById(e.id))throw new Error("addCue is failed for: "+e)}catch(r){l.logger.debug("Failed occurred on adding cues: "+r);var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,a.addCue(t)}}))}else{var s=r.tracks[e.level].default?"default":"subtitles"+e.level;i.trigger(u.default.CUES_PARSED,{type:"subtitles",cues:t,track:s})}i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){l.logger.log("Failed to parse VTT cue: "+t),i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},a.onFragDecrypted=function(e){var t=e.frag,r=e.payload;if("subtitle"===t.type){if(!Object(c.isFiniteNumber)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,r)}},a.onFragParsingUserdata=function(e){var t=this.cea608Parser1,r=this.cea608Parser2;if(this.enabled&&t&&r)for(var i=0;i<e.samples.length;i++){var a=e.samples[i].bytes;if(a){var n=this.extractCea608Data(a);t.addData(e.samples[i].pts,n[0]),r.addData(e.samples[i].pts,n[1])}}},a.extractCea608Data=function(e){for(var t=31&e[0],r=2,i=[[],[]],a=0;a<t;a++){var n=e[r++],s=127&e[r++],o=127&e[r++],c=3&n;0===s&&0===o||0!=(4&n)&&(0!==c&&1!==c||(i[c].push(s),i[c].push(o)))}return i},i}(f);function Bt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ut(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];"subtitles"===i.kind&&i.label&&t.push(e[r])}return t}var Nt,Vt=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.MANIFEST_LOADED,u.default.SUBTITLE_TRACK_LOADED)||this).tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r.queuedDefaultTrack=null,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,n,o=i.prototype;return o.destroy=function(){f.prototype.destroy.call(this)},o.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(c.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},o.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(c.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),Ut(this.media.textTracks).forEach((function(e){Fe(e)})),this.subtitleTrack=-1,this.media=null)},o.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(u.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},o.onSubtitleTrackLoaded=function(e){var t=this,r=e.id,i=e.details,a=this.trackId,n=this.tracks,s=n[a];if(r>=n.length||r!==a||!s||this.stopped)this._clearReloadTimer();else if(l.logger.log("subtitle track "+r+" loaded"),i.live){var o=ne(s.details,i,e.stats.trequest);l.logger.log("Reloading live subtitle playlist in "+o+"ms"),this.timer=setTimeout((function(){t._loadCurrentTrack()}),o)}else this._clearReloadTimer()},o.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},o.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},o._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},o._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,r=this.hls,i=t[e];e<0||!i||i.details&&!i.details.live||(l.logger.log("Loading subtitle track "+e),r.trigger(u.default.SUBTITLE_TRACK_LOADING,{url:i.url,id:e}))},o._toggleTrackModes=function(e){var t=this.media,r=this.subtitleDisplay,i=this.trackId;if(t){var a=Ut(t.textTracks);if(-1===e)[].slice.call(a).forEach((function(e){e.mode="disabled"}));else{var n=a[i];n&&(n.mode="disabled")}var s=a[e];s&&(s.mode=r?"showing":"hidden")}},o._setSubtitleTrackInternal=function(e){var t=this.hls,r=this.tracks;!Object(c.isFiniteNumber)(e)||e<-1||e>=r.length||(this.trackId=e,l.logger.log("Switching to subtitle track "+e),t.trigger(u.default.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},o._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=Ut(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack=e}},a=i,(n=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&Bt(a.prototype,n),i}(f),Ht=r("./src/crypt/decrypter.js"),Gt=window.performance,Kt=function(e){var t,r;function i(t,r){var i;return(i=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.ERROR,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.SUBTITLE_TRACKS_UPDATED,u.default.SUBTITLE_TRACK_SWITCH,u.default.SUBTITLE_TRACK_LOADED,u.default.SUBTITLE_FRAG_PROCESSED,u.default.LEVEL_UPDATED)||this).fragmentTracker=r,i.config=t.config,i.state=ge,i.tracks=[],i.tracksBuffered=[],i.currentTrackId=-1,i.decrypter=new Ht.default(t,t.config),i.lastAVStart=0,i._onMediaSeeking=i.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=i.prototype;return a.startLoad=function(){this.stopLoad(),this.state=me;var e=this.tracks[this.currentTrackId];e&&e.details&&(this.setInterval(500),this.tick())},a.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=me,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var a,n=t.start,s=0;s<i.length;s++)if(n>=i[s].start&&n<=i[s].end){a=i[s];break}var o=t.start+t.duration;a?a.end=o:(a={start:n,end:o},i.push(a))}}},a.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=me},a.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]})),this.media=null,this.state=ge)},a.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=me)},a.onSubtitleTracksUpdated=function(e){var t=this;l.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]}))},a.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},a.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,i=this.currentTrackId,a=this.tracks,n=a[i];t>=a.length||t!==i||!n||(r.live&&function(e,t,r){void 0===r&&(r=0);var i=-1;ie(e,t,(function(e,t,r){t.start=e.start,i=r}));var a=t.fragments;if(i<0)a.forEach((function(e){e.start+=r}));else for(var n=i+1;n<a.length;n++)a[n].start=a[n-1].start+a[n-1].duration}(n.details,r,this.lastAVStart),n.details=r,this.setInterval(500))},a.onKeyLoaded=function(){this.state===ye&&(this.state=me)},a.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag.decryptdata,i=e.frag,a=this.hls;if(this.state===be&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var n=Gt.now();this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,(function(e){var t=Gt.now();a.trigger(u.default.FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:n,tdecrypt:t}})}))}},a.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},a.doTick=function(){if(this.media)switch(this.state){case me:var e=this.config,t=this.currentTrackId,r=this.fragmentTracker,i=this.media,a=this.tracks;if(!a||!a[t]||!a[t].details)break;var n,s=e.maxBufferHole,o=e.maxFragLookUpTolerance,c=Math.min(e.maxBufferLength,e.maxMaxBufferLength),d=G.bufferedInfo(this._getBuffered(),i.currentTime,s),f=d.end,h=d.len,g=a[t].details,p=g.fragments,v=p.length,m=p[v-1].start+p[v-1].duration;if(h>c)return;var y=this.fragPrevious;f<m?(y&&g.hasProgramDateTime&&(n=ce(p,y.endProgramDateTime,o)),n||(n=le(y,p,f,o))):n=p[v-1],n&&n.encrypted?(l.logger.log("Loading key for "+n.sn),this.state=ye,this.hls.trigger(u.default.KEY_LOADING,{frag:n})):n&&r.getState(n)===F&&(this.fragCurrent=n,this.state=be,this.hls.trigger(u.default.FRAG_LOADING,{frag:n}))}else this.state=me},a.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,e.prototype.stopLoad.call(this)},a._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},a.onMediaSeeking=function(){if(this.fragCurrent){var e=this.media?this.media.currentTime:0,t=this.config.maxFragLookUpTolerance,r=this.fragCurrent.start-t,i=this.fragCurrent.start+this.fragCurrent.duration+t;(e<r||e>i)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=me,this.tick())}},i}(Ae);!function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(Nt||(Nt={}));var $t="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function qt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Wt=function(e){var t,r;function i(t){var r;return(r=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHED,u.default.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,r._licenseXhrSetup=void 0,r._emeEnabled=void 0,r._requestMediaKeySystemAccess=void 0,r._drmSystemOptions=void 0,r._config=void 0,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._requestLicenseFailureCount=0,r.mediaKeysPromise=null,r._onMediaEncrypted=function(e){if(l.logger.log('Media is encrypted using "'+e.initDataType+'" init data type'),!r.mediaKeysPromise)return l.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void r.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var t=function(t){r._media&&(r._attemptSetMediaKeys(t),r._generateRequestWithPreferredKeySession(e.initDataType,e.initData))};r.mediaKeysPromise.then(t).catch(t)},r._config=t.config,r._widevineLicenseUrl=r._config.widevineLicenseUrl,r._licenseXhrSetup=r._config.licenseXhrSetup,r._emeEnabled=r._config.emeEnabled,r._requestMediaKeySystemAccess=r._config.requestMediaKeySystemAccessFunc,r._drmSystemOptions=t.config.drmSystemOptions,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a,n,c=i.prototype;return c.getLicenseServerUrl=function(e){switch(e){case Nt.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},c._attemptKeySystemAccess=function(e,t,r){var i=this,a=function(e,t,r,i){switch(e){case Nt.WIDEVINE:return function(e,t,r){var i={audioCapabilities:[],videoCapabilities:[]};return e.forEach((function(e){i.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:r.audioRobustness||""})})),t.forEach((function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:r.videoRobustness||""})})),[i]}(t,r,i);default:throw new Error("Unknown key-system: "+e)}}(e,t,r,this._drmSystemOptions);l.logger.log("Requesting encrypted media key-system access");var n=this.requestMediaKeySystemAccess(e,a);this.mediaKeysPromise=n.then((function(t){return i._onMediaKeySystemAccessObtained(e,t)})),n.catch((function(t){l.logger.error('Failed to obtain key-system "'+e+'" access:',t)}))},c._onMediaKeySystemAccessObtained=function(e,t){var r=this;l.logger.log('Access for key-system "'+e+'" obtained');var i={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(i);var a=Promise.resolve().then((function(){return t.createMediaKeys()})).then((function(t){return i.mediaKeys=t,l.logger.log('Media-keys created for key-system "'+e+'"'),r._onMediaKeysCreated(),t}));return a.catch((function(e){l.logger.error("Failed to create media-keys:",e)})),a},c._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},c._onNewMediaKeySession=function(e){var t=this;l.logger.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(r){t._onKeySessionMessage(e,r.message)}),!1)},c._onKeySessionMessage=function(e,t){l.logger.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){l.logger.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)}))},c._attemptSetMediaKeys=function(e){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return l.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});l.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},c._generateRequestWithPreferredKeySession=function(e,t){var r=this,i=this._mediaKeysList[0];if(!i)return l.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(i.mediaKeysSessionInitialized)l.logger.warn("Key-Session already initialized but requested again");else{var a=i.mediaKeysSession;if(!a)return l.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return l.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});l.logger.log('Generating key-session request for "'+e+'" init data type'),i.mediaKeysSessionInitialized=!0,a.generateRequest(e,t).then((function(){l.logger.debug("Key-session generation succeeded")})).catch((function(e){l.logger.error("Error generating key-session request:",e),r.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},c._createLicenseXhr=function(e,t,r){var i=new XMLHttpRequest,a=this._licenseXhrSetup;try{if(a)try{a(i,e)}catch(t){i.open("POST",e,!0),a(i,e)}i.readyState||i.open("POST",e,!0)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,e,t,r),i},c._onLicenseRequestReadyStageChange=function(e,t,r,i){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,l.logger.log("License request succeeded"),"arraybuffer"!==e.responseType&&l.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),i(e.response);else{if(l.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var a=3-this._requestLicenseFailureCount+1;l.logger.warn("Retrying license request, "+a+" attempts left"),this._requestLicense(r,i)}}},c._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case Nt.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},c._requestLicense=function(e,t){l.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return l.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var i=this.getLicenseServerUrl(r.mediaKeySystemDomain),a=this._createLicenseXhr(i,e,t);l.logger.log("Sending license request to URL: "+i);var n=this._generateLicenseRequestChallenge(r,e);a.send(n)}catch(e){l.logger.error("Failure requesting DRM license: "+e),this.hls.trigger(u.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},c.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;this._media=t,t.addEventListener("encrypted",this._onMediaEncrypted)}},c.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map((function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch((function(){}))}))).then((function(){return e.setMediaKeys(null)})).catch((function(){})))},c.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map((function(e){return e.audioCodec})),r=e.levels.map((function(e){return e.videoCodec}));this._attemptKeySystemAccess(Nt.WIDEVINE,t,r)}},a=i,(n=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&qt(a.prototype,n),i}(f);function zt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(r),!0).forEach((function(t){Xt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Xt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Zt=Yt(Yt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Xe,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Ge,bufferController:$e,capLevelController:We,fpsController:Ye,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:$t,testBandwidth:!0},{cueHandler:i,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Kt,subtitleTrackController:Vt,timelineController:Ft,audioStreamController:rt,audioTrackController:Je,emeController:Wt});function Jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(r),!0).forEach((function(t){tr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function er(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rr(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ir(e,t,r){return t&&rr(e.prototype,t),r&&rr(e,r),e}var nr=function(e){var t,r;function i(t){var r;void 0===t&&(t={}),(r=e.call(this)||this).config=void 0,r._autoLevelCapping=void 0,r.abrController=void 0,r.capLevelController=void 0,r.levelController=void 0,r.streamController=void 0,r.networkControllers=void 0,r.audioTrackController=void 0,r.subtitleTrackController=void 0,r.emeController=void 0,r.coreComponents=void 0,r.media=null,r.url=null;var a=i.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");r.config=Qt(Qt({},a),t);var n=er(r).config;if(void 0!==n.liveMaxLatencyDurationCount&&n.liveMaxLatencyDurationCount<=n.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==n.liveMaxLatencyDuration&&(void 0===n.liveSyncDuration||n.liveMaxLatencyDuration<=n.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(l.enableLogs)(n.debug),r._autoLevelCapping=-1;var s=r.abrController=new n.abrController(er(r)),o=new n.bufferController(er(r)),c=r.capLevelController=new n.capLevelController(er(r)),u=new n.fpsController(er(r)),d=new I(er(r)),f=new j(er(r)),h=new M(er(r)),g=new Be(er(r)),p=r.levelController=new Ie(er(r)),v=new V(er(r)),m=[p,r.streamController=new Pe(er(r),v)],y=n.audioStreamController;y&&m.push(new y(er(r),v)),r.networkControllers=m;var _=[d,f,h,s,o,c,u,g,v];if(y=n.audioTrackController){var w=new y(er(r));r.audioTrackController=w,_.push(w)}if(y=n.subtitleTrackController){var b=new y(er(r));r.subtitleTrackController=b,m.push(b)}if(y=n.emeController){var E=new y(er(r));r.emeController=E,_.push(E)}return(y=n.subtitleStreamController)&&m.push(new y(er(r),v)),(y=n.timelineController)&&_.push(new y(er(r))),r.coreComponents=_,r}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i.isSupported=function(){return function(){var e=q();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!i}()},ir(i,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return u.default}},{key:"ErrorTypes",get:function(){return o.ErrorTypes}},{key:"ErrorDetails",get:function(){return o.ErrorDetails}},{key:"DefaultConfig",get:function(){return i.defaultConfig?i.defaultConfig:Zt},set:function(e){i.defaultConfig=e}}]);var a=i.prototype;return a.destroy=function(){l.logger.log("destroy"),this.trigger(u.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},a.attachMedia=function(e){l.logger.log("attachMedia"),this.media=e,this.trigger(u.default.MEDIA_ATTACHING,{media:e})},a.detachMedia=function(){l.logger.log("detachMedia"),this.trigger(u.default.MEDIA_DETACHING),this.media=null},a.loadSource=function(e){e=s.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),l.logger.log("loadSource:"+e),this.url=e,this.trigger(u.default.MANIFEST_LOADING,{url:e})},a.startLoad=function(e){void 0===e&&(e=-1),l.logger.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},a.stopLoad=function(){l.logger.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},a.swapAudioCodec=function(){l.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},a.recoverMediaError=function(){l.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},a.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},ir(i,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){l.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){l.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){l.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){l.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){l.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){l.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,i=0;i<r;i++)if((e[i].realBitrate?Math.max(e[i].realBitrate,e[i].bitrate):e[i].bitrate)>t)return i;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),i}(Y);nr.defaultConfig=void 0},"./src/polyfills/number.js":function(e,t,r){"use strict";r.r(t),r.d(t,"isFiniteNumber",(function(){return i})),r.d(t,"MAX_SAFE_INTEGER",(function(){return a}));var i=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},a=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(e,t,r){"use strict";function i(){return"undefined"==typeof window?self:window}r.r(t),r.d(t,"getSelfScope",(function(){return i}))},"./src/utils/logger.js":function(e,t,r){"use strict";r.r(t),r.d(t,"enableLogs",(function(){return l})),r.d(t,"logger",(function(){return d}));var i=r("./src/utils/get-self-scope.js");function a(){}var n={trace:a,debug:a,log:a,warn:a,info:a,error:a},s=n;function o(e,t){return"["+e+"] > "+t}var c=Object(i.getSelfScope)();function u(e){var t=c.console[e];return t?function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];i[0]&&(i[0]=o(e,i[0])),t.apply(c.console,i)}:a}var l=function(e){if(c.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];r.forEach((function(t){s[t]=e[t]?e[t].bind(e):u(t)}))}(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=n}}else s=n},d=s}}).default},e.exports=i())},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={getBrowserVersion:function(){var e=navigator.userAgent;if(e.toLowerCase().indexOf("mobile")>-1)return"Unknown";if(e.indexOf("Firefox")>-1)return"Firefox "+e.match(/firefox\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Edge")>-1)return"Edge "+e.match(/edge\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("rv:11")>-1)return"IE 11";if(e.indexOf("Opera")>-1||e.indexOf("OPR")>-1){if(e.indexOf("Opera")>-1)return"Opera "+e.match(/opera\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("OPR")>-1)return"Opera "+e.match(/opr\/[\d.]+/gi)[0].match(/[\d]+/)[0]}else{if(e.indexOf("Chrome")>-1)return"Chrome "+e.match(/chrome\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Safari")>-1)return"Safari "+e.match(/safari\/[\d.]+/gi)[0].match(/[\d]+/)[0];if(!(e.indexOf("MSIE")>-1||e.indexOf("Trident")>-1))return"Unknown";if(e.indexOf("MSIE")>-1)return"IE "+e.match(/msie [\d.]+/gi)[0].match(/[\d]+/)[0];if(e.indexOf("Trident")>-1){var t=e.match(/trident\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"IE "+(parseInt(t)+4)}}},parseUrl:function(e){var t=e.split("?")[1],r={};return t&&t.split("&").forEach((function(e){e=e.split("="),r[e[0]]=decodeURIComponent(e[1])})),r},isBase64:function(e){return/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/.test(e)},isRelativeURL:function(e){return!/^(?:[a-z]+:)?\/\//.test(e)},getAbsoluteURL:function(e){var t=new Image;return t.src=e,t.src},checkMediaSourceSupport:function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource;return e&&"function"==typeof e.isTypeSupported},offInDestroy:function(e,t,r,i){e.once(i,(function a(){e.off(t,r),e.off(i,a)}))},on:function(e,t,r,a){a?(e.on(t,r),i.offInDestroy(e,t,r,a)):e.on(t,(function i(a){r(a),e.off(t,i)}))},once:function(e,t,r,a){a?(e.once(t,r),i.offInDestroy(e,t,r,a)):e.once(t,(function i(a){r(a),e.off(t,i)}))},isMobile:function(){var e=!1;return navigator.userAgent.toLocaleLowerCase().indexOf("ipad")>-1?(navigator.userAgent.toLocaleLowerCase().indexOf("mobile")>-1&&"MacIntel"!==navigator.platform&&"Win32"!==navigator.platform||!i.checkMediaSourceSupport())&&(e=!0):navigator.userAgent.toLocaleLowerCase().indexOf("mobile")>-1&&"MacIntel"!==navigator.platform&&"Win32"!==navigator.platform&&!i.checkMediaSourceSupport()&&(e=!0),e}};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,a=t.method,n=void 0===a?"GET":a,s=t.type,o=void 0===s?"arraybuffer":s,c=t.timeout,u=void 0===c?1e4:c,l=t.data,d=void 0===l?{}:l;return i(this,e),new Promise((function(e,t){var i=new window.XMLHttpRequest,a=n.toUpperCase(),s=[];for(var c in o&&(i.responseType=o),u&&(i.timeout=u),d)s.push("k="+d[c]);if(i.onload=function(){200===i.status||206===i.status?e(i):t(i)},i.onerror=function(){t(i)},i.ontimeout=function(){t(i)},i.onabort=function(){t(i)},"GET"===a)i.open(a,""+r),i.send();else{if("post"!==a)throw new Error("xhr "+a+" is not supported");i.open(a,r),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(s.join("&"))}}))},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeID=null,this.func=null}return i(e,[{key:"repeat",value:function(e,t){var r=this;null===this.func&&(this.func=e),this.func===e&&(this.timeID=setTimeout((function(){e(),r.repeat(e,t)}),t))}},{key:"clear",value:function(){clearTimeout(this.timeID)}}]),e}();t.default=a,e.exports=t.default},function(e,t){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){"use strict";var i=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(e,t,r){"use strict";var i=r(12)("wks"),a=r(13),n=r(0).Symbol,s="function"==typeof n;(e.exports=function(e){return i[e]||(i[e]=s&&n[e]||(s?n:a)("Symbol."+e))}).store=i},function(e,t,r){"use strict";var i=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=i)},function(e,t,r){"use strict";var i=r(4);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":i(e))?null!==e:"function"==typeof e}},function(e,t,r){"use strict";var i=r(6);e.exports=function(e,t,r){if(i(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,i){return e.call(t,r,i)};case 3:return function(r,i,a){return e.call(t,r,i,a)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){"use strict";e.exports=!r(15)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,r){"use strict";var i={}.toString;e.exports=function(e){return i.call(e).slice(8,-1)}},function(e,t,r){"use strict";var i=r(3),a=r(26),n=r(27),s=Object.defineProperty;t.f=r(7)?Object.defineProperty:function(e,t,r){if(i(e),t=n(t,!0),i(r),a)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";e.exports=!1},function(e,t,r){"use strict";var i=r(8),a=r(1)("toStringTag"),n="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?r:n?i(t):"Object"==(s=i(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,r){"use strict";var i=r(2),a=r(0),n=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:r(10)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){"use strict";var i=0,a=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+a).toString(36))}},function(e,t,r){"use strict";var i=r(9),a=r(28);e.exports=r(7)?function(e,t,r){return i.f(e,t,a(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";var i=r(4),a=r(0).document,n=i(a)&&i(a.createElement);e.exports=function(e){return n?a.createElement(e):{}}},function(e,t,r){"use strict";var i=r(0),a=r(14),n=r(18),s=r(13)("src"),o=r(29),c=(""+o).split("toString");r(2).inspectSource=function(e){return o.call(e)},(e.exports=function(e,t,r,o){var u="function"==typeof r;u&&(n(r,"name")||a(r,"name",t)),e[t]!==r&&(u&&(n(r,s)||a(r,s,e[t]?""+e[t]:c.join(String(t)))),e===i?e[t]=r:o?e[t]?e[t]=r:a(e,t,r):(delete e[t],a(e,t,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[s]||o.call(this)}))},function(e,t,r){"use strict";var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";var i,a,n,s=r(5),o=r(38),c=r(39),u=r(16),l=r(0),d=l.process,f=l.setImmediate,h=l.clearImmediate,g=l.MessageChannel,p=l.Dispatch,v=0,m={},y=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},_=function(e){y.call(e.data)};f&&h||(f=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return m[++v]=function(){o("function"==typeof e?e:Function(e),t)},i(v),v},h=function(e){delete m[e]},"process"==r(8)(d)?i=function(e){d.nextTick(s(y,e,1))}:p&&p.now?i=function(e){p.now(s(y,e,1))}:g?(n=(a=new g).port2,a.port1.onmessage=_,i=s(n.postMessage,n,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(i=function(e){l.postMessage(e+"","*")},l.addEventListener("message",_,!1)):i="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),y.call(e)}}:function(e){setTimeout(s(y,e,1),0)}),e.exports={set:f,clear:h}},function(e,t,r){"use strict";var i=r(6);function a(e){var t,r;this.promise=new e((function(e,i){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=i})),this.resolve=i(t),this.reject=i(r)}e.exports.f=function(e){return new a(e)}},function(e,t,r){e.exports=r(23)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(24);var i,a=(i=r(48))&&i.__esModule?i:{default:i};t.default={url:a.default},e.exports=t.default},function(e,t,r){"use strict";var i,a,n,s,o=r(10),c=r(0),u=r(5),l=r(11),d=r(25),f=r(4),h=r(6),g=r(30),p=r(31),v=r(37),m=r(20).set,y=r(40)(),_=r(21),w=r(41),b=r(42),E=r(43),T=c.TypeError,S=c.process,O=S&&S.versions,C=O&&O.v8||"",k=c.Promise,L="process"==l(S),A=function(){},R=a=_.f,x=!!function(){try{var e=k.resolve(1),t=(e.constructor={})[r(1)("species")]=function(e){e(A,A)};return(L||"function"==typeof PromiseRejectionEvent)&&e.then(A)instanceof t&&0!==C.indexOf("6.6")&&-1===b.indexOf("Chrome/66")}catch(e){}}(),P=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},D=function(e,t){if(!e._n){e._n=!0;var r=e._c;y((function(){for(var i=e._v,a=1==e._s,n=0,s=function(t){var r,n,s,o=a?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{o?(a||(2==e._h&&M(e),e._h=1),!0===o?r=i:(l&&l.enter(),r=o(i),l&&(l.exit(),s=!0)),r===t.promise?u(T("Promise-chain cycle")):(n=P(r))?n.call(r,c,u):c(r)):u(i)}catch(e){l&&!s&&l.exit(),u(e)}};r.length>n;)s(r[n++]);e._c=[],e._n=!1,t&&!e._h&&I(e)}))}},I=function(e){m.call(c,(function(){var t,r,i,a=e._v,n=j(e);if(n&&(t=w((function(){L?S.emit("unhandledRejection",a,e):(r=c.onunhandledrejection)?r({promise:e,reason:a}):(i=c.console)&&i.error&&i.error("Unhandled promise rejection",a)})),e._h=L||j(e)?2:1),e._a=void 0,n&&t.e)throw t.v}))},j=function(e){return 1!==e._h&&0===(e._a||e._c).length},M=function(e){m.call(c,(function(){var t;L?S.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),D(t,!0))},B=function e(t){var r,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw T("Promise can't be resolved itself");(r=P(t))?y((function(){var a={_w:i,_d:!1};try{r.call(t,u(e,a,1),u(F,a,1))}catch(e){F.call(a,e)}})):(i._v=t,i._s=1,D(i,!1))}catch(e){F.call({_w:i,_d:!1},e)}}};x||(k=function(e){g(this,k,"Promise","_h"),h(e),i.call(this);try{e(u(B,this,1),u(F,this,1))}catch(e){F.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(44)(k.prototype,{then:function(e,t){var r=R(v(this,k));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=L?S.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&D(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),n=function(){var e=new i;this.promise=e,this.resolve=u(B,e,1),this.reject=u(F,e,1)},_.f=R=function(e){return e===k||e===s?new n(e):a(e)}),d(d.G+d.W+d.F*!x,{Promise:k}),r(45)(k,"Promise"),r(46)("Promise"),s=r(2).Promise,d(d.S+d.F*!x,"Promise",{reject:function(e){var t=R(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(o||!x),"Promise",{resolve:function(e){return E(o&&this===s?k:this,e)}}),d(d.S+d.F*!(x&&r(47)((function(e){k.all(e).catch(A)}))),"Promise",{all:function(e){var t=this,r=R(t),i=r.resolve,a=r.reject,n=w((function(){var r=[],n=0,s=1;p(e,!1,(function(e){var o=n++,c=!1;r.push(void 0),s++,t.resolve(e).then((function(e){c||(c=!0,r[o]=e,--s||i(r))}),a)})),--s||i(r)}));return n.e&&a(n.v),r.promise},race:function(e){var t=this,r=R(t),i=r.reject,a=w((function(){p(e,!1,(function(e){t.resolve(e).then(r.resolve,i)}))}));return a.e&&i(a.v),r.promise}})},function(e,t,r){"use strict";var i=r(0),a=r(2),n=r(14),s=r(17),o=r(5),c=function e(t,r,c){var u,l,d,f,h=t&e.F,g=t&e.G,p=t&e.P,v=t&e.B,m=g?i:t&e.S?i[r]||(i[r]={}):(i[r]||{}).prototype,y=g?a:a[r]||(a[r]={}),_=y.prototype||(y.prototype={});for(u in g&&(c=r),c)d=((l=!h&&m&&void 0!==m[u])?m:c)[u],f=v&&l?o(d,i):p&&"function"==typeof d?o(Function.call,d):d,m&&s(m,u,d,t&e.U),y[u]!=d&&n(y,u,f),p&&_[u]!=d&&(_[u]=d)};i.core=a,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,r){"use strict";e.exports=!r(7)&&!r(15)((function(){return 7!=Object.defineProperty(r(16)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){"use strict";var i=r(4);e.exports=function(e,t){if(!i(e))return e;var r,a;if(t&&"function"==typeof(r=e.toString)&&!i(a=r.call(e)))return a;if("function"==typeof(r=e.valueOf)&&!i(a=r.call(e)))return a;if(!t&&"function"==typeof(r=e.toString)&&!i(a=r.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";e.exports=r(12)("native-function-to-string",Function.toString)},function(e,t,r){"use strict";e.exports=function(e,t,r,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){"use strict";var i=r(5),a=r(32),n=r(33),s=r(3),o=r(34),c=r(36),u={},l={},d=e.exports=function(e,t,r,d,f){var h,g,p,v,m=f?function(){return e}:c(e),y=i(r,d,t?2:1),_=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(n(m)){for(h=o(e.length);h>_;_++)if((v=t?y(s(g=e[_])[0],g[1]):y(e[_]))===u||v===l)return v}else for(p=m.call(e);!(g=p.next()).done;)if((v=a(p,y,g.value,t))===u||v===l)return v};d.BREAK=u,d.RETURN=l},function(e,t,r){"use strict";var i=r(3);e.exports=function(e,t,r,a){try{return a?t(i(r)[0],r[1]):t(r)}catch(t){var n=e.return;throw void 0!==n&&i(n.call(e)),t}}},function(e,t,r){"use strict";var i=r(19),a=r(1)("iterator"),n=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||n[a]===e)}},function(e,t,r){"use strict";var i=r(35),a=Math.min;e.exports=function(e){return e>0?a(i(e),9007199254740991):0}},function(e,t,r){"use strict";var i=Math.ceil,a=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?a:i)(e)}},function(e,t,r){"use strict";var i=r(11),a=r(1)("iterator"),n=r(19);e.exports=r(2).getIteratorMethod=function(e){if(null!=e)return e[a]||e["@@iterator"]||n[i(e)]}},function(e,t,r){"use strict";var i=r(3),a=r(6),n=r(1)("species");e.exports=function(e,t){var r,s=i(e).constructor;return void 0===s||null==(r=i(s)[n])?t:a(r)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=void 0===r;switch(t.length){case 0:return i?e():e.call(r);case 1:return i?e(t[0]):e.call(r,t[0]);case 2:return i?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){"use strict";var i=r(0).document;e.exports=i&&i.documentElement},function(e,t,r){"use strict";var i=r(0),a=r(20).set,n=i.MutationObserver||i.WebKitMutationObserver,s=i.process,o=i.Promise,c="process"==r(8)(s);e.exports=function(){var e,t,r,u=function(){var i,a;for(c&&(i=s.domain)&&i.exit();e;){a=e.fn,e=e.next;try{a()}catch(i){throw e?r():t=void 0,i}}t=void 0,i&&i.enter()};if(c)r=function(){s.nextTick(u)};else if(!n||i.navigator&&i.navigator.standalone)if(o&&o.resolve){var l=o.resolve(void 0);r=function(){l.then(u)}}else r=function(){a.call(i,u)};else{var d=!0,f=document.createTextNode("");new n(u).observe(f,{characterData:!0}),r=function(){f.data=d=!d}}return function(i){var a={fn:i,next:void 0};t&&(t.next=a),e||(e=a,r()),t=a}}},function(e,t,r){"use strict";e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){"use strict";var i=r(0).navigator;e.exports=i&&i.userAgent||""},function(e,t,r){"use strict";var i=r(3),a=r(4),n=r(21);e.exports=function(e,t){if(i(e),a(t)&&t.constructor===e)return t;var r=n.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){"use strict";var i=r(17);e.exports=function(e,t,r){for(var a in t)i(e,a,t[a],r);return e}},function(e,t,r){"use strict";var i=r(9).f,a=r(18),n=r(1)("toStringTag");e.exports=function(e,t,r){e&&!a(e=r?e:e.prototype,n)&&i(e,n,{configurable:!0,value:t})}},function(e,t,r){"use strict";var i=r(0),a=r(9),n=r(7),s=r(1)("species");e.exports=function(e){var t=i[e];n&&t&&!t[s]&&a.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){"use strict";var i=r(1)("iterator"),a=!1;try{var n=[7][i]();n.return=function(){a=!0},Array.from(n,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var r=!1;try{var n=[7],s=n[i]();s.next=function(){return{done:r=!0}},n[i]=function(){return s},e(n)}catch(e){}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e){try{e=JSON.parse(i.default.base64decode(e))}catch(e){return Promise.reject("base64 decode error")}var n=[];for(var s in r)n.push(s+"="+r[s]);var o="//"+t+"?"+e.GetPlayInfoToken+"&ssl=true";return n.length>0&&(o+="&"+n.join("&")),new a.default({type:"json",method:"GET",url:o}).then((function(e){return e.response&&e.response.Result?e.response.Result:e.response||e}))}return Promise.reject("vid, host and token can't be empty")};var i=n(r(49)),a=n(r(50));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={base64decode:function(e){var t,r,i,a,n,s,o,c=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];for(s=e.length,n=0,o="";n<s;){do{t=c[255&e.charCodeAt(n++)]}while(n<s&&-1===t);if(-1===t)break;do{r=c[255&e.charCodeAt(n++)]}while(n<s&&-1===r);if(-1===r)break;o+=String.fromCharCode(t<<2|(48&r)>>4);do{if(61==(i=255&e.charCodeAt(n++)))return o;i=c[i]}while(n<s&&-1===i);if(-1===i)break;o+=String.fromCharCode((15&r)<<4|(60&i)>>2);do{if(61==(a=255&e.charCodeAt(n++)))return o;a=c[a]}while(n<s&&-1===a);if(-1===a)break;o+=String.fromCharCode((3&i)<<6|a)}return o}};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,a=t.method,n=void 0===a?"GET":a,s=t.type,o=void 0===s?"arraybuffer":s,c=t.data,u=void 0===c?{}:c,l=t.headers,d=void 0===l?{}:l;return i(this,e),new Promise((function(e,t){var i=new window.XMLHttpRequest,a=n.toUpperCase(),s=[];for(var c in u)s.push(c+"="+u[c]);if("GET"!==a)throw new Error("xhr "+a+" is not supported");for(var l in i.open(a,""+r),o&&(i.responseType=o),d)i.setRequestHeader(l,""+d[l]);i.send(),i.onload=function(){200===i.status||206===i.status?e(i):t(i)},i.onerror=function(){t(i)}}))},e.exports=t.default}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_TIMESTAMP=5e9,t.MIN_EXPIRE_INTERVAL=300}]))},1361:function(e,t,r){"use strict";r(1211)},1362:function(e,t,r){},1363:function(e,t,r){},1495:function(e,t,r){"use strict";r(16),r(15),r(11),r(6),r(14);var n=r(0),o=(r(23),r(5)),c=r(7),l=(r(44),r(83),r(32)),d=(r(45),r(218),r(1097)),f=r.n(d),h=r(27),v=r(1),m=r(1346),y=r.n(m),_=h.c,w=_?"//vod.bytedanceapi.com":"//staging-openapi-boe.byted.org";function E(e){return T.apply(this,arguments)}function T(){return(T=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:"dash",e.prev=1,e.next=4,Object(v.e)({url:"/user_api/v1/video/play_token",query:{vid:t,format_type:r}});case 4:return n=e.sent,e.abrupt("return",n.data);case 8:throw e.prev=8,e.t0=e.catch(1),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function S(){return O.apply(this,arguments)}function O(){return(O=Object(o.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.e)({url:"/user_api/v1/video/key_token"});case 2:return t=e.sent,e.abrupt("return",t.data||"");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){return k.apply(this,arguments)}function k(){return(k=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t,r);case 2:if(n=e.sent,"hls"!==r){e.next=11;break}return e.next=6,S();case 6:return o=e.sent,c=_?"https://kds.bytedance.com":"https://b-kds.bytedance.com",e.abrupt("return",{EncryptHlsPlugin:{playDomain:w,keyDomain:c,playAuthToken:n,keyToken:o}});case 11:return e.next=13,y.a.url(n,w);case 13:if(!(l=e.sent).Error){e.next=16;break}throw new Error("视频地址获取失败");case 16:return e.abrupt("return",{dashOpts:l});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}r(1347),r(1348),r(21),r(22),r(56);var L=r(12),A=r(13),R=r(29),x=r(31),P=r(18);r(1349);function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(P.a)(e);if(t){var o=Object(P.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(x.a)(this,r)}}var I=d.Plugin.POSITIONS,j=function(e){Object(R.a)(r,e);var t=D(r);function r(e){var n;return Object(L.a)(this,r),(n=t.call(this,e)).handleRateChange=function(){n.playbackrateText?(n.playbackrateText.innerText="".concat(n.player.playbackRate,"倍"),n.root.classList.add("active"),n.timer&&clearTimeout(n.timer),n.timer=window.setTimeout((function(){n.timer=void 0,n.root.classList.remove("active")}),3e3)):console.warn("span element does not exist")},n}return Object(A.a)(r,[{key:"afterCreate",value:function(){this.playbackrateText=this.find("span.playbackrate-text"),this.on(d.Events.RATE_CHANGE,this.handleRateChange)}},{key:"render",value:function(){return'<div class="xgplayer-playbackrate-toast">正在用 <span class="playbackrate-text">1倍</span> 速率播放</div>'}},{key:"destroy",value:function(){this.off(d.Events.RATE_CHANGE,this.handleRateChange)}}],[{key:"pluginName",get:function(){return"DefinitionToast"}},{key:"defaultConfig",get:function(){return{position:I.ROOT}}}]),r}(d.Plugin),M=r(1350),F=r.n(M),B=r(1351),U=r.n(B),N=r(1352),V=r.n(N),H=r(1353),G=r.n(H),K=r(1354),$=r.n(K),W=r(1355),z=r.n(W),Y=r(1356),X=r.n(Y),Z=r(1357),J=r.n(Z),Q=r(1358),ee=r.n(Q),te=r(1359),re=r.n(te),ie=r(1360),ne=r.n(ie),oe=[480,720,1080],ae={space:{code:32,action:"playPause",disable:!1},up:{code:38,action:"upVolume",disable:!1},down:{code:40,action:"downVolume",disable:!1},left:{code:37,action:"customSeekBack",disable:!1},right:{code:39,action:"customSeek",disable:!1},esc:{code:27,action:"exitFullscreen",disable:!1}},se={autoplay:!1,cssFullscreen:!1,playbackRate:[.75,1,1.25,1.5,2],defaultDefinition:"720p",icons:{play:G.a,pause:V.a,fullscreen:U.a,exitFullscreen:F.a,startPlay:X.a,startPause:z.a,replay:$.a,volumeSmall:re.a,volumeLarge:re.a,volumeMuted:J.a,playNext:ee.a},definitionText:{"480p":"标清 480P","720p":"高清 720P","1080p":"超清 1080P"}};function ce(e,t){return le.apply(this,arguments)}function le(){return(le=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,l,d,h,v,m,y,_,w,E,T,S,O,k,L,A,R,x=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x.length>2&&void 0!==x[2]&&x[2],o=x.length>3&&void 0!==x[3]?x[3]:"hls",y=[],_=void 0,w=[j],e.next=7,C(t,o);case 7:if(E=e.sent,y=(null===(l=null===(c=E.dashOpts)||void 0===c?void 0:c.Data)||void 0===l?void 0:l.PlayInfoList)||[],T=null===(d=y[y.length-1])||void 0===d?void 0:d.MainPlayUrl,S=(null===(v=null===(h=E.dashOpts)||void 0===h?void 0:h.Data)||void 0===v?void 0:v.CoverUrl)||"","hls"!==o){e.next=19;break}if(null===(m=null===ne.a||void 0===ne.a?void 0:ne.a.isSupported)||void 0===m?void 0:m.call(ne.a)){e.next=17;break}throw O="不支持的浏览器 ".concat(navigator.userAgent),(k=new Error(O)).code=-1,k;case 17:w.push(ne.a),_=E.EncryptHlsPlugin;case 19:return L=Object.assign(se,{url:T,volume:n?1:.5,poster:S,plugins:w,EncryptHlsPlugin:_},r),ue(A=new f.a(L)),"hls"===o&&(R=y.filter((function(e){return oe.includes(e.Height)})).map((function(e){return{name:e.Definition,url:e.MainPlayUrl}})),A.emit("resourceReady",R)),e.abrupt("return",A);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){e.on("ABR_AUTO_DESC_CHANGE",(function(t,r,n){!function(e,t,r,n){if(!e)return;var o=e.root.querySelector(".xgplayer-definition [url='__auto__']");o&&(o.innerHTML=t+"".concat(r?"(".concat(r,")"):"")+"".concat(n||""))}(e,t,r,n)})),e.on(d.Events.DEFINITION_CHANGE,(function(t){var r=t.to.showText;!function(e,t){if("自动"===t)return;var r=e.root.querySelector(".xg-options-icon.xgplayer-definition.show .icon-text"),n=t.split(" "),text=Object(l.a)(n,2)[1];r&&text&&(r.innerHTML=text)}(e,void 0===r?"":r),fe(e.getPlugin("definition"))})),e.on(d.Events.RATE_CHANGE,(function(){de(e),fe(e.getPlugin("playbackrate"))})),e.on(d.Events.PLAYING,(function(){de(e)})),e.on(d.Events.SHORTCUT,(function(data){e.fullscreen&&("customSeek"===data.action?e.seek(e.currentTime+10):"customSeekBack"===data.action&&e.seek(e.currentTime-10))}))}function de(e){if(e){var t=e.playbackRate,r=e.controls.right.querySelector(".xg-options-icon.xgplayer-playbackrate.show .icon-text");1===t&&(r.innerHTML="倍速")}}function fe(e){var t,r=e.find(".xg-options-list");null===(t=null==r?void 0:r.classList)||void 0===t||t.replace("active","hide"),e.isActive=!1}function he(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function pe(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?he(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):he(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var ge=Object(c.b)({props:{vid:{type:String,default:""},videoType:{type:String,default:"hls"},videoConfig:{type:Object,default:function(){return{}}},videoLoading:{type:Boolean,default:!1}},emits:["handleEvent"],setup:function(e,t){var r=t.emit,n=function(){var e=Object(c.m)(!0),t=Object(c.m)("uninitialize"),r=Object(c.m)(),n=Object(c.c)(),l=null==n?void 0:n.proxy.$device.isMobile,d=Object(c.m)(),f=Object(c.a)((function(){var e;return"".concat((null===(e=d.value)||void 0===e?void 0:e.offsetWidth)/16*9)})),h=Object(c.m)("");return{initVideoPlay:function(){var c=Object(o.a)(regeneratorRuntime.mark((function o(c,d,v){var m;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if("initializing"!==t.value||c!==h.value){o.next=2;break}return o.abrupt("return");case 2:return h.value=c,t.value="initializing",o.prev=4,o.next=7,ce(c,pe({id:"mse",width:"100%",height:"".concat(f.value,"px"),keyboard:l?void 0:{keyCodeMap:ae}},v),l,d);case 7:if(m=o.sent){o.next=13;break}return t.value="uninitialize",o.abrupt("return");case 13:t.value="initialized";case 14:r.value=m,o.next=22;break;case 17:o.prev=17,o.t0=o.catch(4),-1===(null===o.t0||void 0===o.t0?void 0:o.t0.code)&&(e.value=!1),console.warn("video player init err:",o.t0),null==n||n.proxy.$error("视频加载失败");case 22:case"end":return o.stop()}}),o,null,[[4,17]])})));return function(e,t,r){return c.apply(this,arguments)}}(),mseRef:d,isVideoSupported:e,playerInstance:r,playerState:t}}(),l=n.initVideoPlay,d=n.mseRef,f=n.isVideoSupported,h=n.playerInstance,v=n.playerState;return Object(c.w)([function(){return e.vid},d,function(){return e.videoLoading}],Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.vid&&d.value&&!e.videoLoading){t.next=2;break}return t.abrupt("return");case 2:return h.value&&(h.value.destroy(),h.value=null),t.next=5,l(e.vid,e.videoType,e.videoConfig);case 5:r("handleEvent",h.value);case 6:case"end":return t.stop()}}),t)}))),{immediate:!0}),{mseRef:d,isVideoSupported:f,playerState:v}}}),ve=(r(1361),r(30)),component=Object(ve.a)(ge,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"video"},[r("div",{ref:"mseRef",attrs:{id:"mse"}},[e.isVideoSupported?e._e():r("div",{staticClass:"not-supported"},[r("span",[e._v("视频播放器暂不支持您的浏览器，")]),e._v(" "),r("span",[e._v("请在掘金 App 或者 PC 端观看视频")])]),e._v(" "),"initialized"===e.playerState?e._t("content"):e._e()],2)])}),[],!1,null,"1a72956a",null);t.a=component.exports},1593:function(e,t,r){"use strict";r(1334)},1594:function(e,t,r){"use strict";r(1335)},1638:function(e,t,r){"use strict";r(1362)},1639:function(e,t,r){"use strict";r(1363)},1641:function(e,t,r){"use strict";var n,o=r(12),c=r(13);r(11),r(6),r(52),r(292);function l(e){if(e<0||!e)return"0秒";if(0<=e&&e<60)return e+"秒";var t=Math.floor(e/60),s=Math.floor(e%60);return s>0?t+"分"+s+"秒":t+"分"}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,o=new Map,c=[];return e.forEach((function(e){var d,f,h,v="";e.sectionId===(null===(d=t.reading_progress)||void 0===d?void 0:d.last_section_id)&&(v="上次学到"),(null===(f=e.reading_progress)||void 0===f?void 0:f.reading_progress)>=100&&(v="已学完"),2===(null===(h=e.reading_progress)||void 0===h?void 0:h.has_update)&&(v="有更新");var m="";m=t.price>0?e.isFree?"试学章节":"付费章节":"免费章节",c.push(e.sectionId),o.set(e.sectionId,{sectionId:e.sectionId,title:e.title||"小册章节标题",readCount:e.readCount,commentCount:e.commentCount,readDurationStr:l(e.readDuration),status:v,isFinished:e.isFinished,freeStatus:m,canEdit:r===n.author,vid:e.vid,hasVideo:!!e.vid})})),{sectionMap:o,sectionOrder:c}}function f(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o&&o.id?(null===(e=o.roles)||void 0===e?void 0:e.isAdmin)?n.admin:o.id===(null===(t=r.user)||void 0===t?void 0:t.user_id)?n.author:r.is_buy?n.buyer:n.common:n.unlogin}!function(e){e.unlogin="unlogin",e.admin="admin",e.author="author",e.buyer="buyer",e.common="common"}(n||(n={}));var h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(o.a)(this,e),this.bookId="",this.userRole=n.common,this.sectionMap=new Map,this.sectionOrder=[],this.bookId=r.booklet_id,this.userRole=f(r,c);var l=d(t,r,this.userRole);this.sectionMap=l.sectionMap,this.sectionOrder=l.sectionOrder}return Object(c.a)(e,[{key:"getSectionList",value:function(){var e=this,t=[];return this.sectionOrder.forEach((function(r){var n;t.push((n=e.sectionMap.get(r),JSON.parse(JSON.stringify(n))))})),t}},{key:"setSectionFree",value:function(){}}]),e}();t.a=h},1642:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"16",height:"20",viewBox:"0 0 16 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.5822 5.29608C12.5184 2.81844 10.4914 0.833008 8.00036 0.833008C5.46911 0.833008 3.41703 2.88301 3.41703 5.41634V6.66634C1.80591 6.66761 0.500583 7.97418 0.500855 9.5853L0.501795 15.167C0.502167 17.3759 2.29292 19.1663 4.50179 19.1663H11.5004C13.7095 19.1663 15.5004 17.3755 15.5004 15.1663V9.58301C15.5004 7.97218 14.1945 6.66634 12.5837 6.66634V5.41634L12.5822 5.29608ZM8.00006 11.0002C9.10472 11.0002 10.0001 11.8968 10.0001 13.0002C10.0001 14.1035 9.10472 15.0002 8.00006 15.0002C6.89539 15.0002 6.00006 14.1035 6.00006 13.0002C6.00006 11.8968 6.89539 11.0002 8.00006 11.0002ZM5.08581 5.3163C5.13867 3.75039 6.42352 2.5 8.00079 2.5C9.61162 2.5 10.9175 3.80417 10.9175 5.41667V6.66667H5.08412V5.41667L5.08581 5.3163Z",fill:"#C2C8D1"}})]))}}},1814:function(e,t,r){"use strict";r(16),r(15),r(11),r(6),r(14);var n=r(0),o=r(4),c=r(84),l=(r(39),r(858)),d=r(1045),f=r(1194),h=r(219),v={props:["bookInfo","salePrice"],components:{Thumb:l.a,VideoLabel:d.a,VipBorrowButton:f.a},computed:{isVideoCourse:function(){var e,t;return(null===(t=null===(e=this.bookInfo)||void 0===e?void 0:e.base_info)||void 0===t?void 0:t.course_type)===h.a.video},isWapSection:function(){return"bookWapSection"===this.$route.name}},methods:{buy:function(){this.$emit("buy")}}},m=(r(1593),r(30)),y=Object(m.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"buying-guide-wrap"},[r("div",{staticClass:"buying-guide",class:{"buying-guide--m":e.isWapSection}},[r("div",{staticClass:"buying-inner"},[r("div",{staticClass:"poster"},[e.bookInfo.img?r("thumb",{staticClass:"thumb",attrs:{url:e.bookInfo.img,width:450,height:630}}):e._e(),e._v(" "),e.isVideoCourse?r("VideoLabel"):e._e()],1),e._v(" "),r("div",{staticClass:"title"},[e._v("此章节为付费章节")]),e._v(" "),r("div",{staticClass:"desc"},[e._v("现在购买立即解锁全部内容")]),e._v(" "),r("div",{staticClass:"button-container"},[r("button",{staticClass:"button-buy",on:{click:e.buy}},[e._v("\n          ￥"+e._s(e.salePrice)+" 立即购买\n        ")]),e._v(" "),r("VipBorrowButton",{attrs:{"book-info":e.bookInfo,"event-page":"lock"}})],1)])])])}),[],!1,null,"1f46323b",null).exports,_={props:["bookInfo"],components:{Thumb:l.a,VideoLabel:d.a},computed:{isVideoCourse:function(){var e,t;return(null===(t=null===(e=this.bookInfo)||void 0===e?void 0:e.base_info)||void 0===t?void 0:t.course_type)===h.a.video},isWapSection:function(){return"bookWapSection"===this.$route.name}}},w=(r(1594),Object(m.a)(_,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"section-writing-wrap"},[r("div",{staticClass:"section-writing",class:{"section-writing--m":e.isWapSection}},[r("div",{staticClass:"writing-inner"},[r("div",{staticClass:"poster"},[e.bookInfo.img?r("thumb",{staticClass:"thumb",attrs:{url:e.bookInfo.img,width:450,height:630}}):e._e(),e._v(" "),e.isVideoCourse?r("VideoLabel"):e._e()],1),e._v(" "),r("div",{staticClass:"title"},[e._v("此章节正在写作中")])])])])}),[],!1,null,"636ca600",null).exports),E=(r(45),r(135),r(23),r(5)),T=(r(83),r(936)),S=r(48),O=r(104),C=r(1005),content=r(872),k=r(7),L=r(1097),A=r(1495),R=r(1098);function x(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function P(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?x(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):x(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var D=Object(k.b)({components:{CommentListBox:T.a,MarkdownViewer:C.default,VipBorrowButton:f.a,Video:A.a},props:["bookInfo","sectionInfo","free","salePrice"],setup:function(e,t){var r=t.root,n=Object(k.t)();return Object(R.d)(n.value.params.sectionId),P({},function(e,t){var r={miniscreen:Object(k.a)((function(){return t.$device.isMobile}))?null:{width:320,height:180,isShowIcon:!0,isScrollSwitch:!0}};return{isLegacyBookletVid:Object(k.a)((function(){var t;return"6844733803647205384"===(null===(t=e.bookInfo)||void 0===t?void 0:t.id)})),handleVideoEvent:function(e){console.log("%c 🌭 player","color:#f5ce50",e);var r=t.$getBean("eventBus");e.on(L.Events.FULLSCREEN_CHANGE,(function(e){r.emit(r.eventType.VIDEO_FULLSCREEN_CHANGE,e)}))},videoConfig:r}}(e,r))},data:function(){return{htmlContent:"",canFetch:!0,isVideoSupported:!0,commentList:[],query:{entryId:"",startTime:"",pageSize:20},readingPostion:0,videoWrapperHeight:0,mobilePlayerStyle:{}}},computed:P({subject:function(){return{item_id:this.section.section_id,item_type:13,user_id:this.section.user_id,comment_count:this.section.comment_count}},curSectionId:function(){return this.$route.params.sectionId},isLastSectionId:function(){var e,t,r=(null===(t=null===(e=this.bookInfo.base_info)||void 0===e?void 0:e.section_ids)||void 0===t?void 0:t.split("|"))||[];return(r.length>0?r[r.length-1]:0)===this.curSectionId},isMobileBrowser:function(){return this.$device.isMobile},section:function(){return Object.assign({},this.sectionInfo,{user:this.bookInfo.user})},showBuyButton:function(){return!this.free&&this.sectionInfo.isFree&&this.sectionInfo&&this.isMobileBrowser&&!this.bookInfo.isBorrowing}},Object(c.mapGetters)({user:o.USER,login:o.LOGIN})),watch:{$route:function(){this.fetch()},sectionInfo:{handler:function(e){var t=this;return Object(E.a)(regeneratorRuntime.mark((function r(){var n,o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(null==e?void 0:e.id)){r.next=18;break}if(t.htmlContent=e.html,t.bookletId=e.bookId,t.sectionId=e.id,t.readingPostion=Number((null===(n=e.reading_progress)||void 0===n?void 0:n.reading_position)||"0"),t.initPosition(),!(null===(o=t.user)||void 0===o?void 0:o.id)){r.next=18;break}return r.prev=7,r.next=10,Object(content.a)({booklet_id:t.bookletId,section_id:t.sectionId,reading_position:t.readingPostion});case 10:if(0===(c=r.sent).err_no||"0"===c.err_no){r.next=13;break}throw c;case 13:r.next=18;break;case 15:r.prev=15,r.t0=r.catch(7),console.warn("阅读记录上报失败",r.t0);case 18:t.setupVideoPlayer();case 19:case"end":return r.stop()}}),r,null,[[7,15]])})))()},immediate:!0}},mounted:function(){var e=this;return Object(E.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isMounted=!0,e.initRecordReadPos(),e._handleCurrentReadRecord=function(){var t=e.getCurrentReadPos();e.doRecord(t)},Object(S.o)(e._handleCurrentReadRecord),window.addEventListener("beforeunload",e._handleCurrentReadRecord),e.setupVideoPlayer();case 6:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){if(this.removeScrollListener){this.removeScrollListener();var e=this.getCurrentReadPos();this.doRecord(e)}Object(S.q)(this._handleCurrentReadRecord),window.removeEventListener("beforeunload",this._handleCurrentReadRecord)},methods:{setupVideoPlayer:function(){var e;(null===(e=this.sectionInfo)||void 0===e?void 0:e.vid)&&(this.removeVideoTag(),this.$refs.sectionPage&&this.calculateHeight())},calculateHeight:function(){var e=this.$refs.sectionPage,t=e.offsetLeft,r=e.offsetTop,n=e.offsetWidth,o=(this.isMobileBrowser?n:this.$refs.mse.clientWidth)/16*9;this.mobilePlayerStyle={left:"".concat(t,"px"),top:"".concat(r,"px"),width:"".concat(n,"px"),height:"".concat(n/16*9,"px")},this.videoWrapperHeight=o},initPosition:function(){this.$route.hash?this.initHashToElement(this.$route.hash):0<this.readingPostion&&this.readingPostion<=100&&this.scrollToContentPos(this.readingPostion)},removeVideoTag:function(){var content=this.sectionInfo.html||"";content=content.replace(/^<div\s+data-source="https:\/\/video-cdn\.juejin\.im.+?<\/div>/,""),this.htmlContent=content},buyBook:function(){this.$emit("buy")},syncCommentNum:function(e){var t=e.count,r=e.type;"add"===r?this.section.comment_count+=1:"sub"===r?this.section.comment_count-=t?t+1:1:this.section.comment_count=t,this.section.comment_count=this.section.comment_count>0?this.section.comment_count:0},initHashToElement:function(e){var t=this;this.$nextTick((function(){var r=e;if(r&&"#mark-star"!==r)if("#comment"===r)t.$refs.commentForm.focus(),Object(S.r)(t.$refs.commentForm);else{var n=r.substring(1),o=t.$refs.content.$el.querySelectorAll('[data-id="'.concat(n,'"]'))[0],c=t.isMobileBrowser?35:70,l=o.offsetTop;window.scrollTo(0,l-c)}}))},scrollToContentPos:function(e){var t=this;this.$nextTick((function(){var r,n;if(!(null===(n=null===(r=t.$refs)||void 0===r?void 0:r.content)||void 0===n?void 0:n.$el))return 0;var o=Object(S.h)().height,c=t.$refs.content.$el.getBoundingClientRect().height;window.scrollTo(0,c*e/100-o+122)}))},initRecordReadPos:function(){var e,t,r=this;(null===(e=this.user)||void 0===e?void 0:e.id)&&"0"!==(null===(t=this.user)||void 0===t?void 0:t.id)&&(this.removeScrollListener=Object(S.m)(window,Object(O.a)((function(){r.scrollRecord(r.getCurrentReadPos())}),500)))},getCurrentReadPos:function(){var e,t;if(!(null===(t=null===(e=this.$refs)||void 0===e?void 0:e.content)||void 0===t?void 0:t.$el))return 0;var r=Object(S.h)().height,n=this.$refs.content.$el.getBoundingClientRect(),o=n.y,c=n.height;if(0===c)return 0;var l=Math.round((r-o)/c*100);return l<0?0:l>100?100:l},scrollRecord:function(e){Math.abs(e-this.readingPostion)>5&&this.doRecord(e)},doRecord:function(e){var t=this;return Object(E.a)(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null===(n=t.user)||void 0===n?void 0:n.id){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,r.next=5,Object(content.a)({booklet_id:t.bookletId,section_id:t.sectionId,reading_position:e});case 5:if(0===(o=r.sent).err_no||"0"===o.err_no){r.next=8;break}throw o;case 8:t.readingPostion=e,r.next=14;break;case 11:r.prev=11,r.t0=r.catch(2),console.warn("阅读记录上报失败",r.t0);case 14:case"end":return r.stop()}}),r,null,[[2,11]])})))()}}}),I=(r(1638),Object(m.a)(D,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"section-content"},[r("div",{ref:"sectionPage",staticClass:"section-page book-section-view"},[r("div",{staticClass:"video-wrapper",style:e.isMobileBrowser?{height:e.videoWrapperHeight+"px"}:{}},[r("Video",{staticClass:"video",style:e.isMobileBrowser?e.mobilePlayerStyle:{},attrs:{"video-type":e.isLegacyBookletVid?"mp4":"hls",vid:e.sectionInfo.vid||"","video-config":e.videoConfig},on:{handleEvent:e.handleVideoEvent}})],1),e._v(" "),e.sectionInfo.markdown||e.htmlContent?r("markdown-viewer",{ref:"content",attrs:{markdown:e.sectionInfo.markdown,html:e.htmlContent}}):e._e(),e._v(" "),e.showBuyButton?r("div",{staticClass:"bottom-mobile-buy"},[r("div",{staticClass:"buy-btn",on:{click:e.buyBook}},[e._v("购买 ￥"+e._s(e.salePrice))]),e._v(" "),r("VipBorrowButton",{staticClass:"borrow",attrs:{"event-page":"free","book-info":e.bookInfo}})],1):e._e(),e._v(" "),e.sectionInfo.markdown||e.htmlContent?r("section",{ref:"commentBox",staticClass:"book-comments"},[r("div",{staticClass:"box-title"},[e._v("留言")]),e._v(" "),r("CommentListBox",{attrs:{subject:e.subject,expanded:!0,sticky:!1},on:{syncCommentNum:e.syncCommentNum}})],1):e._e()],1)])}),[],!1,null,"7fd6d985",null).exports),j=r(943);function M(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function F(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?M(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):M(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var B={components:{SectionBuyingGuide:y,SectionWriting:w,SectionContent:I},props:["bookInfo","sectionInfo","free"],data:function(){return{}},computed:F(F({},Object(c.mapGetters)({logined:o.LOGINED,user:o.USER})),{},{salePrice:function(){var e=Object(j.c)(this.bookInfo.discount),t=this.bookInfo.price,r=this.bookInfo.discount.rate;return e&&(t=Object(j.a)(t,r)),t},isAuthor:function(){return!!this.user&&this.bookInfo.user.id===(null==this?void 0:this.user.id)},isAdmin:function(){var e,t;return!!this.user&&(null==this||null===(e=this.user)||void 0===e||null===(t=e.roles)||void 0===t?void 0:t.isAdmin)},sectionContentComponent:function(){var e,t,r,n,o=0===(null==this||null===(e=this.bookInfo)||void 0===e?void 0:e.price),c=1===(null==this||null===(t=this.sectionInfo)||void 0===t?void 0:t.is_free),l=(null==this||null===(r=this.bookInfo)||void 0===r?void 0:r.is_buy)||!1,d=0===(null==this||null===(n=this.sectionInfo)||void 0===n?void 0:n.status)||!1,f=(null==this?void 0:this.bookInfo.isBorrowing)||!1;return this.isAdmin||this.isAuthor?"section-content":c||o||l||f?d?"section-writing":"section-content":"section-buying-guide"}}),methods:{buyBook:function(){this.$coursePayment(this.user,this.bookInfo.id)}}},U=(r(1639),Object(m.a)(B,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"section-view"},[t(this.sectionContentComponent,{tag:"component",attrs:{"book-info":this.bookInfo,salePrice:this.salePrice,"section-info":this.sectionInfo,free:this.free},on:{buy:this.buyBook}})],1)}),[],!1,null,"124546c0",null));t.a=U.exports},2059:function(e,t,r){},2060:function(e,t,r){},2061:function(e,t,r){},2062:function(e,t,r){},3199:function(e,t,r){e.exports=r.p+"img/wx-qr.966373a.jpg"},3200:function(e,t,r){"use strict";r(2059)},3201:function(e,t,r){e.exports=r.p+"87ad47e35a060899d2234a8b5e7f378f.svg"},3202:function(e,t,r){e.exports=r.p+"54d8a353dfbeff543c8a513821df8caf.svg"},3203:function(e,t,r){"use strict";r(2060)},3204:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1.24984 3.33331H12.9165C13.3558 3.33331 13.7157 3.67326 13.7476 4.10445L13.7498 4.16665V15.8333C13.7498 16.2726 13.4099 16.6325 12.9787 16.6644L12.9165 16.6666H1.24984C0.81052 16.6666 0.450602 16.3267 0.41879 15.8955L0.416504 15.8333V4.16665C0.416504 3.72733 0.756453 3.36741 1.18764 3.3356L1.24984 3.33331H12.9165H1.24984ZM12.0831 4.99994H2.08309V14.9999H12.0831V4.99994ZM19.5831 6.47177V13.5281C19.5831 14.1758 18.8058 14.5759 18.1948 14.2427L14.9998 12.4999V7.49993L18.1948 5.75718C18.8058 5.42393 19.5831 5.82402 19.5831 6.47177ZM17.9164 7.94361L16.6664 8.44361V11.5563L17.9164 12.0563V7.94361ZM6.24976 6.66661V9.16661H3.74976V6.66661H6.24976Z",fill:"#8A919F"}})]))}}},3205:function(e,t,r){"use strict";r(2061)},3206:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20"},y)},_),d.concat([r("path",{attrs:{fill:"#BABABA","fill-rule":"evenodd",d:"M11 0h9v9h-9V0zM0 0h9v9H0V0zm0 11h9v9H0v-9zm14-5h3V3h-3v3zM3 6h3V3H3v3zm0 11v-3h3v3H3zm8-6h3v3h-3v-3zm3 3h3v3h-3v-3zm3-3h3v3h-3v-3zm-6 6h3v3h-3v-3zm6 0h3v3h-3v-3z"}})]))}}},3207:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,l=t._v,data=t.data,d=t.children,f=void 0===d?[]:d,h=data.class,v=data.staticClass,style=data.style,m=data.staticStyle,y=data.attrs,_=void 0===y?{}:y,w=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[h,v],style:[style,m],attrs:Object.assign({width:"40px",height:"40px",viewBox:"0 0 40 40",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:sketch":"http://www.bohemiancoding.com/sketch/ns"},_)},w),f.concat([r("title",[l("juejin_logo copy")]),r("desc",[l("Created with Sketch.")]),r("defs"),r("g",{attrs:{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd","sketch:type":"MSPage"}},[r("g",{attrs:{id:"juejin_logo-copy","sketch:type":"MSArtboardGroup",fill:"#007FFF"}},[r("path",{attrs:{d:"M23.2819984,7.7030545 L19.8538714,5 L16.2721918,7.8241757 L16.0865388,7.97375707 L19.8538714,10.977629 L23.6327866,7.97375707 L23.2819984,7.7030545 Z M36.2727433,18.185664 L19.8439434,31.1400064 L3.42507143,18.1936064 L1,20.1414735 L19.8439434,35 L38.6981457,20.1335312 L36.2727433,18.185664 Z M19.8439434,19.2367048 L10.903809,12.1875172 L8.47840667,14.1353844 L19.8439434,23.0970293 L31.2190771,14.127442 L28.7936748,12.1795749 L19.8439434,19.2367048 Z",id:"Fill-1-Copy-2","sketch:type":"MSShapeGroup"}})])])]))}}},3208:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,l=t._v,data=t.data,d=t.children,f=void 0===d?[]:d,h=data.class,v=data.staticClass,style=data.style,m=data.staticStyle,y=data.attrs,_=void 0===y?{}:y,w=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[h,v],style:[style,m],attrs:Object.assign({width:"16px",height:"13px",viewBox:"0 0 16 13",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},_)},w),f.concat([r("title",[l("Group 4")]),r("desc",[l("Created with Sketch.")]),r("defs"),r("g",{attrs:{id:"全屏",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[r("g",{attrs:{id:"2_fullscreen_close-sidebar",transform:"translate(-19.000000, -25.000000)",fill:"#979797"}},[r("g",{attrs:{id:"Group-4",transform:"translate(19.000000, 25.000000)"}},[r("rect",{attrs:{id:"Rectangle-3",x:"0",y:"5.5",width:"16",height:"1.5"}}),r("rect",{attrs:{id:"Rectangle-3",x:"0",y:"0",width:"16",height:"1.5"}}),r("rect",{attrs:{id:"Rectangle-3-Copy",x:"0",y:"11",width:"16",height:"1.5"}})])])])]))}}},3209:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"137",height:"28",viewBox:"0 0 137 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{d:"M17.5865 17.3955H17.5902L28.5163 8.77432L25.5528 6.39453L17.5902 12.6808H17.5865L17.5828 12.6845L9.62018 6.40201L6.6604 8.78181L17.5828 17.3992L17.5865 17.3955Z",fill:"#1E80FF"}}),r("path",{attrs:{d:"M17.5872 6.77268L21.823 3.40505L17.5872 0.00748237L17.5835 0L13.3552 3.39757L17.5835 6.76894L17.5872 6.77268Z",fill:"#1E80FF"}}),r("path",{attrs:{d:"M17.5865 23.2854L17.5828 23.2891L2.95977 11.7531L0 14.1291L0.284376 14.3574L17.5865 28L28.5238 19.3752L35.1768 14.1254L32.2133 11.7456L17.5865 23.2854Z",fill:"#1E80FF"}}),r("path",{attrs:{d:"M133.287 18.4172H131.162L129.923 23.0758H126.825V16.7559H135.364V14.7315H126.825V11.1469H133.074V9.12256H118.454V11.1469H124.703V14.7315H116.164V16.7559H124.703V23.0758H121.601L120.363 18.4172H118.237L119.487 23.0758H115.543V25.1001H135.985V23.0758H132.041L133.287 18.4172Z",fill:"#323232"}}),r("path",{attrs:{d:"M130.522 3.3151L130.2 2.94092H121.321L120.999 3.3151C119.298 5.2467 117.378 6.97337 115.278 8.46009V10.9522C116.206 10.3573 120.183 7.72295 122.327 4.98768H129.235C131.375 7.72295 135.356 10.3573 136.284 10.9522V8.46009C134.169 6.97586 132.235 5.2491 130.522 3.3151Z",fill:"#323232"}}),r("path",{attrs:{d:"M94.9037 8.53127H96.494V6.50323H94.9037V2.88867H92.9056V6.50323H91.3303V8.53127H92.9094V14.7914L91.3303 15.3377V17.5828L92.9094 17.0365V20.7371C92.8414 22.2391 92.5579 23.7236 92.0674 25.145H94.1629C94.6112 23.7165 94.863 22.2335 94.9112 20.7371V16.3442L96.5053 15.7904V13.5229L94.9112 14.0767L94.9037 8.53127Z",fill:"#323232"}}),r("path",{attrs:{d:"M99.1875 2.88867H97.6608V20.7446C97.6727 22.2359 97.4852 23.7221 97.1033 25.1637H99.1875C99.5206 23.7145 99.6851 22.2316 99.6776 20.7446V9.77357H112.321V2.88867H99.1875ZM110.308 7.75303H99.6851V4.91671H110.304L110.308 7.75303Z",fill:"#323232"}}),r("path",{attrs:{d:"M110.305 23.405H107.566V17.6838H110.021H110.702H111.91V11.8166H110.021V15.9363H107.566V11.1431H105.676V15.9363H103.27V11.8166H101.381V17.6838H102.298H103.27H105.676V23.405H102.967V19.173H101.074V25.1524H102.286H102.967H110.305H110.683H112.195V19.173H110.305V23.405Z",fill:"#323232"}}),r("path",{attrs:{d:"M53.0024 2.91846V4.83801L56.5908 6.11397L53.0024 7.38618V9.30573L59.2887 7.07187L65.5749 9.30573V7.38618L61.9865 6.11397L65.5749 4.83801V2.91846L59.2887 5.15232L53.0024 2.91846Z",fill:"#323232"}}),r("path",{attrs:{d:"M79.9508 11.697H88.5944V9.47813H79.9508V2.80273H77.5299V9.47813H68.8863V11.697H77.5299V22.9823H67.76V25.2012H89.7207V22.9823H79.9508V11.697Z",fill:"#323232"}}),r("path",{attrs:{d:"M48.9461 5.39227L52.2913 5.18272V3.24072L43.6813 3.78328V5.72529L47.0265 5.512V8.50545H43.5803V10.4213H47.0265V25.164H48.9461V10.4213H52.3923V8.50545H48.9461V5.39227Z",fill:"#323232"}}),r("path",{attrs:{d:"M57.6539 9.01025H55.6595L55.1768 10.3648H52.9991V12.2357H54.5145L52.55 17.7662H53.8821V24.1534H55.7007V16.8457H58.6642V25.1787H60.5837V16.8457H63.4612V21.059C63.4534 22.1374 63.181 23.1974 62.6679 24.146H64.7147C65.1423 23.173 65.3627 22.1217 65.362 21.059V15.6932V15.1282H60.5837V13.2572H58.6642V15.1282H55.4836L56.5313 12.2245H65.594V10.3536H57.1749L57.6539 9.01025Z",fill:"#323232"}}),r("path",{attrs:{d:"M43.562 24.6246H45.4591L46.2786 11.4272H44.3815L43.562 24.6246Z",fill:"#323232"}}),r("path",{attrs:{d:"M49.7849 11.4272L50.3499 23.2963H52.247L51.682 11.4272H49.7849Z",fill:"#323232"}})]))}}},3210:function(e,t,r){"use strict";r(2062)},4302:function(e,t,r){"use strict";r.r(t);var n=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"title"},[t("span",[this._v("关注公众号")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"qr-img"},[t("img",{attrs:{src:r(3199)}})])}],o=(r(16),r(15),r(11),r(14),r(6),r(135),r(45),r(39),r(0)),c=r(48),l=r(4),d=r(84),f=r(1814),h={props:["curIndex","list"]},v=(r(3200),r(30)),m=Object(v.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"book-progress"},[r("ul",e._l(e.list,(function(t,n){return r("li",{class:{active:n<=e.curIndex}})})),0)])}),[],!1,null,"6fbc2a2e",null).exports,y=r(1194),_={components:{VipBorrowButton:y.a},props:["free","curIndex","list","isBorrowing","bookInfo","foldPc"],data:function(){return{}},computed:{notLastPage:function(){return this.curIndex<this.list.length-1},notFirstPage:function(){return this.curIndex>0},bookId:function(){return this.$route.params.id}},methods:{buyBook:function(){this.$emit("buy")},prevPage:function(){this.$emit("prev")},nextPage:function(){this.$emit("next")}}},w=(r(3203),Object(v.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"handle"},[e.list.length>0?n("div",{staticClass:"book-handle",class:{"fold-pc":e.foldPc}},[e.notFirstPage?n("div",{staticClass:"step-btn step-btn--prev",on:{click:e.prevPage}},[n("img",{attrs:{src:r(3201)}})]):e._e(),e._v(" "),e.notLastPage?n("div",{staticClass:"step-btn step-btn--next",on:{click:e.nextPage}},[n("img",{attrs:{src:r(3202)}})]):e._e()]):e._e(),e._v(" "),e.notLastPage||e.free||e.bookInfo.isBorrowing?e._e():n("div",{staticClass:"buy-container"},[n("button",{staticClass:"buy",on:{click:e.buyBook}},[e._v("购买")]),e._v(" "),n("VipBorrowButton",{staticClass:"borrow",attrs:{"book-info":e.bookInfo,"event-page":"free"}})],1)])}),[],!1,null,"7f935304",null).exports),E=r(1193),T=r(1641),S=r(1642),O=r.n(S),C=r(3204),k=r.n(C),L=r(177);function A(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function R(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?A(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):A(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var x={components:{LockIcon:O.a,CameraIcon:k.a,BAlert:L.Alert},props:["free","admin","info","list","sectionId","isVideoCourse"],data:function(){return{sectionList:[],userRole:""}},computed:R(R({},Object(d.mapGetters)({user:l.USER})),{},{tryRead:function(){var e=this.info,t=e.price,r=e.isBuy;return!(0===t)&&this.admin||!r},bookId:function(){return this.$route.params.id}}),created:function(){this.initData()},methods:{initData:function(){var e=new T.a(this.list,this.info,this.user);this.userRole=e.userRole,this.sectionList=e.getSectionList()},setFreeSection:function(e,t){this.$emit("setFreeSection",e,t)},routeSectionId:function(e){var t=e.sectionId;t!==this.$route.params.sectionId&&this.$emit("linkSection",t)}}},P=(r(3205),Object(v.a)(x,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"book-directory-comp beautify-scrollbar-warp",class:{"is-admin":"admin"===e.userRole,"is-author":"author"===e.userRole,"is-buyer":"buyer"===e.userRole}},[r("div",{staticStyle:{padding:"0 15px"}},["admin"===e.userRole?r("b-alert",{attrs:{"show-icon":""}},[e._v("\n      当前是管理员状态,以下所有章节都可点击阅读\n    ")]):"author"===e.userRole?r("b-alert",{attrs:{"show-icon":""}},[e._v("\n      您是小册作者,以下所有章节都可点击阅读\n    ")]):e._e()],1),e._v(" "),r("div",{staticClass:"section-list"},e._l(e.sectionList,(function(t,n){return r("a",{key:t.sectionId,staticClass:"section",class:{unfinished:!t.isFinished,"route-active":e.sectionId===t.sectionId},on:{click:function(r){return e.routeSectionId(t)}}},[r("div",{staticClass:"left"},[r("div",{staticClass:"index"},[e._v(e._s(n+1))])]),e._v(" "),r("div",{staticClass:"center"},[r("div",{staticClass:"main-line"},[r("div",{staticClass:"title"},[e.isVideoCourse||t.hasVideo?r("CameraIcon",{staticClass:"icon-camera"}):e._e(),e._v(" "),r("span",{staticClass:"title-text"},[e._v(e._s(t.title))])],1),e._v(" "),r("div",{staticClass:"right"},[t.isFinished?"buyer"===e.userRole||e.info.isBorrowing?e._e():["付费章节"===t.freeStatus?r("div",{staticClass:"lock"},[r("LockIcon")],1):e._e(),e._v(" "),"试学章节"===t.freeStatus?r("div",{staticClass:"label"},[e._v("\n                试学\n              ")]):e._e()]:r("div",{staticClass:"lock"},[r("LockIcon")],1)],2)]),e._v(" "),r("div",{staticClass:"sub-line"},[t.isFinished?["已学完"===t.status?r("div",{staticClass:"label",staticStyle:{color:"#8a919f",background:"#e4e6eb"}},[e._v("\n              已学完\n            ")]):"上次学到"===t.status?r("div",{staticClass:"label",staticStyle:{color:"#1e80ff",background:"#eaf2ff"}},[e._v("\n              上次学到\n            ")]):"有更新"===t.status?r("div",{staticClass:"label",staticStyle:{color:"#f53f3f",background:"#ffece8"}},[e._v("\n              有更新\n            ")]):e._e(),e._v(" "),r("span",[e._v("学习时长: "+e._s(t.readDurationStr))])]:r("div",[e._v("写作中...")])],2)])])})),0)])}),[],!1,null,"2a11fbfe",null).exports),D=r(1286),I=r(219),j=r(184),M=r(27),F=r(7),B=r(3206),U=r.n(B),N=r(3207),V=r.n(N),H=r(3208),G=r.n(H),K=r(3209),$=r.n(K);function W(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function z(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?W(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):W(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var Y=Object(F.b)({components:{UserAuth:D.a,BookDirectory:P,BookDirection:w,BookProgress:m,WechatQuickLogin:E.a,SectionPrev:f.a,SectionNext:f.a,AppOpenDrawer:function(){return Promise.all([r.e(10),r.e(11)]).then(r.bind(null,4398))},QrIcon:U.a,JuejinIcon:V.a,MenuIcon:G.a,JuejinLogoIcon:$.a,VipBorrowButton:y.a},provide:function(){var e=this;return{refreshBook:function(){e.fetch()}}},data:function(){return{sectionError:!1,sectionList:[],bookInfo:null,sectionInfo:{},direction:"next",view:"prev",unfoldM:!1,foldPc:!1,isViewNavOnTop:!1,isHeaderVisible:!0,needHide:!1,qrHide:!1,isPlayingFullscreen:!1}},computed:z(z({},Object(d.mapGetters)({user:l.USER,logined:l.LOGINED})),{},{isVideoCourse:function(){var e,t;return(null===(t=null===(e=this.bookInfo)||void 0===e?void 0:e.base_info)||void 0===t?void 0:t.course_type)===I.a.video},isAuthor:function(){var e,t;return(null===(e=this.author)||void 0===e?void 0:e.id)===(null===(t=this.user)||void 0===t?void 0:t.id)},isAdmin:function(){var e,t=this.user||{};return(null===(e=null==t?void 0:t.roles)||void 0===e?void 0:e.isAdmin)||this.isAuthor},canPayment:function(){var e=this.bookInfo,t=e.price,r=e.isBuy;return t>0&&!r&&!this.isAuthor},directionClass:function(){return"prev"===this.direction?"transition--prev":"transition--next"},bookId:function(){return this.$route.params.id},sectionId:function(){return this.$route.params.sectionId},filterList:function(){var e=this;return this.isAdmin?this.sectionList.map((function(e){return e.sectionId})).filter((function(e){return e})):this.sectionList.map((function(t){return!(!(e.free||t.isFree||e.bookInfo.isBorrowing)||!t.isFinished)&&t.sectionId})).filter((function(e){return e}))},sectionIdList:function(){return this.bookInfo&&this.bookInfo.section||[]},curDirectoryIndex:function(){return this.sectionIdList&&this.sectionIdList.indexOf(this.sectionId)},curFreeDirectoryIndex:function(){var e=this.$route.params.sectionId;return this.filterList.indexOf(e)},free:function(){var e=this.bookInfo,t=e.price,r=e.isBuy,n=0===t;return n||r},author:function(){var e=this.bookInfo;return e&&e.user||{}},isMobile:function(){return this.$device.isMobile},scheme:function(){var e=this.$route.params||{},t=e.id,r=e.sectionId;return Object(j.e)("https://".concat(M.b,"/book/").concat(t,"/section/").concat(r),j.a.bookSectionDetail.gd_label)}}),watch:{$route:function(){this.bookInfo||this.fetch(),this.getSection(),this.loopComponent()}},shareInfo:function(){var e=this.bookInfo||{};return{title:"".concat(e.title," - ").concat(this.author.username," - 掘金课程"),noTemplate:!0,description:e.desc,thumb:e.img,url:this.$route.fullPath}},head:function(){var title=this.bookInfo&&this.bookInfo.title||"",e=this.author.username||"";return e=e?e+" - ":"",{titleTemplate:null,title:"".concat(title=title?title+" - ":"").concat(e,"掘金课程")}},methods:z(z({},Object(d.mapActions)({toogle_suspension:l.CHANGE_SUSPENSION_PANEL})),{},{buyBook:function(){return this.$coursePayment(this.user,this.bookId)},getXiaoce:function(){var e=this;return this.getXiaoceById().then((function(){e.isVideoCourse&&"bookSection"===e.$route.name&&e.$router.replace({name:"videoCourseSection",params:e.$route.params})}))},getXiaoceById:function(){var e=this;return Object(I.b)(this.bookId).then((function(t){var r=t.bookInfo,n=t.sections;e.bookInfo=r;e.sectionList=n.length?n.map((function(e){return Object.assign(e,{read:!1})})):[],Number(e.sectionId)?e.getSection():e.redirectSection()}))},getSection:function(){var e=this,t=this.sectionId;this.setSectionListIsRead(t),Object(I.e)(t).then((function(t){if(t||e.redirectSection(),!t.id)return Promise.reject(new Error);e.sectionInfo=Object.assign({},t,{html:t.content,markdown:t.markdown_show}),e.enterSectionTEA()})).catch((function(t){console.error(t),e.sectionInfo=null}))},setFreeSection:function(e,t){var r=this;this.$getBean("xiaoceBusiness").setFreeSection(e,t).then((function(){r.getListSection()})).catch((function(e){r.$alertMsg(e)}))},redirectSection:function(){var e=this.filterList&&this.filterList[0];e?(this.setSectionListIsRead(e),this.$router.replace({params:{id:this.bookId,sectionId:e}})):this.$router.push({name:this.isVideoCourse?"videoCourseInfo":"bookInfo",params:{id:this.bookId}})},loopComponent:function(){var e=this.view;this.view="prev"===e?"next":"prev"},prevPage:function(e){(e=e||this.filterList[this.curFreeDirectoryIndex-1])&&(this.setSectionListIsRead(e),this.sectionInfo={},this.direction="prev",this.$router.push({params:{sectionId:e},query:this.$route.query}))},nextPage:function(e){(e=e||this.filterList[this.curFreeDirectoryIndex+1])&&(this.setSectionListIsRead(e),this.direction="next",this.sectionInfo={},this.$router.push({params:{sectionId:e},query:this.$route.query}))},setSectionIsRead:function(e,t){var r=Object.assign(this.sectionList[e],{read:t});this.$set(this.sectionList,e,r)},setSectionListIsRead:function(e){var t=this,r=this.sectionIdList.indexOf(e);r>-1&&this.sectionIdList.forEach((function(e,n){n<r?t.setSectionIsRead(n,!0):t.setSectionIsRead(n,!1)}))},linkSection:function(e){var t=this.sectionIdList.indexOf(e);this.curDirectoryIndex>t?(this.direction="prev",this.prevPage(e)):(this.direction="next",this.nextPage(e)),this.unfoldM=!1},toggleSummary:function(){var e=this.unfoldM,t=this.foldPc;this.unfoldM=!e,this.foldPc=!t},toggleQrPopup:function(){var e=this.qrHide;this.qrHide=!e},hideQrPopup:function(){var e=this;this.qrHide=!0,window.localStorage.setItem("bookQrHideSection",!0);var t=this.$getBean("eventBus");t.onVmLife(this,t.eventType.ROOT_CONTAINER_CLICK,(function(){e.qrHide=!0}))},initQrHide:function(){var e=window.localStorage.getItem("bookQrHideSection");this.qrHide=e},initScroll:function(){var e=this;this.removeScrollDirectionChangeEventListener=Object(c.n)(window,(function(t,r){var n="up"===t,o=r<=50;e.needHide=o&&!n,e.isHeaderVisible=o||n}),50),this.removeScrollEventListener=Object(c.m)(window,(function(){window.pageYOffset<=50&&!e.isHeaderVisible?e.isHeaderVisible=!0:e.needHide&&(e.needHide=!1,e.isHeaderVisible=!1)}),50)},initPlayDirection:function(){var e=this;this.removeDirectionListener=Object(c.k)(document,"keyup",(function(t){t.ctrlKey||e.isPlayingFullscreen||(37===t.keyCode?e.prevPage():39===t.keyCode&&e.nextPage())}))},fetch:function(){this.getXiaoce()},reset:function(){this.toogle_suspension(!0)},handleVisibilityChange:function(){"visible"===document.visibilityState&&this.enterSectionTEA()},enterSectionTEA:function(){var e=this.sectionInfo;this.$TEA("book_section_detail_visit",{book_id:e.booklet_id,section_id:e.section_id,is_trial_section:e.is_free,is_purchased:this.bookInfo.isBuy?1:0,platform:this.isMobile?"h5":"web",rent_status:this.bookInfo.isBorrowing?"underway":this.bookInfo.borrowTimes>0?"finish":"never"})}}),mounted:function(){var e,t,r=this;this.initQrHide(),this.initScroll(),this.toogle_suspension(!1),this.fetch(),this.initPlayDirection();var n=this.$getBean("eventBus");n.onVmLife(this,n.eventType.VIDEO_FULLSCREEN_CHANGE,(function(e){r.isPlayingFullscreen=e})),Object(c.o)(this.handleVisibilityChange),this.isMobile&&!(null===(t=null===(e=this.$store.state)||void 0===e?void 0:e.header)||void 0===t?void 0:t.isPopupZlink)&&(window.open("https://z.juejin.cn/SMF5","_blank"),this.$store.commit("header/POPUP_ZLINK"))},beforeDestroy:function(){this.reset(),this.removeDirectionListener(),this.removeScrollEventListener(),this.removeScrollDirectionChangeEventListener(),Object(c.q)(this.handleVisibilityChange)}}),X=(r(3210),Object(v.a)(Y,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.bookInfo?r("div",{staticClass:"book-read-view"},[r("section",{staticClass:"book-section",class:{"fold-pc":e.foldPc}},[r("div",{staticClass:"book-summary",class:{"unfold-mobile":e.unfoldM}},[r("div",{staticClass:"book-summary-masker",on:{click:e.toggleSummary}}),e._v(" "),r("div",{staticClass:"book-summary-inner"},[r("div",{staticClass:"book-summary__header"},[r("app-link",{staticClass:"logo",attrs:{to:e.$courseIndex()}},[r("JuejinLogoIcon",{staticStyle:{height:"100%",width:"auto"}})],1),e._v(" "),r("div",{staticClass:"label"},[e._v("课程")]),e._v(" "),1==e.bookInfo.isPublish?r("div",{staticClass:"audit"},[e._v("审核中")]):e._e()],1),e._v(" "),e.free||e.bookInfo.isBorrowing?e._e():r("div",{staticClass:"buy-sticky"},[r("button",{staticClass:"section-buy",on:{click:e.buyBook}},[e._v("\n            购买: ￥"+e._s(e.bookInfo.price)+"\n          ")]),e._v(" "),r("VipBorrowButton",{attrs:{"event-page":"free","book-info":e.bookInfo},on:{fetch:e.getXiaoceById}})],1),e._v(" "),r("book-directory",{staticClass:"book-directory",class:{bought:!e.canPayment},attrs:{free:e.free,admin:e.isAdmin,info:e.bookInfo,list:e.sectionList,"cur-index":e.curDirectoryIndex,sectionId:e.sectionId,"is-video-course":e.isVideoCourse},on:{setFreeSection:e.setFreeSection,linkSection:e.linkSection}}),e._v(" "),r("div",{staticClass:"book-summary__footer",on:{click:function(e){e.stopPropagation()}}},[r("div",{staticClass:"qr-icon",on:{click:function(t){return t.stopPropagation(),e.toggleQrPopup(t)}}},[r("QrIcon")],1),e._v(" "),r("div",{staticClass:"qr-tips",class:{show:!e.qrHide}},[r("span",{staticClass:"ion-close",on:{click:e.hideQrPopup}}),e._v(" "),e._m(0),e._v(" "),e._m(1)])])],1)]),e._v(" "),r("div",{staticClass:"book-content"},[r("div",{staticClass:"book-content-inner"},[r("div",{staticClass:"book-content__header",class:{visible:e.isHeaderVisible}},[r("div",{staticClass:"switch",on:{click:e.toggleSummary}},[r("JuejinIcon",{staticStyle:{width:"30px",height:"30px","vertical-align":"middle"}})],1),e._v(" "),r("div",{staticClass:"menu",on:{click:e.toggleSummary}},[r("MenuIcon")],1),e._v(" "),r("div",{staticClass:"title"},[r("app-link",{attrs:{to:e.$bookInfo(e.bookId,e.isVideoCourse?"video":"book")}},[e._v("\n              "+e._s(e.bookInfo.title)+"\n            ")])],1),e._v(" "),r("user-auth",{staticClass:"user-auth"}),e._v(" "),e.foldPc?r("book-progress",{staticClass:"book-progress",attrs:{"cur-index":e.curDirectoryIndex,list:e.sectionIdList}}):e._e()],1),e._v(" "),r("div",{ref:"bookBody",staticClass:"book-body",class:[e.directionClass,{mobile:e.isMobile}]},[r("section-"+e.view,{tag:"component",staticClass:"book-section-content",attrs:{free:e.free,user:e.user,"book-info":e.bookInfo,"section-info":e.sectionInfo},on:{buy:e.buyBook}})],1),e._v(" "),r("book-direction",{directives:[{name:"show",rawName:"v-show",value:e.sectionInfo&&e.curFreeDirectoryIndex>-1,expression:"sectionInfo && curFreeDirectoryIndex > -1"}],staticClass:"book-direction",attrs:{free:e.free,"cur-index":e.curFreeDirectoryIndex,list:e.filterList,"is-borrowing":e.bookInfo.isBorrowing,"book-info":e.bookInfo,"fold-pc":e.foldPc},on:{buy:e.buyBook,prev:e.prevPage,next:e.nextPage}})],1)])]),e._v(" "),r("wechat-quick-login"),e._v(" "),e.$device.isMobile?r("AppOpenDrawer",{attrs:{zlink:"https://z.juejin.cn/SMF5",scheme:e.scheme}}):e._e()],1):e._e()}),n,!1,null,"8f4b0b3c",null));t.default=X.exports},853:function(e,t,r){"use strict";r.d(t,"g",(function(){return f})),r.d(t,"h",(function(){return h})),r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return m})),r.d(t,"f",(function(){return y})),r.d(t,"e",(function(){return _})),r.d(t,"d",(function(){return E})),r.d(t,"c",(function(){return T}));r(16),r(15),r(11),r(6),r(14),r(23);var n=r(0),o=r(5),c=r(1);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function f(e){var t=e.item_id,r=e.item_type,n=e.comment_content,o=e.comment_pics;return Object(c.e)({url:"/interact_api/v1/comment/publish",method:"post",body:{item_id:t,item_type:r,comment_content:n,comment_pics:o,client_type:2608}})}function h(e){var t=e.reply_to_comment_id,r=e.reply_to_reply_id,n=e.reply_to_user_id,o=e.item_id,l=e.item_type,d=e.reply_content,f=e.reply_pics;return Object(c.e)({url:"/interact_api/v1/reply/publish",method:"post",body:{reply_to_comment_id:t,reply_to_reply_id:r,reply_to_user_id:n,item_id:o,item_type:l,reply_content:d,reply_pics:f,client_type:2608}})}function v(e){var t=e.comment_id;return Object(c.e)({url:"/interact_api/v1/comment/delete",method:"post",body:{comment_id:String(t)}}).then((function(e){return e.data}))}function m(e){var t=e.comment_id,r=e.reply_id;return Object(c.e)({url:"/interact_api/v1/reply/delete",method:"post",body:{comment_id:t,reply_id:r}}).then((function(e){return e.data}))}function y(e){var t=e.comment_id,r=e.item_id,n=e.item_type,cursor=e.cursor,o=e.limit;return Object(c.e)({url:"/interact_api/v1/reply/list",method:"post",body:{comment_id:t,item_id:r,item_type:n,cursor:cursor,limit:o,client_type:2608}})}function _(e){return w.apply(this,arguments)}function w(){return(w=Object(o.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.e)({url:"/interact_api/v1/comment/hots",method:"post",body:t});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return Object(c.e)({url:"/interact_api/v1/comment/list",method:"post",body:d(d({},e),{},{client_type:2608})})}function T(e){return Object(c.e)({url:"/interact_api/v1/comment/detail",method:"post",body:{comment_id:e,clent_type:2608},showError:!1})}},856:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));r(6);var n=r(12),o=r(13),c=function(){function e(){Object(n.a)(this,e),this.busy=!1}return Object(o.a)(e,[{key:"do",value:function(e){var t=this;return this.busy?Promise.resolve():(this.busy=!0,Promise.resolve("function"==typeof e?e():e).then((function(e){return t.busy=!1,e})).catch((function(e){return t.busy=!1,Promise.reject(e)})))}}]),e}();function l(){return new c}},858:function(e,t,r){"use strict";r(135);var n=r(68),o=r(271),c=r(273),l=r(8),d=Object(l.d)({components:{Lazy:c.a},props:{url:{type:String},default:{type:String},quality:{type:Number},width:{type:Number,default:0},height:{type:Number,default:0},shrink:{type:Boolean},format:{type:String},alt:{type:String},blank:{type:String},hasMark:{type:Boolean,default:!1},lazy:{type:Boolean,default:!0}},computed:{defaultThumbUrl:function(){return this.default||n.h},thumbUrl:function(){var e=this.url||(this.blank?"":this.defaultThumbUrl);return this.shrink?Object(o.d)(e,this.width*n.l,this.height*n.l,{format:this.format,quality:this.quality},this.hasMark?"zoomCrop":"noMark"):Object(o.a)(e,this.width*n.l,this.height*n.l,{format:this.format,quality:this.quality},this.hasMark?"zoomCrop":"noMark")}}}),f=r(30),component=Object(f.a)(d,(function(){var e=this.$createElement;return(this._self._c||e)("lazy",{attrs:{url:this.thumbUrl,alt:this.alt,lazy:this.lazy,"loading-style":{aspectRatio:""+this.width/this.height}}})}),[],!1,null,null,null);t.a=component.exports},867:function(e,t,r){"use strict";r.r(t);r(16),r(15),r(11),r(14),r(6);var n=r(0),o=r(8),c=r(4),l=r(856),d=r(178),f=r(28),h=r(84),v=r(932),m=Object(o.d)({components:{Triangle:v.a},props:{disalbe:{type:Boolean,default:!1},promise:Promise},setup:function(e,t){var data=Object(o.p)({visible:!1,top:0,left:0,isTop:!1}),r=Object(o.q)(null),n=Object(o.q)(null),c=Object(o.q)();return{data:data,popoverStyle:Object(o.a)((function(){return{top:"".concat(data.top,"px"),left:"".concat(data.left,"px")}})),contentElem:c,showPopover:function(o){e.disalbe||(clearTimeout(n.value),t.emit("show"),r.value=setTimeout((function(){Promise.resolve(e.promise).then((function(){r.value&&(data.visible=!0,t.root.$nextTick((function(){var e=o.target,t=null==e?void 0:e.getBoundingClientRect(),r=e.offsetWidth||33,n=e.offsetHeight||33,l=c.value,d=(null==l?void 0:l.offsetWidth)||260,f=(null==l?void 0:l.offsetHeight)||160,h=t.left-d/2+r/2,v=t.top-f-12;data.isTop=!1,v<60&&(data.isTop=!0,v=t.top+n+8),h=Math.max(0,h),data.left=h,data.top=v})))}))}),300))},hidePopover:function(){clearTimeout(r.value),r.value=null,t.emit("hide"),n.value=setTimeout((function(){n.value=null,data.visible=!1}),300)}}}}),y=(r(1023),r(30)),_=Object(y.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"popover-box",on:{mouseenter:function(t){return e.showPopover(t)},mouseleave:e.hidePopover}},[r("transition",{attrs:{name:"fade"}},[e.data.visible?r("div",{ref:"contentElem",staticClass:"popover-content",style:e.popoverStyle},[e._t("content"),e._v(" "),r("triangle",{staticClass:"triangle-bottom",class:{isTop:e.data.isTop}})],2):e._e()]),e._v(" "),e._t("default")],2)}),[],!1,null,"f1a2074a",null).exports,w=r(868);function E(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function T(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?E(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):E(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var S=Object(o.d)({components:{Avatar:d.a,Popover:_,Button:w.a},props:{userId:String,showJscoreLevel:{type:Boolean,default:!1},enablePopover:{type:Boolean,default:!0}},data:function(){return{user:null,followLock:Object(l.a)(),fetchUserPromise:null,isFollowing:!1}},computed:T(T({},Object(h.mapGetters)({currentUser:c.USER})),{},{position:function(){return this.user&&(this.$userPosition(this.user)||this.user.description||"暂无简介")},self:function(){return this.currentUser&&this.currentUser.id===this.userId},followed:function(){return this.user&&this.user.followed}}),methods:{toFollowing:function(){window.open("/user/".concat(this.userId,"/following"),"_blank")},toFollower:function(){window.open("/user/".concat(this.userId,"/followers"),"_blank")},handleShow:function(){this.fetchUserPromise=this.fetch().then((function(e){if(e.is_logout)return Promise.reject()}))},fetch:function(){var e=this;return Object(f.i)(this.userId,{ignore404:!0}).then((function(t){return e.user=t,t}))},toggleFollow:function(){var e=this;this.isFollowing=!0,this.followLock.do((function(){return e.$ensureAuthorized().then((function(){return e.$store.dispatch(c.TOGGLE_FOLLOW_USER,e.user).catch((function(t){e.$error(t)}))})).catch((function(e){return console.warn("follow failed err:",e)})).finally((function(){return e.isFollowing=!1}))}))}}}),O=(r(1024),r(1025),Object(y.a)(S,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Popover",{staticClass:"user-popover",attrs:{promise:e.fetchUserPromise},on:{show:e.handleShow},scopedSlots:e._u([{key:"content",fn:function(){return[r("div",{staticClass:"info-row",on:{click:function(e){e.stopPropagation()}}},[r("app-link",{attrs:{to:e.$userRoute(e.user),blank:!0}},[r("avatar",{staticClass:"avatar",attrs:{user:e.user,decorative:!0,alt:e.user.username+"的头像"}})],1),e._v(" "),r("div",{staticClass:"user-info"},[r("username",{attrs:{user:e.user,"show-jscore-level":e.showJscoreLevel}}),e._v(" "),r("div",{staticClass:"position"},[e._v(e._s(e.position))])],1)],1),e._v(" "),e.self?e._e():r("Button",{staticClass:"follow-btn",attrs:{"st:name":"followBtn",attention:!0,"custom-attention-text":"关注","cancel-attention-text":"取消关注",cancel:e.followed,loading:e.isFollowing,size:"large","show-icon":!1},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.toggleFollow(t)}}}),e._v(" "),r("div",{staticClass:"meta-row",on:{click:function(e){e.stopPropagation()}}},[r("ul",{staticClass:"meta-list"},[r("li",{staticClass:"item",on:{click:e.toFollowing}},[r("div",{staticClass:"count"},[e._v(e._s(e.user.followingCount||0))]),e._v(" "),r("div",{staticClass:"title"},[e._v("关注")])]),e._v(" "),r("li",{staticClass:"divider"}),e._v(" "),r("li",{staticClass:"item",on:{click:e.toFollower}},[r("div",{staticClass:"count"},[e._v(e._s(e.user.followerCount||0))]),e._v(" "),r("div",{staticClass:"title"},[e._v("粉丝")])])])])]},proxy:!0}])},[e._v(" "),e._t("default")],2)}),[],!1,null,"0c01b30d",null));t.default=O.exports},868:function(e,t,r){"use strict";var n=r(8),o=r(888),c=r.n(o),l=r(889),d=r.n(l),f=r(890),h=r.n(f),v=r(891),m=r.n(v),y=r(892),_=r.n(y),w=Object(n.d)({props:{type:{type:String,default:"primary"},attention:Boolean,customAttentionText:String,cancelAttentionText:String,size:{type:String,default:"medium"},status:{type:String,default:"default"},disabled:Boolean,loading:Boolean,cancel:Boolean,text:String,icon:String,showIcon:{type:Boolean,default:!0}},setup:function(e,t){var r=Object(n.a)((function(){return e.attention}));return{handleClick:function(r){e.disabled||e.loading||t.emit("click",r)},isAttentionType:r,attentionText:Object(n.a)((function(){return"mini"===e.size&&e.loading?"":e.cancel?e.loading?"取消":e.cancelAttentionText||"已关注":e.customAttentionText||"关注"})),iconSrc:Object(n.a)((function(){return e.loading?e.cancel||r.value&&"primary"!==e.type?m.a:_.a:r.value&&e.showIcon?"mini"===e.size?"":e.icon||e.cancel?h.a:"primary"===e.type?c.a:d.a:""}))}}}),E=(r(893),r(30)),component=Object(E.a)(w,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",{staticClass:"ui-btn",class:[e.type,e.size,e.status,e.cancel?"cancel":"",e.attention?"attention":""],attrs:{disabled:e.disabled||e.loading},on:{click:e.handleClick}},[e.iconSrc?r("img",{staticClass:"img",class:e.loading?"loading":"",attrs:{src:e.iconSrc}}):e._e(),e._v(" "),e.isAttentionType?[e._v("\n    "+e._s(e.attentionText)+"\n  ")]:e._t("default",[e._v(e._s(e.text))])],2)}),[],!1,null,"05e27314",null);t.a=component.exports},869:function(e,t,r){},870:function(e,t,r){"use strict";r(16),r(15),r(11),r(14),r(45),r(6),r(83);var n,o=r(32),c=(r(23),r(5)),l=r(0),d=r(4),f=r(929),h=r(178),v=r(930),m=r(921),y=r(894),_=r(885),w=r(853),E=r(882),T=r(886),S=r(879),O=r(180),C=r(933),k=r.n(C),L=r(17);function A(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function R(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?A(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):A(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var x=(n={},Object(l.a)(n,L.f.ArticleIdType,"article"),Object(l.a)(n,L.f.PinType,"pin"),Object(l.a)(n,L.f.Book,"小册"),Object(l.a)(n,L.f.Realtime,"news"),n),P={components:{AuthCard:v.a,Avatar:h.a,Emoji:f.a,ImageIcon:k.a},props:["commentList","replyList","subject","comment","parent","autoFocus","placeholder","mode","small"],data:function(){return{active:!1,focused:!1,submitting:!1,content:"",imageFile:null,imagePreviewUrl:"",emoji:""}},computed:{me:function(){return this.$store.getters.USER},bindedPhone:function(){return this.me&&this.me.isBindedPhone},empty:function(){return!this.content.length},canSubmit:function(){return this.content.length&&!this.submitting},isActionBoxVisible:function(){return(this.focused||!this.empty||this.imageFile)&&this.me&&this.bindedPhone},submitButtonTitle:function(){return this.submitting?"提交中...":"发表评论"},sendTip:function(){return this.$device.isMacOS?"⌘ + Enter":"Ctrl + Enter"}},watch:{focused:function(e){e&&!this.me&&this.$requestLogin(),e||!this.empty||this.imageFile||(this.$emit("emptyBlur"),this.$store.dispatch(d.UPDATE_PIN_ON_FOCUS,!1))},imageFile:function(){Object(S.g)(this.$refs.richInput)}},methods:{onFocus:function(){this.focused=!0,this.$store.dispatch(d.UPDATE_PIN_ON_FOCUS,!0)},onOuterClick:function(){this.empty&&(this.focused=!1)},onFormBoxClick:function(e){var t=e.target;if(this.bindedPhone){var input=this.$refs.richInput;input.focus(),input.contains(t)||Object(S.g)(input)}},onInput:function(){this.focused=!0,Object(S.e)(this.$refs.richInput),this.content=this.emojiToText(this.$refs.richInput.innerHTML),this.content=Object(S.b)(this.content)},onPaste:function(e){e.preventDefault(),Object(S.f)(e,this.onFileSelected);var text=Object(S.a)(e),html=Object(O.d)(text);Object(S.c)(this.$refs.richInput,html),this.focused=!0,this.content=this.emojiToText(this.$refs.richInput.innerHTML),this.content=Object(S.b)(this.content)},onKeydown:function(e){var t=this;if(this.content.length&&!this.submitting)return Object(m.a)(e,(function(){return t.submit()}))},cleanContent:function(){this.$refs.richInput.innerHTML="",this.content=""},updateEmoji:function(e){this.emoji=e,Object(S.c)(this.$refs.richInput,Object(O.c)(this.emoji)),this.focused=!0,this.content=this.emojiToText(this.$refs.richInput.innerHTML),this.content=Object(S.b)(this.content)},showFileDialog:function(){this.$refs.input.click()},changeFile:function(e){this.imageFile=e,window.URL.revokeObjectURL(this.imagePreviewUrl),this.imagePreviewUrl=e?window.URL.createObjectURL(e):""},cleanFile:function(){this.changeFile(null)},onFileSelected:function(e){var t=this;this.$refs.input.value=null,e&&(this.isWithVaildSize(e)?Object(y.a)(e,_.a).then((function(r){r?t.changeFile(e):t.$error("不支持此格式的图片")})):this.$error("文件过大"))},isWithVaildSize:function(e){return e.size<=_.c},uploadFile:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var r,n,c,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.imageFile){t.next=11;break}return t.next=3,Object(E.a)(e.me.user_id,[e.imageFile]);case 3:return r=t.sent,n=Object(o.a)(r,1),c=n[0],l=e.imageFile.type.split("/")[1],d={gif:0,png:1,jpg:2,jpeg:2},t.abrupt("return",{pic_url:c.Url,width:c.ImageHeight,height:c.ImageWidth,pic_type:d[l]||1});case 11:return t.abrupt("return",Promise.resolve());case 12:case"end":return t.stop()}}),t)})))()},submit:function(){var e=this;return this.submitting=!0,this.uploadFile().then((function(image){return e.createSubmitTask(image)})).then((function(t){if(0===t.err_no?(e.$emit("syncCommentNum",{type:"add"}),e.submitting=!1,e.$alertMsg("评论成功"),e.$emit("submitted"),e.reset()):e.$error(t.err_msg||"评论失败，请稍后重试"),Object(T.a)()){var r=Object(T.b)();e.$TEA("search_detail_action",R(R({},r),{},{action_type:L.a.Comment,action_value:e.commentList.length}))}})).catch((function(t){e.submitting=!1,e.$error(t)}))},createSubmitTask:function(image){var e=this,t=this.subject,r=t.item_id,n=t.item_type,o=t.user_id;t.cate_id;return this.$TEA("comment_action",{comment_type:x[n],comment_parent_id:r,author_user_id:o,comment_url:location.href,mode:this.mode}),this.comment?this.comment.reply_info?Object(w.h)({reply_to_comment_id:this.comment.reply_info.reply_comment_id,reply_to_reply_id:this.comment.reply_info.reply_id,reply_to_user_id:this.comment.reply_info.user_id,item_id:r,item_type:n,reply_content:this.content,reply_pics:void 0===image?[]:[image]}).then((function(t){return 0===t.err_no&&(e.replyList||[]).push(t.data),t})):Object(w.h)({reply_to_comment_id:this.comment.comment_info.comment_id,reply_to_reply_id:null,reply_to_user_id:null,item_id:r,item_type:n,reply_content:this.content,reply_pics:void 0===image?[]:[image]}).then((function(t){return 0===t.err_no&&(e.replyList||[]).push(t.data),t})):Object(w.g)({item_id:r,item_type:n,comment_content:this.content,comment_pics:void 0===image?[]:[image]}).then((function(t){return 0===t.err_no&&e.commentList.unshift(t.data),t}))},reset:function(){this.cleanFile(),this.cleanContent()},emojiToText:function(html){return html.replace(/<img.*?alt=".*?/g,"").replace(/".?src=.*?>/g,"")}},mounted:function(){var e=this;this.autoFocus&&this.$nextTick((function(){e.$refs.richInput.focus()}))}},D=(r(934),r(30)),component=Object(D.a)(P,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"outer-click",rawName:"v-outer-click",value:function(){return e.onOuterClick()},expression:"() => onOuterClick()"}],staticClass:"comment-form",class:{focused:e.focused,reply:!!e.comment,"sub-reply":!!e.parent,small:e.small}},[r("div",{staticClass:"avatar-box"},[r("avatar",{staticClass:"avatar",attrs:{user:e.me}})],1),r("div",{staticClass:"form-box",class:{disabled:e.submitting}},[r("auth-card",{attrs:{user:e.me},on:{click:e.onFormBoxClick}},[r("div",{staticClass:"input-box"},[r("div",{ref:"richInput",staticClass:"rich-input",class:{empty:e.empty},attrs:{contenteditable:"true",spellcheck:"false",placeholder:e.placeholder||"输入评论（Enter换行，"+e.sendTip+"发送）",disabled:!0},on:{focus:e.onFocus,input:e.onInput,paste:e.onPaste,keydown:e.onKeydown,keyup:function(e){e.stopPropagation()}}}),e.imagePreviewUrl?r("div",{staticClass:"image-preview-box"},[r("div",{staticClass:"image-preview",style:{backgroundImage:"url("+e.imagePreviewUrl+")"}}),r("div",{staticClass:"clean-btn",on:{click:e.cleanFile}},[r("svg",{attrs:{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[r("rect",{attrs:{width:"12",height:"12",rx:"2",fill:"#86909C"}}),e._v(" "),r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.98095 5.49307L8.22012 3.25389C8.28521 3.18881 8.39074 3.18881 8.45582 3.25389L8.69153 3.4896C8.75661 3.55468 8.75661 3.66021 8.69153 3.7253L6.45235 5.96447L8.69153 8.20364C8.75661 8.26873 8.75661 8.37426 8.69153 8.43934L8.45582 8.67505C8.39074 8.74013 8.28521 8.74013 8.22012 8.67505L5.98095 6.43587L3.74178 8.67505C3.67669 8.74013 3.57116 8.74013 3.50608 8.67505L3.27037 8.43934C3.20529 8.37426 3.20529 8.26873 3.27037 8.20364L5.50954 5.96447L3.27037 3.7253C3.20529 3.66021 3.20529 3.55468 3.27037 3.4896L3.50608 3.25389C3.57116 3.18881 3.67669 3.18881 3.74178 3.25389L5.98095 5.49307Z",fill:"white"}})])])]):e._e()])]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isActionBoxVisible||!e.small,expression:"isActionBoxVisible || !small"}],staticClass:"action-box"},[r("emoji",{directives:[{name:"show",rawName:"v-show",value:e.isActionBoxVisible,expression:"isActionBoxVisible"}],staticClass:"emoji-btn",on:{selectEmoji:e.updateEmoji}}),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isActionBoxVisible,expression:"isActionBoxVisible"}],staticClass:"image-btn",on:{click:e.showFileDialog}},[r("ImageIcon",{staticClass:"icon"}),r("span",[e._v("图片")])],1),r("div",{staticClass:"submit"},[r("span",{directives:[{name:"show",rawName:"v-show",value:e.isActionBoxVisible,expression:"isActionBoxVisible"}]},[e._v(e._s(e.sendTip))]),r("button",{staticClass:"submit-btn",attrs:{disabled:!e.canSubmit},on:{click:e.submit}},[e._v(e._s(e.submitButtonTitle))])])],1)],1),r("input",{ref:"input",staticClass:"hidden",attrs:{type:"file"},on:{change:function(t){return e.onFileSelected(t.target.files[0])}}})])}),[],!1,null,"372c6532",null);t.a=component.exports},872:function(e,t,r){"use strict";r.d(t,"B",(function(){return o})),r.d(t,"v",(function(){return c})),r.d(t,"A",(function(){return l})),r.d(t,"u",(function(){return d})),r.d(t,"t",(function(){return f})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return v})),r.d(t,"h",(function(){return m})),r.d(t,"b",(function(){return y})),r.d(t,"w",(function(){return _})),r.d(t,"x",(function(){return w})),r.d(t,"q",(function(){return E})),r.d(t,"r",(function(){return T})),r.d(t,"z",(function(){return S})),r.d(t,"s",(function(){return O})),r.d(t,"D",(function(){return C})),r.d(t,"j",(function(){return k})),r.d(t,"k",(function(){return L})),r.d(t,"i",(function(){return A})),r.d(t,"C",(function(){return R})),r.d(t,"g",(function(){return x})),r.d(t,"p",(function(){return P})),r.d(t,"c",(function(){return D})),r.d(t,"a",(function(){return I})),r.d(t,"y",(function(){return j})),r.d(t,"o",(function(){return M})),r.d(t,"n",(function(){return F})),r.d(t,"E",(function(){return B})),r.d(t,"l",(function(){return U})),r.d(t,"f",(function(){return N})),r.d(t,"m",(function(){return V}));var n=r(1);function o(e,t,r){return Object(n.c)({url:"/tag_api/v1/query_category_list",method:"POST",showError:e,headers:t,jsonBody:r})}function c(e,t,r){return Object(n.c)({url:"/study_api/v1/translate/query_claim",method:"POST",showError:e,headers:t,jsonBody:r})}function l(e,t,r){return Object(n.c)({url:"/study_api/v1/translate/query_user",method:"POST",showError:e,headers:t,jsonBody:r})}function d(e,t,r){return Object(n.c)({url:"/study_api/v1/translate/query_auto_claim",method:"POST",showError:e,headers:t,jsonBody:r})}function f(e,t,r){return Object(n.c)({url:"/study_api/v1/translate/query_all_recommend",method:"POST",showError:e,headers:t,jsonBody:r})}function h(data,e,t,r){return Object(n.c)({url:"/interact_api/v1/digg/cancel",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function v(data,e,t,r){return Object(n.c)({url:"/interact_api/v1/digg/save",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function m(data,e,t,r){return Object(n.c)({url:"/interact_api/v1/follow/undo",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function y(data,e,t,r){return Object(n.c)({url:"/content_api/v1/column/articles_cursor",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function _(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/query_recommend",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function w(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/query_recommend_list",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function E(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/publish_claim",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function T(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/publish_recommend",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function S(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/query_translate",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function O(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/publish_translate",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function C(data,e,t,r){return Object(n.c)({url:"/tag_api/v1/theme/list_by_hot",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function k(data,e,t,r){return Object(n.c)({url:"/recommend_api/v1/short_msg/detail_rec",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function L(data,e,t,r){return Object(n.c)({url:"/recommend_api/v1/short_msg/topic",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function A(data,e,t,r){return Object(n.c)({url:"/list_api/v1/annual/user_annual",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function R(data,e,t,r){return Object(n.c)({url:"/tag_api/v1/query_topic_detail",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function x(data,e,t,r){return Object(n.c)({url:"/interact_api/v1/follow/do",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function P(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/pre_query_status",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function D(data,e,t,r){return Object(n.c)({url:"/content_api/v1/short_msg/list_by_theme",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function I(data,e,t,r){return Object(n.c)({url:"/booklet_api/v1/reading/submit_progress",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function j(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/query_recommend_status",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function M(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/pre_lock_translate",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function F(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/pre_count",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function B(data,e,t,r){return Object(n.c)({url:"/tag_api/v1/topic/list_by_search_cursor",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function U(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/abstain_claim",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function N(data,e,t,r){return Object(n.c)({url:"/interact_api/v1/digg/user_list",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}function V(data,e,t,r){return Object(n.c)({url:"/study_api/v1/translate/pre_audit_translate",body:data,method:"POST",showError:e,headers:t,jsonBody:r})}},873:function(e,t,r){"use strict";r(137);var n=r(48);r(6);function o(e){return new Promise((function(t,r){var img=new window.Image;img.onload=function(){return t({width:img.naturalWidth,height:img.naturalHeight,url:e})},img.onerror=function(){return r()},img.src=e}))}var c=function(){return{loading:!1,loaded:!1,error:!1,src:null,imageStyle:{top:"",left:"",width:"",height:"",transform:""},token:Date.now()}},l={props:["backgroundColor","margin","full"],data:c,methods:{show:function(e){var t=e.thumbUrl,r=e.originalUrl,rect=e.rect;this.loadImage({originalUrl:r,rect:rect}),this.loadTumb({thumbUrl:t,rect:rect})},close:function(){Object.assign(this,c()),this.unlockScroll()},loadTumb:function(e){var t=this,r=e.thumbUrl,rect=e.rect,n=this.token;o(r).then((function(e){if(t.isInSameView(n)&&!t.loaded&&!t.error){var o=t.computeRenderedRect(e.width,e.height);t.applyRect(o),t.src=r,t.applyTransform(t.computeTransform(o,rect))}})).catch((function(e){t.isInSameView(n)&&console.error(e)}))},loadImage:function(e){var t=this,r=e.originalUrl,rect=e.rect,n=this.token;this.loading=!0,o(r).then((function(image){if(t.isInSameView(n)){var e=!!t.src,o=!t.full&&t.isLargeLongImage(image),c=t.computeRenderedRect(image.width,image.height,o);t.applyRect(c),t.src=r,t.loading=!1,t.loaded=!0,o&&t.lockScroll(),e||t.applyTransform(t.computeTransform(c,rect))}})).catch((function(e){t.isInSameView(n)&&(console.error(e),t.loading=!1,t.error=!0)}))},applyRect:function(rect){Object.assign(this.imageStyle,{top:rect.top+"px",left:rect.left+"px",width:rect.width+"px",height:rect.height+"px"})},applyTransform:function(e){var t=this;this.imageStyle.transform=e,this.$nextTick((function(){t.forceReflow(),t.imageStyle.transform=""}))},initScrollEventListener:function(){var e=this,t=this.$getBean("eventBus"),r=t.eventType.ROOT_CONTAINER_SCROLL;t.onVmLife(this,r,(function(){e.src&&e.close()}))},computeRenderedRect:function(e,t,r){var o=Object(n.h)(),c=this.getSafeAreaSize();if(r){var l=Math.min(o.width,e,960),d=l*t/e;return{top:0,left:(o.width-l)/2,width:l,height:d}}var f=e/c.width,h=t/c.height,v=Math.max(f,h,1),m=e/v,y=t/v;return{top:(o.height-y)/2,left:(o.width-m)/2,width:m,height:y}},computeTransform:function(e,rect){var t=rect.width/e.width,r=rect.height/e.height,n=rect.width-e.width,o=rect.height-e.height,c=rect.top-e.top+o/2,l=rect.left-e.left+n/2,d="translate3d(".concat(l,"px, ").concat(c,"px, 0)"),f="scale3d(".concat(t,", ").concat(r,", 1)");return"".concat(d," ").concat(f)},forceReflow:function(){document.body.clientWidth},isInSameView:function(e){return e===this.token},isLargeLongImage:function(image){var e=this.getSafeAreaSize(),t=e.width,r=e.height,n=r/t,o=image.height/image.width,c=o>1&&o>n;return(image.width>t||image.height>r)&&c},getSafeAreaSize:function(){var e=Object(n.h)(),t=e.width,r=e.height;return{width:Math.max(0,t-2*(+this.margin||0)),height:Math.max(0,r-2*(+this.margin||0))}},lockScroll:function(){var e=this.$getBean("eventBus");e.emit(e.eventType.LOCK_ROOT_CONTAINER_SCROLL)},unlockScroll:function(){var e=this.$getBean("eventBus");e.emit(e.eventType.UNLOCK_ROOT_CONTAINER_SCROLL)}},mounted:function(){this.initScrollEventListener()}},d=(r(918),r(30)),f=Object(d.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[e.src?n("div",{staticClass:"image-viewer",class:{loading:e.loading},on:{click:e.close}},[n("div",{staticClass:"image-box",style:{backgroundColor:e.backgroundColor}},[e.error?n("img",{staticClass:"image error",attrs:{src:r(874)}}):n("img",{staticClass:"image",style:e.imageStyle,attrs:{src:e.src}})])]):e._e()])}),[],!1,null,"10b7b0e6",null).exports,h=r(965),v=r.n(h),m=function(){return{isLargeLongMode:!1,isZoomMode:!1,loading:!1,loaded:!1,error:!1,src:null,offsetX:0,offsetY:0,canZoom:!1,token:Date.now()}},y={props:["backgroundColor","margin","full"],data:m,methods:{show:function(e){var t=e.thumbUrl,r=e.originalUrl,rect=e.rect;this.loadImage({originalUrl:r,rect:rect}),this.loadTumb({thumbUrl:t,rect:rect})},close:function(){this.destroyGesture(),Object.assign(this,m()),this.unlockScroll()},loadTumb:function(e){var t=this,r=e.thumbUrl,n=(e.rect,this.token);o(r).then((function(e){!t.isInSameView(n)||t.loaded||t.error||(t.src=r)})).catch((function(e){t.isInSameView(n)&&console.error(e)}))},loadImage:function(e){var t=this,r=e.originalUrl,n=(e.rect,this.token);this.loading=!0,o(r).then((function(image){if(t.isInSameView(n)){var e=!t.full&&t.isLargeLongImage(image);t.src=r,t.loading=!1,t.loaded=!0,t.isLargeLongMode=e,t.canZoom=t.isLargeImage(image),t.initGesture(),t.isLargeLongMode&&t.lockScroll()}})).catch((function(e){t.isInSameView(n)&&(console.error(e),t.loading=!1,t.error=!0)}))},isInSameView:function(e){return e===this.token},isLargeLongImage:function(image){var e=Object(n.h)(),t=e.width,r=e.height,o=r/t,c=image.height/image.width,l=c>1&&c>o;return(image.width>t||image.height>r)&&l},isLargeImage:function(image){var e=Object(n.h)(),t=e.width;return e.height<image.height||t<image.width},lockScroll:function(){var e=this.$getBean("eventBus");e.emit(e.eventType.LOCK_ROOT_CONTAINER_SCROLL)},unlockScroll:function(){var e=this.$getBean("eventBus");e.emit(e.eventType.UNLOCK_ROOT_CONTAINER_SCROLL)},initScrollEventListener:function(){var e=this,t=this.$getBean("eventBus"),r=t.eventType.ROOT_CONTAINER_SCROLL;t.onVmLife(this,r,(function(){e.src&&!e.isZoomMode&&e.close()}))},adjustOffset:function(){var e=Object(n.h)(),t=e.width,r=e.height,rect=this.$refs.image.getBoundingClientRect();rect.width<t?this.offsetX=0:rect.left>0?this.offsetX-=rect.left:rect.left+rect.width<t&&(this.offsetX+=t-rect.left-rect.width),rect.height<r?this.offsetY=0:rect.top>0?this.offsetY-=rect.top:rect.top+rect.height<r&&(this.offsetY+=r-rect.top-rect.height)},initGesture:function(){var e=this;this.$nextTick((function(){e.finger=new v.a(e.$refs.imageBox,{singleTap:function(t){e.isZoomMode?(e.isZoomMode=!1,e.offsetX=0,e.offsetY=0):e.close()},doubleTap:function(t){e.canZoom&&(e.isZoomMode=!e.isZoomMode,e.isZoomMode?e.lockScroll():(e.unlockScroll(),e.offsetX=0,e.offsetY=0))},pressMove:function(t){var r=t.deltaX,n=t.deltaY;e.isZoomMode&&(e.offsetX+=r,e.offsetY+=n)},touchEnd:function(){e.isZoomMode&&window.setTimeout((function(){e.adjustOffset()}),100)}})}))},destroyGesture:function(){this.finger&&this.finger.destroy()}},mounted:function(){this.initScrollEventListener()}},_=(r(919),Object(d.a)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[e.src?n("div",{staticClass:"image-viewer mobile",class:{loading:e.loading}},[n("div",{ref:"imageBox",staticClass:"image-box",class:{"large-long":e.isLargeLongMode},style:{backgroundColor:e.backgroundColor}},[e.error?n("img",{staticClass:"image error",attrs:{src:r(874)}}):n("img",{ref:"image",staticClass:"image",class:{zoom:e.isZoomMode},style:{transform:"translate3d("+e.offsetX+"px, "+e.offsetY+"px, 0)"},attrs:{src:e.src}})])]):e._e()])}),[],!1,null,"93a27598",null).exports),w=r(271);var E={components:{Desktop:f,Mobile:_},props:["selector","backgroundColor","margin","full"],data:function(){return{component:null}},methods:{attachContainer:function(e){this.container!==e&&(this.removeEventListener(),this.addEventListener(e),this.container=e)},onClick:function(e){var t,r=e.target;if(this.isMatched(r)){var n=(t=r).getAttribute("data-src")||t.getAttribute("src")||function(e){var t=(e.style.backgroundImage||"").match(/url\("?'?(.+?)"?'?\)/i);return t&&t[1]}(t);if(n){var o=Object(w.c)(n),rect=r.getBoundingClientRect();this.$refs.viewer.show({thumbUrl:n,originalUrl:o,rect:rect})}}},addEventListener:function(e){var t=this;e.__removeIamgeViewListener=Object(n.k)(e,"click",(function(e){t.onClick(e)}),!0)},removeEventListener:function(){this.container&&this.container.__removeIamgeViewListener()},isMatched:function(e){return!e.classList.contains("equation")&&!this.$el.contains(e)&&Object(n.j)(e,this.selector||"img")}},mounted:function(){this.component=this.$device.isMobile?"Mobile":"Desktop"},beforeDestroy:function(){this.removeEventListener()}},T=(r(920),Object(d.a)(E,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"image-viewer-box"},[t(this.component,{ref:"viewer",tag:"component",attrs:{selector:this.selector,"background-color":this.backgroundColor,margin:this.margin,full:this.full}})],1)}),[],!1,null,"5ca9a68f",null));t.a=T.exports},874:function(e,t,r){e.exports=r.p+"img/image-error.3338abe.png"},875:function(e,t,r){},876:function(e,t,r){},877:function(e,t,r){},878:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));r(83),r(45),r(26),r(19);var n=function(text){try{var textarea=document.createElement("textarea");document.body.appendChild(textarea),textarea.value=text,textarea.select(),document.execCommand("copy"),document.body.removeChild(textarea)}catch(e){throw"copy link error"}};function o(content){if(!(content=(null==content?void 0:content.trim())||""))return"";var e=((null==content?void 0:content.trim())||"").split("\n")[0];return e.length<=30?e:e.substring(0,30)}},879:function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"g",(function(){return c})),r.d(t,"b",(function(){return f})),r.d(t,"f",(function(){return h})),r.d(t,"a",(function(){return v})),r.d(t,"c",(function(){return m})),r.d(t,"e",(function(){return y}));r(45);var n=r(180);function o(e){e.preventDefault(),window.getSelection().deleteFromDocument&&window.getSelection().deleteFromDocument();try{var text=window.clipboardData.getData("Text");try{window.getSelection().createRange().pasteHTML(text)}catch(e){var t=document.createTextNode(text);window.getSelection().getRangeAt(0).insertNode(t)}}catch(t){var r=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertText",!1,r)}}function c(e){if(document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var r=window.getSelection();r.removeAllRanges(),r.addRange(t)}else if(document.selection){var n=document.body.createTextRange();n.moveToElementText(e),n.collapse(!1),n.select()}}function l(){return"function"==typeof document.createRange||"function"==typeof window.getSelection}function d(){var e=null,t=null;return l?(t=document.getSelection()).getRangeAt&&t.rangeCount&&(e=document.getSelection().getRangeAt(0)):e=document.selection.createRange(),e}function f(html){var text=html;return text=text.replace(/<\s*script[^>]*>[\s\S]*?<\/script>/gim,"").replace(/<\s*style[^>]*>[\s\S]*?<\/style>/gim,"").replace(/<!--.*?-->/gim,"").replace(/<!DOCTYPE.*?>/gi,"").replace(/<\/div>/gi,"").replace(/(<br><div>|<div>|<br>)/gi,"\n").replace(/&nbsp;/gi,"").replace(/<.*?>/gi,"").replace(/&lt;/gi,"<").replace(/&amp;/gi,"&").replace(/&gt;/gi,">").replace(/&#39;/gi,"'").replace(/&quot;/g,'"')}function h(e,t){var r="",n=e.clipboardData.items;if(n){for(var i=0;i<n.length;i++)-1!=n[i].type.indexOf("image")&&(r=n[i].getAsFile());"function"==typeof t&&r&&t(r)}}function v(e){window.getSelection().deleteFromDocument&&window.getSelection().deleteFromDocument();try{return window.clipboardData.getData("Text")}catch(t){return(e.originalEvent||e).clipboardData.getData("text/plain")}}function m(e,html){var t,r,n=d();if(n&&function e(t,r){return!(!r||!t)&&(t===r||e(t,r.parentElement))}(e,n.startContainer)||c(e),e.focus(),window.getSelection){if((t=window.getSelection()).getRangeAt&&t.rangeCount){(r=t.getRangeAt(0)).deleteContents(),(e=document.createElement("div")).innerHTML=html;for(var o,l,f=document.createDocumentFragment();o=e.firstChild;)l=f.appendChild(o);r.insertNode(f),l&&((r=r.cloneRange()).setStartAfter(l),r.collapse(!0),t.removeAllRanges(),t.addRange(r))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(html)}function y(e){var t=d(),r=t.startContainer;if(3===r.nodeType){for(var text=r.nodeValue,o=t.startOffset-1,c=t.endOffset-1,f=[];o>=0;){if("["===text[o]){f[0]=o;break}o--}for(;c<=text.length-1;){if("]"===text[c]){f[1]=c;break}c++}if(void 0!==f[0]&&void 0!==f[1]){var h=text.slice(f[0],f[1]+1),v=Object(n.c)(h);if(v){var y=document.createRange();y.setStart(r,f[0]),y.setEnd(r,f[1]+1),function(e){if(e){var t=null,r=null;l?((r=document.getSelection()).removeAllRanges(),r.addRange(e)):((t=document.selection.createRange()).setEndPoint("EndToEnd",e),0===e.text.length?t.collapse(!1):t.setEndPoint("StartToStart",e),t.select())}}(y),m(e,v)}}}}},880:function(e,t,r){"use strict";var n,o;r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return o})),r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return f})),r.d(t,"f",(function(){return h})),function(e){e.UNPLAY="unplay",e.PLAYING="playing",e.PAUSED="paused",e.PLAYED="played"}(n||(n={})),function(e){e.detailRoute="bytetechVideoDetail",e.singleDetailRoute="bytetechVideoSingleDetail"}(o||(o={}));var c,l={routeName:"courseIndex",videoCategory:"bytetech",vipBookType:"vip"},d={title:"掘金课程是什么？",desc:"一个小篇幅、高浓度、成体系、有收益的技术学习平台",spreadQrcode:"https://z.juejin.cn/L54A"};!function(e){e.PutOnTimeSort="1",e.SaleCountDesc="7",e.PriceAsc="8",e.PriceDesc="9",e.DefaultSort="10"}(c||(c={}));var f={10:"recommend",7:"hot",1:"new",9:"price_h2l",8:"price_l2h"},h={discussTitle:"加入掘金会员，查看并参与课程讨论，字节内部课免费学",resouceTitle:"加入掘金会员，即可查看学习资料，字节内部课免费学"}},882:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));r(11),r(52),r(6),r(23);var n=r(5),o=r(1);function c(e,t){return l.apply(this,arguments)}function l(){return(l=Object(n.a)(regeneratorRuntime.mark((function e(t,o){var c,l,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.e(297).then(r.t.bind(null,1014,7));case 3:return c=e.sent,l=c.default,e.next=7,d();case 7:return h=e.sent,v=function(e){return new Promise((function(r,n){var o=new l({userId:t,appId:2608,imageConfig:{serviceId:"k3u1fbpfcp"}}),c=o.addFile({file:e,stsToken:h,type:"image"});o.start(c),o.on("complete",(function(e){r(e.uploadResult)})),o.on("error",(function(e){console.log(e.extra,"bytedUploader Error"),n(e.extra)}))}))},e.next=11,Promise.all(o.map(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:return r=e.sent,n=r.ImageHeight,o=r.ImageWidth,c=r.Uri,e.next=8,f(c);case 8:return l=e.sent,e.abrupt("return",{ImageHeight:n,ImageWidth:o,Uri:c,Url:l.data.main_url});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(0),new Error("上传图片失败");case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function d(){return Object(o.e)({url:"/imagex/gen_token",query:{client:"web"}}).then((function(e){return e.data.token}))}function f(e){return Object(o.e)({url:"/imagex/get_img_url",query:{uri:e}})}},885:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"a",(function(){return d}));var n=["jpg","jpeg","png","gif","webp"],o=5242880,c=9,l=1e3,d=["jpg","png","gif"]},886:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));r(44),r(55);var n=r(17),o={left:[{id:0,title:"综合"},{id:2,title:"文章"},{id:12,title:"课程"},{id:9,title:"标签"},{id:1,title:"用户"}],right:[{id:0,title:"时间不限"},{id:1,title:"最近一天"},{id:2,title:"最近一周"},{id:3,title:"最近三月"}]},c=function(){return document.referrer.includes("/search")},l=function(){if(!c())return{};try{var e=sessionStorage.getItem("SEARCH_PARAMS"),t=JSON.parse(e),r=t.query,o=t.search_attached_info,l=void 0===o?"":o,d=t.rank,f=t.display_search_type;return{query:r,detail_from:n.g.Search,search_attached_info:l,rank:d,display_search_type:f}}catch(e){return{}}}},887:function(e,t,r){},888:function(e,t,r){e.exports=r.p+"c5c64e06a56896da43c1d084d2482cf3.svg"},889:function(e,t,r){e.exports=r.p+"bd960fe696b2c2b82cea3c0e2e2f2aae.svg"},890:function(e,t,r){e.exports=r.p+"062856d97fc330530a3a64c01d915edc.svg"},891:function(e,t,r){e.exports=r.p+"img/loading.b144729.png"},892:function(e,t,r){e.exports=r.p+"img/loading-light.e96acb8.png"},893:function(e,t,r){"use strict";r(869)},894:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r(39),r(21),r(22),r(426),r(6);var n=[{name:"jpg",regx:/^ffd8ff/},{name:"gif",regx:/^474946/},{name:"png",regx:/89504e47/},{name:"webp",regx:/57454250/},{name:"bmp",regx:/^424d/},{name:"any",regx:/./}];function o(e,t){return function(e){return new Promise((function(t,r){var n=new FileReader;n.onload=function(e){return t(e.target.result)},n.onerror=function(e){return r(e)},n.readAsArrayBuffer(e.slice(0,64))}))}(e).then(c).then(l.bind(null,t))}function c(e){return Array.prototype.slice.call(new Uint8Array(e)).reduce((function(e,data){return e+data.toString(16)}),"")}function l(e,header){for(var i=0;i<n.length;i++)if(n[i].regx.test(header))return-1!==e.indexOf(n[i].name);return!1}},895:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.56162 2.16903C8.66569 2.09612 8.78195 2.06075 8.88247 2.09071C8.97653 2.11874 9.23851 2.25868 9.50988 2.9675C9.64419 3.31832 9.9356 4.24191 9.42155 6.05383C9.29751 6.49103 9.61394 6.95254 10.0926 6.95922L13.492 7.00667L13.492 7.00672H13.4991C13.6049 7.00672 13.7228 7.01937 13.8134 7.05849C13.8544 7.07622 13.8815 7.0959 13.8999 7.11552C13.9166 7.13326 13.9368 7.16198 13.9515 7.21587C13.9848 7.33735 14.0228 7.74663 13.9473 8.42213C13.874 9.07808 13.698 9.9443 13.341 10.9593C13.0424 11.8083 12.6601 12.5287 12.0684 13.4874C12.0558 13.5047 12.0462 13.5192 12.0418 13.526L12.0404 13.528C12.0292 13.5449 12.0242 13.5526 12.018 13.5613C12.0076 13.5759 12.0018 13.5815 11.9983 13.5845C11.996 13.5865 11.9908 13.5907 11.9777 13.5954C11.9638 13.6004 11.9311 13.6095 11.8706 13.6095H5.56278L5.56373 6.58441C5.87126 6.41852 6.19881 6.20079 6.54112 5.8401C6.93883 5.42103 7.33789 4.82891 7.76254 3.94134C7.84974 3.75908 7.91745 3.55913 7.97574 3.37714C7.99264 3.32437 8.0087 3.2733 8.02438 3.22344L8.02439 3.2234C8.066 3.09109 8.10495 2.96727 8.14985 2.84264C8.2758 2.49303 8.40247 2.28052 8.56162 2.16903ZM10.452 2.6068C10.1323 1.7716 9.70208 1.28228 9.17063 1.12389C8.64564 0.967414 8.20308 1.18842 7.98278 1.34276C7.55169 1.64476 7.33837 2.11859 7.20071 2.50071C7.14817 2.64656 7.10002 2.79968 7.05661 2.93775C7.0422 2.98357 7.02832 3.02773 7.01496 3.06941C6.95791 3.24755 6.90763 3.39066 6.85248 3.50594C6.45683 4.33291 6.1121 4.82661 5.80935 5.14563C5.51322 5.45766 5.23983 5.62142 4.9473 5.76772C4.71095 5.88592 4.55494 6.12857 4.55491 6.40111L4.55388 13.912C4.55383 14.3021 4.87002 14.6183 5.26008 14.6183H11.8706C12.2097 14.6183 12.4663 14.5109 12.6519 14.3531C12.7387 14.2792 12.7988 14.2038 12.8387 14.1479C12.8556 14.1243 12.8704 14.102 12.8786 14.0895L12.8813 14.0854L12.8826 14.0835L12.8955 14.068L12.9142 14.0377C13.5304 13.0409 13.9578 12.2465 14.2927 11.294C14.6745 10.2085 14.8679 9.26762 14.9499 8.53421C15.0297 7.82035 15.009 7.25796 14.9246 6.94965C14.805 6.51236 14.5104 6.26063 14.2134 6.13235C13.9385 6.01358 13.661 5.9981 13.5028 5.99787L10.4907 5.95583C10.9296 4.15742 10.648 3.11853 10.452 2.6068ZM1.0008 6.46734C0.981809 6.06471 1.30313 5.72787 1.70621 5.72787H2.75264C3.14266 5.72787 3.45883 6.04405 3.45883 6.43407V13.9437C3.45883 14.3337 3.14266 14.6499 2.75264 14.6499H2.06044C1.68335 14.6499 1.37279 14.3536 1.35502 13.977L1.0008 6.46734Z",fill:"#8A919F"}})]))}}},896:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.452 2.6068C10.1323 1.7716 9.70208 1.28228 9.17063 1.12389C8.64564 0.967414 8.20308 1.18842 7.98278 1.34276C7.55169 1.64476 7.33837 2.11859 7.20071 2.50071C7.14817 2.64655 7.10003 2.79966 7.05661 2.93773L7.05661 2.93775C7.0422 2.98357 7.02832 3.02773 7.01496 3.06941C6.95791 3.24755 6.90763 3.39066 6.85248 3.50594C6.45683 4.33291 6.1121 4.82661 5.80935 5.14563C5.51322 5.45766 5.23983 5.62142 4.9473 5.76772C4.71095 5.88592 4.55494 6.12857 4.55491 6.40111L4.55388 13.912C4.55383 14.3021 4.87002 14.6183 5.26008 14.6183H11.8706C12.2097 14.6183 12.4663 14.5109 12.6519 14.3531C12.7388 14.2792 12.7988 14.2038 12.8387 14.1479C12.8556 14.1243 12.8704 14.102 12.8786 14.0895L12.8813 14.0854L12.8826 14.0835L12.8955 14.068L12.9142 14.0377C13.5304 13.0409 13.9578 12.2465 14.2927 11.294C14.6745 10.2085 14.8679 9.26762 14.9499 8.53421C15.0297 7.82035 15.009 7.25796 14.9246 6.94965C14.805 6.51236 14.5104 6.26063 14.2134 6.13235C13.9385 6.01358 13.661 5.9981 13.5028 5.99787L10.4907 5.95583C10.9296 4.15742 10.648 3.11853 10.452 2.6068ZM1.0008 6.46734C0.981809 6.06471 1.30313 5.72787 1.70621 5.72787H2.75264C3.14266 5.72787 3.45883 6.04405 3.45883 6.43407V13.9437C3.45883 14.3337 3.14266 14.6499 2.75264 14.6499H2.06044C1.68335 14.6499 1.37279 14.3536 1.35502 13.977L1.0008 6.46734Z",fill:"#1E80FF"}})]))}}},897:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"#86909c",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14 1C14.3682 1 14.6667 1.29848 14.6667 1.66667V12.3333C14.6667 12.7015 14.3682 13 14 13H10.5924L8.44602 14.932C8.19248 15.1601 7.8076 15.1601 7.55406 14.932L5.40737 13H2.00004C1.63185 13 1.33337 12.7015 1.33337 12.3333V1.66667C1.33337 1.29848 1.63185 1 2.00004 1H14ZM13.3334 2.33333H2.6667V11.6667H5.919L8 13.5395L10.0807 11.6667H13.3334V2.33333ZM11.3334 6.66667C11.3334 6.48257 11.1841 6.33333 11 6.33333H5.00003C4.81594 6.33333 4.6667 6.48257 4.6667 6.66667V7.33333C4.6667 7.51743 4.81594 7.66667 5.00003 7.66667H11C11.1841 7.66667 11.3334 7.51743 11.3334 7.33333V6.66667Z"}})]))}}},898:function(e,t,r){},899:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 10.5759L13.4212 5.15476C13.5513 5.02459 13.7624 5.02459 13.8926 5.15476L14.364 5.62616C14.4941 5.75634 14.4941 5.96739 14.364 6.09757L8.4714 11.9901C8.21106 12.2505 7.78894 12.2505 7.5286 11.9901L1.63604 6.09757C1.50586 5.96739 1.50586 5.75634 1.63604 5.62616L2.10744 5.15476C2.23762 5.02459 2.44867 5.02459 2.57885 5.15476L8 10.5759Z",fill:"#4E5969"}})]))}}},900:function(e,t,r){},901:function(e,t,r){},902:function(e,t,r){},903:function(e,t,r){},904:function(e,t,r){},910:function(e,t,r){},911:function(e,t,r){},912:function(e,t,r){},918:function(e,t,r){"use strict";r(875)},919:function(e,t,r){"use strict";r(876)},920:function(e,t,r){"use strict";r(877)},921:function(e,t,r){"use strict";function n(e,t){if((10==e.keyCode||13==e.keyCode)&&(e.ctrlKey||e.metaKey))return t()}r.d(t,"a",(function(){return n}))},925:function(e,t,r){},929:function(e,t,r){"use strict";var n=r(8),o=r(969),c=r.n(o),l=Object(n.d)({components:{EmotionIcon:c.a,Picker:function(){return r.e(46).then(r.bind(null,4345))}},emits:["selectEmoji"],setup:function(e,t){var r=t.root,o=t.emit,c=Object(n.q)(!1);var l=Object(n.q)(!1),d=Object(n.w)(c,(function(){l.value=!0,d()}));return{once:l,visible:c,toggleShow:function(){var e=r.$store.getters.USER;return e?e.isBindedPhone?void(c.value=!c.value):r.$requestBindPhoneNumber():r.$requestLogin()},hide:function(){c.value=!1},handleChange:function(e){o("selectEmoji",e.source)}}}}),d=(r(970),r(30)),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"outer-click",rawName:"v-outer-click",value:e.hide,expression:"hide"}],staticClass:"emoji-container"},[r("div",{staticClass:"emoji-box",class:e.visible&&"active",on:{click:e.toggleShow}},[r("EmotionIcon",{staticClass:"icon"}),e._v(" "),r("span",[e._v("表情")])],1),e._v(" "),r("transition",{attrs:{name:"fade"}},[e.once?r("Picker",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],on:{change:e.handleChange}}):e._e()],1)],1)}),[],!1,null,"9fe533ba",null);t.a=component.exports},930:function(e,t,r){"use strict";var n={props:["user"],computed:{isVisible:function(){if(this.user){var e=this.user.isBindedPhone;return this.user&&!e}return!1}},methods:{bindPhone:function(){this.$requestBindPhoneNumber()}}},o=(r(971),r(30)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"auth-card"},[r("transition",{attrs:{name:"fade"}},[e.isVisible?r("div",{staticClass:"auth-cover"},[r("span",{staticClass:"hint"}),e._v("\n      您需要\n      "),r("a",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.bindPhone(t)}}},[e._v("绑定手机号")]),e._v("\n      后才可在社区内发布内容。\n    ")]):e._e()]),e._v(" "),e._t("default")],2)}),[],!1,null,"7c7c7498",null);t.a=component.exports},932:function(e,t,r){"use strict";r(1004);var n=r(30),component=Object(n.a)({},(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"container"},[t("em",{staticClass:"triangle"})])}],!1,null,"68da8972",null);t.a=component.exports},933:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14 1.3335C14.3514 1.3335 14.6394 1.60546 14.6648 1.95041L14.6666 2.00016V14.0002C14.6666 14.3516 14.3947 14.6396 14.0497 14.665L14 14.6668H1.99998C1.64853 14.6668 1.36059 14.3949 1.33514 14.0499L1.33331 14.0002V2.00016C1.33331 1.64871 1.60527 1.36077 1.95023 1.33532L1.99998 1.3335H14ZM13.3333 2.66618H2.66664V13.3328H13.3333V2.66618ZM11.9219 6.7879C11.9719 6.83791 12 6.90574 12 6.97647V11.7993C12 11.9098 11.9104 11.9993 11.8 11.9993H6.81615C6.7975 11.9993 6.77945 11.9968 6.76232 11.992L3.91042 11.9847C3.79996 11.9844 3.71063 11.8947 3.7109 11.7842C3.71102 11.7313 3.73209 11.6807 3.76948 11.6433L6.52468 8.88807C6.62882 8.78393 6.79766 8.78393 6.9018 8.88807L8.17297 10.1593L11.5447 6.7879C11.6489 6.68376 11.8177 6.68376 11.9219 6.7879ZM5.99997 3.99951V5.99951H3.99997V3.99951H5.99997Z"}})]))}}},934:function(e,t,r){"use strict";r(887)},936:function(e,t,r){"use strict";r(23);var n=r(5),o=r(67),c=r(48),l=r(873),d=r(856),f=r(178),h=r(858),v=r(870),m=r(182),y=r(867),_=r(853),w=r(59),E=r(272),T=r(180),S=r(895),O=r.n(S),C=r(896),k=r.n(C),L=r(897),A=r.n(L),R=r(179),x={components:{CommentForm:v.a,UserPopover:y.default,Avatar:f.a,Thumb:h.a,LikeIcon:O.a,LikeActiveIcon:k.a,CommentIcon:A.a},props:["replyList","subject","parent","reply","removable","user","mode","isHiddenReply"],data:function(){return{likeLock:Object(d.a)(),isReplyFormVisible:!1,isShowAll:!1,isLikeLoading:!1,replyCount:this.reply.reply_info.reply_count,extend:!1}},computed:{isMobile:function(){return this.$device.isMobile},parentReply:function(){var e,content=null===(e=this.reply.parent_reply)||void 0===e?void 0:e.reply_content;return this.hasParentRemove&&content?"该评论已被删除":content?Object(E.b)(content):""},hasParentRemove:function(){var e;return 0===(null===(e=this.reply.parent_reply)||void 0===e?void 0:e.reply_status)},currentUser:function(){var e=this.$store.getters;return"USER"in e?e.USER:null},removableReply:function(){return this.removable||this.isCurrentUsersReply()},hasAuthorBadge:function(){return this.subject.user_id===this.reply.user_info.user_id},imageUrl:function(){return this.reply.reply_info.reply_pics[0]&&this.reply.reply_info.reply_pics[0].pic_url},limitedContent:function(){return Object(m.d)(this.reply.reply_info.reply_content,{maxLineCount:this.maxLineCount,perLineLength:this.perLineLength,escapeReg:T.a})},collapsed:function(){return this.limitedContent.length<this.reply.reply_info.reply_content.length&&!this.isShowAll&&this.reply.reply_info.reply_content.length-this.limitedContent.length>this.perLineLength},replyPlaceholder:function(){return"回复".concat(this.reply.user_info.user_name,"...")},perLineLength:function(){return this.$device.isMobile?30:40},maxLineCount:function(){return this.$device.isMobile?4:6},isAutoFocus:function(){return!this.user||this.user.isBindedPhone}},methods:{parseUrlEmoji:E.b,onSyncCommentNum:function(e){"add"===e.type&&(this.replyCount=this.replyCount+(e.count||1)),"sub"===e.type&&(this.replyCount=this.replyCount-(e.count||1)),this.$emit("syncCommentNum",e)},isCurrentUsersReply:function(){return this.currentUser&&this.currentUser.user_id===this.reply.user_info.user_id},toggleLike:function(){var e=this;return this.currentUser?this.currentUser.isBindedPhone?void(this.isLikeLoading||this.$ensureAuthorized().then((function(){e.isLikeLoading=!0,e.reply.user_interact.is_digg?Object(w.c)({itemId:e.reply.reply_info.reply_id,type:6}).then((function(t){e.isLikeLoading=!1,0!==t.err_no?e.$error(t.err_msg):(e.reply.reply_info.digg_count--,e.reply.user_interact.is_digg=!e.reply.user_interact.is_digg)})):(Object(w.b)({itemId:e.reply.reply_info.reply_id,type:6}).then((function(t){e.isLikeLoading=!1,0!==t.err_no?e.$error(t.err_msg):(e.reply.reply_info.digg_count++,e.reply.user_interact.is_digg=!e.reply.user_interact.is_digg)})),e.$TEA("like_action",{like_comment_mode:e.mode}))}))):this.$requestBindPhoneNumber(R.a.interact):this.$requestLogin()},onReplyFormEmptyBlur:function(){var e=this;window.setTimeout((function(){e.isReplyFormVisible=!1}))},onSubmitted:function(){this.isReplyFormVisible=!1,this.$emit("submitted")},deleteComment:function(e){var t=this;this.$ensureAuthorized("login").then((function(){window.confirm("确定删除这条评论吗？")&&Object(_.b)({comment_id:e.reply_info.reply_comment_id,reply_id:e.reply_info.reply_id}).then((function(){t.replyList.some((function(r,n){r.reply_info.reply_id===e.reply_info.reply_id&&t.replyList.splice(n,1)})),t.$alertMsg("删除成功"),t.$emit("syncCommentNum",{type:"sub"})})).catch((function(){t.$alertMsg("删除失败，刷新后重试")}))}))}},mounted:function(){var e=this.$refs.content;if(e){var t=e.clientHeight;e.scrollHeight>t&&(this.extend=!0)}}},P=(r(944),r(30)),D=Object(P.a)(x,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"subcomment"},[r("UserPopover",{attrs:{"user-id":e.reply.user_info.user_id,"show-jscore-level":!0}},[r("app-link",{staticClass:"user-link",attrs:{to:e.$userRoute(e.reply.user_info.user_id),blank:!0}},[r("Avatar",{staticClass:"avatar",attrs:{user:e.reply.user_info,size:48}})],1)],1),e._v(" "),r("div",{staticClass:"content-box"},[r("div",{staticClass:"content-wrapper"},[r("span",{staticClass:"delete",class:{removable:e.removableReply},on:{click:function(t){return e.deleteComment(e.reply)}}},[e._v("\n        删除\n      ")]),e._v(" "),r("div",{staticClass:"user-box"},[r("UserPopover",{attrs:{"user-id":e.reply.user_info.user_id,"show-jscore-level":!0}},[r("username",{staticClass:"username",attrs:{user:e.reply.user_info,universal:!0,"show-jpower-level":!1}})],1),e._v(" "),e.hasAuthorBadge&&!e.isMobile?r("span",{staticClass:"author-badge-text"},[e._v("\n          （作者）\n        ")]):e._e(),e._v(" "),e.reply.reply_user&&e.reply.reply_user.user_name&&!e.isMobile?r("div",{staticClass:"rely-box"},[r("span",[e._v("回复")]),e._v(" "),r("UserPopover",{attrs:{"user-id":e.reply.reply_user.user_id,"show-jscore-level":!0}},[r("app-link",{staticClass:"repliedname",attrs:{to:e.$userRoute(e.reply.reply_user)}},[e._v("\n              "+e._s(e.reply.reply_user.user_name)+"\n            ")])],1)],1):e._e(),e._v(" "),r("span",{staticClass:"divide"}),e._v(" "),r("time",{staticClass:"time",attrs:{datetime:e._f("iso")(1e3*e.reply.reply_info.ctime),title:new Date(1e3*e.reply.reply_info.ctime)}},[e._v("\n          "+e._s(e._f("relative")(1e3*e.reply.reply_info.ctime))+"\n        ")])],1),e._v(" "),r("div",{ref:"content",staticClass:"content",class:{extend:e.isShowAll,hasimage:!!e.imageUrl},domProps:{innerHTML:e._s(e.parseUrlEmoji(e.reply.reply_info.reply_content))}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.extend&&!e.isShowAll,expression:"extend && !isShowAll"}],staticClass:"limit-btn",on:{click:function(t){e.isShowAll=!0}}},[e._v("\n        展开\n      ")]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.extend&&e.isShowAll,expression:"extend && isShowAll"}],staticClass:"limit-btn",on:{click:function(t){e.isShowAll=!1}}},[e._v("\n        收起\n      ")]),e._v(" "),e.imageUrl?r("Thumb",{staticClass:"viewable",attrs:{"data-src":e.imageUrl,url:e.imageUrl,width:160,height:160,format:"jpg"}}):e._e(),e._v(" "),e.parentReply?r("div",{staticClass:"parent-wrapper"},[e.hasParentRemove?e._e():r("div",[e._v("“")]),e._v(" "),r("div",{staticClass:"parent-content",domProps:{innerHTML:e._s(e.parentReply)}}),e._v(" "),e.hasParentRemove?e._e():r("div",[e._v("”")])]):e._e(),e._v(" "),r("div",{staticClass:"action-box"},[r("div",{staticClass:"item dig-item",class:e.reply.user_interact.is_digg&&"active",on:{click:e.toggleLike}},[e.reply.user_interact.is_digg?r("LikeActiveIcon"):r("LikeIcon"),e._v("\n          "+e._s(e.reply.reply_info.digg_count||"点赞")+"\n        ")],1),e._v(" "),e.isHiddenReply?e._e():r("div",{staticClass:"item",class:e.isReplyFormVisible&&"active",on:{click:function(t){e.isReplyFormVisible=!e.isReplyFormVisible}}},[r("CommentIcon"),e._v("\n          "+e._s(e.isReplyFormVisible?"取消回复":e.replyCount||"回复")+"\n        ")],1)])],1),e._v(" "),e.isReplyFormVisible?r("CommentForm",{staticClass:"replyform",attrs:{subject:e.subject,parent:e.parent,comment:e.reply,replyList:e.replyList,autoFocus:e.isAutoFocus,placeholder:e.replyPlaceholder,mode:e.mode},on:{emptyBlur:e.onReplyFormEmptyBlur,submitted:e.onSubmitted,syncCommentNum:e.onSyncCommentNum}}):e._e()],1)],1)}),[],!1,null,"1c6a2aac",null).exports,I=r(899),j=r.n(I),M={components:{SubComment:D,MoreIcon:j.a},props:["subject","parent","expanded","removable","user","mode","isHiddenReply"],data:function(){return{list:[],cursor:"0",limit:20,count:0,has_more:!0,loading:!1,showAll:!1}},computed:{canFetchMore:function(){var e=this.parent.comment_info.reply_count;return!!this.list.length&&(e>2&&e<=10&&(this.showAll=!0),this.expanded?"0"===this.cursor?this.parent.comment_info.reply_count>this.list.length:this.has_more:this.list.length&&this.parent.comment_info.reply_count>this.list.length)}},watch:{parent:function(e){this.list=e.reply_infos}},methods:{getRouterParams:function(){return{name:{2:"column",4:"pin",12:"book"}[this.subject.item_type],params:{id:this.subject.item_id}}},onSubmitted:function(){},refetch:function(){this.$emit("refetch")},fetchMore:function(){var e=this;!this.loading&&this.has_more&&(this.loading=!0,Object(_.f)({comment_id:this.parent.comment_info.comment_id,item_id:this.subject.item_id,item_type:this.subject.item_type,cursor:this.cursor,limit:this.limit}).then((function(t){var data=t.data,r=t.count,n=t.has_more,cursor=t.cursor;e.loading=!1,e.mergeList(data),e.count=r,e.has_more=n,e.cursor=cursor})).catch((function(t){e.loading=!1,console.error(t)})))},mergeList:function(e){var t,r=this.list.reduce((function(e,t){return e[t.reply_info.reply_id]=!0,e}),{}),n=e.filter((function(e){return!r[e.reply_info.reply_id]}));(t=this.list).push.apply(t,Object(o.a)(n))},onSyncCommentNum:function(e){this.$emit("syncCommentNum",e)}},created:function(){this.list=this.parent.reply_infos}},F=(r(945),Object(P.a)(M,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.list.length?r("div",{staticClass:"sub-comment-list"},[r("div",e._l(e.list,(function(t){return r("sub-comment",{key:t.reply_info.reply_id,staticClass:"sub-comment",attrs:{"data-comment-id":t.reply_info&&t.reply_info.reply_id,subject:e.subject,parent:e.parent,reply:t,replyList:e.list,removable:e.removable,user:e.user,mode:e.mode,isHiddenReply:e.isHiddenReply},on:{submitted:e.onSubmitted,refetch:e.refetch,syncCommentNum:e.onSyncCommentNum}})})),1),e._v(" "),e.canFetchMore&&e.has_more?r("div",{staticClass:"fetch-more"},[e.expanded||e.showAll?e.loading?r("span",{staticClass:"fetch-more-comment"},[e._v("加载中...")]):r("span",{staticClass:"fetch-more-comment",on:{click:e.fetchMore}},[e._v("\n      查看更多回复\n      "),r("MoreIcon")],1):r("app-link",{staticClass:"fetch-more-comment",attrs:{to:e.getRouterParams(),blank:!0}},[e._v("\n      查看更多回复\n    ")])],1):e._e()]):e._e()}),[],!1,null,"66f606e1",null).exports),B=r(7),U=r(946),N=r.n(U),V=r(880),H=Object(B.b)({components:{VideoSingleIcon:N.a},props:{comment:{type:Object,default:function(){return{}}}},setup:function(e,t){var r=t.root,n=Object(B.a)((function(){return r.$userPosition(e.comment.user_info)}));return{isMobile:r.$device.isMobile,position:n,getVideoDetailRoute:function(e){return{name:V.e.singleDetailRoute,params:{id:e.parent_id,sectionId:e.item_id}}}}}}),G=(r(947),Object(P.a)(H,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"comment-more-info"},[!e.isMobile&&e.position?r("span",{staticClass:"divide"}):e._e(),e._v(" "),e.position?r("span",{staticClass:"position"},[e._v("\n    "+e._s(e.position)+"\n  ")]):e._e(),e._v(" "),!e.isMobile||e.isMobile&&e.position?r("span",{class:{divide:!e.isMobile,dot:e.isMobile}}):e._e(),e._v(" "),r("time",{staticClass:"time",attrs:{datetime:e._f("iso")(1e3*e.comment.comment_info.ctime),title:new Date(1e3*e.comment.comment_info.ctime)}},[e._v("\n    "+e._s(e._f("relative")(1e3*e.comment.comment_info.ctime))+"\n  ")]),e._v(" "),e.comment.root_item&&e.comment.root_item.item_id?r("span",{staticClass:"dot"}):e._e(),e._v(" "),e.comment.root_item&&e.comment.root_item.item_id?r("router-link",{staticClass:"extra-info",attrs:{to:e.getVideoDetailRoute(e.comment.root_item)}},[r("div",{staticClass:"video-title"},[e._v("来自分辑-"+e._s(e.comment.root_item.title))]),e._v(" "),r("VideoSingleIcon",{staticClass:"single-video-icon"})],1):e._e()],1)}),[],!1,null,"29d7f98b",null).exports),K={components:{Avatar:f.a,Thumb:h.a,CommentForm:v.a,SubCommentList:F,UserPopover:y.default,LikeIcon:O.a,CommentIcon:A.a,LikeActiveIcon:k.a,CommentExtraInfo:G},props:["list","subject","comment","expanded","mode","isHiddenReply"],data:function(){return{likeLock:Object(d.a)(),isReplyFormVisible:!1,isShowAll:!1,isLikeLoading:!1,parseUrlEmoji:E.b,extend:!1,replyCount:this.comment.comment_info.reply_count}},computed:{isMobile:function(){return this.$device.isMobile},isDelete:function(){var e;return null===(e=this.comment.user_info)||void 0===e?void 0:e.is_logout},currentUser:function(){var e=this.$store.getters;return"USER"in e?e.USER:null},isCurrentUsersSubject:function(){return this.currentUser&&this.currentUser.user_id===this.subject.user_id},isCurrentUsersComment:function(){return this.currentUser&&this.currentUser.user_id===this.comment.user_info.user_id},isAdmin:function(){return this.currentUser&&"admin"===this.currentUser.role},hasAuthorBadge:function(){return this.subject.user_id===this.comment.user_info.user_id},removable:function(){return this.isAdmin||this.isCurrentUsersSubject||this.isCurrentUsersComment},mobile:function(){return this.$device.isMobile},imageUrl:function(){return this.comment.comment_info.comment_pics[0]&&this.comment.comment_info.comment_pics[0].pic_url},replyPlaceholder:function(){return"回复".concat(this.comment.user_info.user_name,"...")},isAutoFocus:function(){return!this.currentUser||this.currentUser.isBindedPhone}},methods:{toggleLike:function(){var e=this;return this.currentUser?this.currentUser.isBindedPhone?void(this.isLikeLoading||this.$ensureAuthorized().then((function(){e.isLikeLoading=!0,e.comment.user_interact.is_digg?Object(w.c)({itemId:e.comment.comment_info.comment_id,type:5}).then((function(t){e.isLikeLoading=!1,0!==t.err_no?e.$error(t.err_msg):(e.comment.comment_info.digg_count--,e.comment.user_interact.is_digg=!e.comment.user_interact.is_digg)})):(Object(w.b)({itemId:e.comment.comment_info.comment_id,type:5}).then((function(t){e.isLikeLoading=!1,0!==t.err_no?e.$error(t.err_msg):(e.comment.comment_info.digg_count++,e.comment.user_interact.is_digg=!e.comment.user_interact.is_digg)})),e.$TEA("like_action",{like_comment_mode:e.mode}))}))):this.$requestBindPhoneNumber(R.a.interact):this.$requestLogin()},onReplyFormEmptyBlur:function(){var e=this;window.setTimeout((function(){e.isReplyFormVisible=!1}))},onSubmitted:function(){this.isReplyFormVisible=!1,this.$refs.subCommentList.onSubmitted()},refetch:function(){this.$emit("refetch")},deleteComment:function(e){var t=this;this.$ensureAuthorized("login").then((function(){window.confirm("确定删除这条评论吗？")&&Object(_.a)({comment_id:e.comment_info.comment_id}).then((function(){t.list.some((function(r,n){r.comment_info.comment_id===e.comment_info.comment_id&&t.list.splice(n,1)})),t.$alertMsg("删除成功"),t.$emit("syncCommentNum",{type:"sub",count:e.reply_infos.length})})).catch((function(){t.$alertMsg("删除失败，刷新后重试")}))}))},onSyncCommentNum:function(e){"add"===e.type&&(this.replyCount=this.replyCount+(e.count||1)),"sub"===e.type&&(this.replyCount=this.replyCount-(e.count||1)),this.$emit("syncCommentNum",e)}},mounted:function(){var e=this.$refs.content;if(e){var t=e.clientHeight;e.scrollHeight>t&&(this.extend=!0)}}},$=(r(948),Object(P.a)(K,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"comment"},[r("UserPopover",{staticClass:"popover",attrs:{"user-id":e.comment.user_info.user_id,"enable-popover":Boolean(!e.isDelete),"show-jscore-level":!0}},[r("app-link",{staticClass:"user-link",attrs:{to:e.$userRoute(e.comment.user_info.user_id),blank:!0}},[r("Avatar",{staticClass:"avatar",attrs:{user:e.comment.user_info,alt:e.comment.user_info.user_name+"的头像"}})],1)],1),e._v(" "),r("div",{staticClass:"content-box"},[r("div",{staticClass:"comment-main"},[r("span",{staticClass:"delete",class:{removable:e.removable},on:{click:function(t){return e.deleteComment(e.comment)}}},[e._v("\n        删除\n      ")]),e._v(" "),r("div",{staticClass:"user-box"},[r("UserPopover",{attrs:{"user-id":e.comment.user_info.user_id,"enable-popover":Boolean(!e.isDelete),"show-jscore-level":!0}},[r("username",{staticClass:"username",attrs:{user:e.comment.user_info,universal:!0,"show-jscore-level":!0}})],1),e._v(" "),e.hasAuthorBadge&&!e.isMobile?r("span",{staticClass:"author-badge-text"},[e._v("\n          （作者）\n        ")]):e._e(),e._v(" "),e.isMobile?e._e():r("CommentExtraInfo",{attrs:{comment:e.comment}})],1),e._v(" "),e.isMobile?r("CommentExtraInfo",{attrs:{comment:e.comment}}):e._e(),e._v(" "),r("div",{ref:"content",staticClass:"content",class:{extend:e.extend&&e.isShowAll,hasimage:!!e.imageUrl},domProps:{innerHTML:e._s(e.parseUrlEmoji(e.comment.comment_info.comment_content))}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.extend&&!e.isShowAll,expression:"extend && !isShowAll"}],staticClass:"limit-btn",on:{click:function(t){e.isShowAll=!0}}},[e._v("\n        展开\n      ")]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.extend&&e.isShowAll,expression:"extend && isShowAll"}],staticClass:"limit-btn",on:{click:function(t){e.isShowAll=!1}}},[e._v("\n        收起\n      ")]),e._v(" "),e.imageUrl?r("Thumb",{staticClass:"viewable",attrs:{"data-src":e.imageUrl,url:e.imageUrl,width:160,height:160,format:"jpg"}}):e._e(),e._v(" "),r("div",{staticClass:"action-box"},[r("div",{staticClass:"action-left"},[r("div",{staticClass:"item dig-item",class:e.comment.user_interact.is_digg&&"active",on:{click:e.toggleLike}},[e.comment.user_interact.is_digg?r("LikeActiveIcon"):r("LikeIcon"),e._v("\n            "+e._s(e.comment.comment_info.digg_count||"点赞")+"\n          ")],1),e._v(" "),e.isHiddenReply?e._e():r("div",{staticClass:"item",class:e.isReplyFormVisible&&"active",on:{click:function(t){e.isReplyFormVisible=!e.isReplyFormVisible}}},[r("CommentIcon"),e._v("\n            "+e._s(e.isReplyFormVisible?"取消回复":e.replyCount||"回复")+"\n          ")],1)])])],1),e._v(" "),r("div",{staticClass:"subcomment-wrapper"},[e.isReplyFormVisible?r("CommentForm",{staticClass:"comment-form",attrs:{subject:e.subject,comment:e.comment,"reply-list":e.comment.reply_infos,"auto-focus":e.isAutoFocus,placeholder:e.replyPlaceholder,mode:e.mode},on:{emptyBlur:e.onReplyFormEmptyBlur,submitted:e.onSubmitted,syncCommentNum:e.onSyncCommentNum}}):e._e(),e._v(" "),r("SubCommentList",{ref:"subCommentList",attrs:{subject:e.subject,parent:e.comment,expanded:e.expanded,removable:e.isAdmin||e.isCurrentUsersSubject,user:e.currentUser,mode:e.mode,"is-hidden-reply":e.isHiddenReply},on:{refetch:e.refetch,syncCommentNum:e.onSyncCommentNum}})],1)])],1)}),[],!1,null,"35c9dead",null).exports),W={components:{ImageViewer:l.a,Comment:$},props:["subject","list","expanded","mode","isHiddenReply"],methods:{initImageViewer:function(){this.$refs.imageViewer.attachContainer(this.$el)},refetch:function(){this.$emit("refetch")},onSyncCommentNum:function(e){this.$emit("syncCommentNum",e)}},mounted:function(){this.initImageViewer()}},z=Object(P.a)(W,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"comment-list"},[r("ImageViewer",{ref:"imageViewer",attrs:{selector:".viewable"}}),e._v(" "),e._l(e.list,(function(t){return r("comment",{key:t.comment_id,staticClass:"comment",attrs:{"data-comment-id":t.comment_id,"data-comment-status":t.comment_info.comment_status,list:e.list,comment:t,subject:e.subject,expanded:e.expanded,isHiddenReply:e.isHiddenReply,mode:e.mode},on:{refetch:e.refetch,syncCommentNum:e.onSyncCommentNum}})}))],2)}),[],!1,null,null,null).exports,Y=r(8),X=r(949),Z=r.n(X),J=Object(Y.d)({props:{subject:{type:Object,required:!0}},components:{HotIcon:Z.a,CommentComp:$,ImageViewer:l.a},setup:function(e){var t=Object(Y.q)([]);Object(Y.x)((function(){var r=e.subject,n=r.item_id,o=r.item_type;n&&o&&Object(_.e)({item_id:n,item_type:o}).then((function(e){return t.value=e}))}));var r=Object(Y.a)((function(){return t.value.slice(0,5)})),n=Object(Y.q)(),o=Object(Y.q)();return Object(Y.w)([n,o],(function(){n.value&&o.value&&n.value.attachContainer(o.value)})),{list:r,imageViewer:n,commentContainer:o}}}),Q=(r(950),Object(P.a)(J,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.list.length>0?r("div",{staticClass:"container"},[r("ImageViewer",{ref:"imageViewer",attrs:{selector:".viewable"}}),e._v(" "),r("div",{staticClass:"title"},[e._v("\n    热门评论\n    "),r("HotIcon")],1),e._v(" "),r("div",{ref:"commentContainer",staticClass:"list"},e._l(e.list,(function(t){return r("CommentComp",{key:t.comment_id,attrs:{"data-comment-id":t.comment_id,list:e.list,comment:t,subject:e.subject,expanded:!0,mode:"top"}})})),1)],1):e._e()}),[],!1,null,"bfe15586",null).exports),ee={components:{CommentForm:v.a,CommentList:z,HotCommentList:Q,MoreIcon:j.a},props:["subject","expanded","sticky","forbidInput","small","hasSort","hasHot","threeSiftComment","isHiddenReply","isBestComment"],data:function(){return{list:[],cursor:"0",limit:20,count:0,has_more:!0,loading:!1,listSize:0,sort:"new",hasLoadMore:!1}},watch:{"subject.item_id":{handler:function(e){e&&!this.$isServer&&this.fetchData()}},sortData:{handler:function(){this.$isServer||this.fetchData()}}},computed:{sortData:function(){return{new:0,hot:1}[this.sort]||0}},methods:{setSort:function(e){this.$TEA("comment_switch",{switch:e}),this.sort=e},getMore:function(){var e=this;if(!this.expanded){var t=this.$router.resolve({name:{2:"column",4:"pin",12:"book"}[this.subject.item_type],params:{id:this.subject.item_id},hash:"#comment"}).href;window.open(t,"_blank")}if(this.expanded&&!this.hasLoadMore){this.hasLoadMore=!0,this.fetchMoreIfConditionIsSatisfied();var r=this.$getBean("eventBus");r.onVmLife(this,r.eventType.ROOT_CONTAINER_SCROLL,(function(){e.fetchMoreIfConditionIsSatisfied()})),Object(c.l)(this.$el,(function(){e.fetchMoreIfConditionIsSatisfied()}))}},fetchMore:function(){var e=this;if(!this.loading&&this.has_more){this.loading=!0;var t=this.subject,r=t.item_id,n=t.item_type;Object(_.d)({item_id:r,item_type:n,cursor:this.cursor,limit:this.limit,sort:this.sortData}).then((function(t){var data=t.data,cursor=t.cursor,r=t.count,n=t.has_more;e.listSize=data.length,e.loading=!1,e.mergeList(data),e.count=r,e.cursor=cursor,e.has_more=n})).catch((function(t){e.loading=!1,console.error(t)}))}},mergeList:function(e){var t,r=this.list.reduce((function(e,t){return e[t.comment_id]=!0,e}),{}),n=e.filter((function(e){return!r[e.comment_id]}));(t=this.list).push.apply(t,Object(o.a)(n))},fetchMoreIfConditionIsSatisfied:function(){Object(c.b)(this.$el)>-200&&this.fetchMore()},onRefetch:function(){this.fetchData()},onSyncCommentNum:function(e){this.$emit("syncCommentNum",e)},handleBookCommentScroll:function(){var e=this,t=document.documentElement.clientHeight,r=document.body.scrollHeight;if(document.documentElement.scrollTop+t>=r&&this.has_more&&!this.threeSiftComment){var n=this.subject,c=n.item_id,l=n.item_type;this.limit=this.expanded?20:5,Object(_.d)({item_id:c,item_type:l,cursor:this.cursor,limit:this.limit,sort:this.sortData}).then((function(t){var data=t.data,cursor=t.cursor,r=t.count,n=t.has_more,c=data.filter((function(e){return 5===e.comment_info.comment_status}));e.list=[].concat(Object(o.a)(e.list),Object(o.a)(c)),e.cursor=cursor,e.count=r,e.has_more=n}))}},fetchData:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,data,cursor,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.subject,n=r.item_id,o=r.item_type,!e.loading&&n){t.next=3;break}return t.abrupt("return");case 3:return e.loading=!0,e.limit=e.expanded?20:5,e.cursor="0",e.count=0,e.has_more=!0,t.prev=8,t.next=11,Object(_.d)({item_id:n,item_type:o,cursor:e.cursor,limit:e.limit,sort:e.sortData});case 11:c=t.sent,data=c.data,cursor=c.cursor,l=c.count,d=c.has_more,e.listSize=data.length,e.loading=!1,e.list=data,e.threeSiftComment&&data.length>3&&(e.list=e.list.filter((function(e){return 5===e.comment_info.comment_status})),e.list.length>3&&e.$emit("isListLenMore3"),e.list&&0!==e.list.length&&e.$emit("isShowCommentMode"),e.list=e.list.slice(0,3)),e.count=l,e.cursor=cursor,e.has_more=d,e.isBestComment&&(e.list=e.list.filter((function(e){return 5===e.comment_info.comment_status})),addEventListener("scroll",e.handleBookCommentScroll)),t.next=30;break;case 26:t.prev=26,t.t0=t.catch(8),e.loading=!1,console.error(t.t0);case 30:case"end":return t.stop()}}),t,null,[[8,26]])})))()}},mounted:function(){this.fetchData()},beforeDestroy:function(){removeEventListener("scroll",this.handleBookCommentScroll)}},te=(r(951),Object(P.a)(ee,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container",class:e.small&&"small",attrs:{"data-jj-helper":"comment-container"}},[e.forbidInput?e._e():r("CommentForm",{staticClass:"comment-form",class:{hasborder:e.list&&e.list.length},attrs:{commentList:e.list,subject:e.subject,small:e.small},on:{syncCommentNum:e.onSyncCommentNum}}),e._v(" "),e.hasHot?r("HotCommentList",{staticClass:"hot-list hasborder",attrs:{subject:e.subject}}):e._e(),e._v(" "),e.list.length?r("div",{staticClass:"comment-list-wrapper"},[r("div",{staticClass:"title"},[e._v("\n      全部评论（"+e._s(e.subject.comment_count)+"）\n      "),e.hasSort?r("div",{staticClass:"sort"},[r("div",{staticClass:"item",class:"new"===e.sort&&"active",on:{click:function(t){return e.setSort("new")}}},[e._v("\n          最新\n        ")]),e._v(" "),r("div",{staticClass:"divide"}),e._v(" "),r("div",{staticClass:"item",class:"hot"===e.sort&&"active",on:{click:function(t){return e.setSort("hot")}}},[e._v("\n          最热\n        ")])]):e._e()]),e._v(" "),r("comment-list",{staticClass:"comment-list",attrs:{list:e.list,subject:e.subject,expanded:e.expanded,isHiddenReply:e.isHiddenReply,mode:e.sort},on:{refetch:e.onRefetch,syncCommentNum:e.onSyncCommentNum}}),e._v(" "),e.list.length<e.subject.comment_count&&e.has_more?r("p",{staticClass:"fetch-more-comment",on:{click:e.getMore}},[e._v("\n      "+e._s(e.hasLoadMore?"加载中...":"查看全部 "+e.subject.comment_count+" 条回复")+"\n      "),e.expanded&&!e.hasLoadMore?r("MoreIcon"):e._e()],1):e._e()],1):e._e()],1)}),[],!1,null,"3f2ad607",null));t.a=te.exports},943:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return c}));r(45),r(135),r(83),r(21),r(22),r(6);function n(e,t){if(0===e)return 0;var r=function(e,t){var r,n,o=0,c=e.toString(),l=t.toString();try{o+=(null===(r=c.split(".")[1])||void 0===r?void 0:r.length)||0}catch(e){console.error(e)}try{o+=(null===(n=l.split(".")[1])||void 0===n?void 0:n.length)||0}catch(e){console.error(e)}c=Number(c.replace(".","")),l=Number(l.replace(".",""));var d=c*l/Math.pow(10,o),f=t>0?.01:0;return Math.max(f,d)}(e,isNaN(t)?1:t/10);return 0===r?0:r.toFixed(2)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{startTime:0,endTime:0},t=e.startTime,r=e.endTime,time=(new Date).getTime();return time>t&&time<r}function c(e){if(e<0||!e)return"0秒";if(0<=e&&e<60)return e+"秒";var t=Math.floor(e/60),s=Math.floor(e%60);return s>0?t+"分"+s+"秒":t+"分"}},944:function(e,t,r){"use strict";r(898)},945:function(e,t,r){"use strict";r(900)},946:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{d:"M8 6L4 9L4 3L8 6Z",fill:"#8A919F"}})]))}}},947:function(e,t,r){"use strict";r(901)},948:function(e,t,r){"use strict";r(902)},949:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{d:"M12.8 5.2C13.9532 6.46 14.8 8.2 14.8 10C14.7039 12.8937 12.6843 15.1706 9.97973 15.8159C10.359 12.3442 7.77588 9.35406 7.77588 9.35406C7.77588 9.35406 7.99512 13.7064 6.79514 15.8104C4.03715 15.1428 2 12.7806 2 9.8C2 7.776 2.9336 5.9728 4.4 4.8C5.8608 3.7056 6.8 1.9656 6.8 0C9.684 0.4368 11.894 2.9264 11.894 5.932C11.894 6.5012 11.746 7.0652 11.6 7.6C12.1264 6.9024 12.6184 6.0876 12.8 5.2Z",fill:"#F53F3F"}})]))}}},950:function(e,t,r){"use strict";r(903)},951:function(e,t,r){"use strict";r(904)},953:function(e,t,r){},954:function(e,t,r){},955:function(e,t,r){},960:function(e,t,r){"use strict";r.d(t,"c",(function(){return _})),r.d(t,"a",(function(){return w})),r.d(t,"b",(function(){return E}));var n=r(1092),o=r.n(n),c=r(1093),l=r.n(c),d=r(1094),f=r.n(d),h=r(1095),v=r.n(h),m=r(1096),y=r.n(m),_=function(s){return s.attributes["*"].push("data*"),s},w=["arduino","bash","c","cpp","csharp","css","diff","go","ini","java","javascript","json","kotlin","less","lua","makefile","markdown","objectivec","perl","php","phpTemplate","plaintext","python","pythonRepl","r","ruby","rust","scss","shell","sql","swift","typescript","vbnet","xml","yaml","html","dart","scala","vbscript","erlang","matlab"],E={vbscript:o.a,erlang:l.a,matlab:f.a,dart:v.a,scala:y.a}},969:function(e,t,r){r(16),r(15),r(11),r(6),r(14);var n=r(40),o=r(42);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),l=t.children,d=void 0===l?[]:l,f=data.class,h=data.staticClass,style=data.style,v=data.staticStyle,m=data.attrs,y=void 0===m?{}:m,_=o(data,["class","staticClass","style","staticStyle","attrs"]);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[f,h],style:[style,v],attrs:Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y)},_),d.concat([r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.00002 0.666504C12.0501 0.666504 15.3334 3.94975 15.3334 7.99984C15.3334 12.0499 12.0501 15.3332 8.00002 15.3332C3.94993 15.3332 0.666687 12.0499 0.666687 7.99984C0.666687 3.94975 3.94993 0.666504 8.00002 0.666504ZM8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2ZM10.6667 5.66667V7.66667H9.33333V5.66667H10.6667ZM6.66667 5.66667V7.66667H5.33333V5.66667H6.66667ZM10.0767 9.33333H11.0495C11.1804 9.33333 11.2866 9.43951 11.2866 9.57048C11.2866 9.60754 11.2779 9.64409 11.2612 9.67718L11.244 9.71053C10.6294 10.8739 9.40726 11.6667 7.99998 11.6667C6.61523 11.6667 5.40977 10.8991 4.7859 9.76612L4.73786 9.67593C4.67845 9.56052 4.72385 9.4188 4.83926 9.35939C4.87253 9.34226 4.90941 9.33333 4.94683 9.33333H5.92347C6.02396 9.33332 6.11908 9.37865 6.18238 9.4567C6.26207 9.55496 6.32833 9.62955 6.38117 9.68046C6.80074 10.0847 7.37133 10.3333 7.99998 10.3333C8.63289 10.3333 9.20694 10.0814 9.62728 9.67224C9.67791 9.62296 9.74135 9.55121 9.8176 9.45698C9.88089 9.37877 9.97611 9.33333 10.0767 9.33333Z"}})]))}}},970:function(e,t,r){"use strict";r(910)},971:function(e,t,r){"use strict";r(911)},972:function(e,t,r){e.exports=r.p+"img/auditing-placeholder.1726838.png"},973:function(e,t,r){e.exports=r.p+"img/auditing-placeholder-mobile.7c24b8f.png"},974:function(e,t,r){e.exports=r.p+"img/loading-placeholder.9112506.png"},975:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAq4AAAMMAQMAAACokrcUAAAABlBMVEUTGiQYIS3+UMXuAAAAgElEQVR42uzMMQ0AAAwCsPnXTMJU8LUCel2IVqvVarVarVar1Wq1Wq1Wq9VqtVqtVqvVttqFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPDtwSEBAAAAgKD/r11hAwAAAAAAAGATjapzHPFOaqgAAAAASUVORK5CYII="},976:function(e,t,r){"use strict";r(912)}}]);