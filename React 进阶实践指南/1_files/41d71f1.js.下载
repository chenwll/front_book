(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{2567:function(t,e,r){t.exports=r.p+"d3c620c1b3d224c4f822ef78449a9303.svg"},2568:function(t,e,r){},4210:function(t,e,r){"use strict";r(2568)},4355:function(t,e,r){"use strict";r.r(e);r(16),r(15),r(12),r(6),r(14);var n,o=r(0),l=(r(24),r(5)),c=r(7),v=r(294),d=r.n(v),_=r(120),h=r(109),f=r(858),m=r(68),O=r(177),w=r(10),y=(n={},Object(o.a)(n,w.ERROR_NO.GROWTH_LOTTERY_ZERO_CAP,"库存不足，兑换失败"),Object(o.a)(n,w.ERROR_NO.GROWTH_LACK_OF_POINT,"积分不足以兑换借阅卡"),Object(o.a)(n,w.ERROR_NO.EXCEED_REDEEM_LIMIT_YEARLY,"积分兑换已达上限"),Object(o.a)(n,w.ERROR_NO.EXCEED_BORROW_LIMIT_MONTHLY,"兑换超过上限"),Object(o.a)(n,0,"VIP课程借阅"),n),C=Object(o.a)({},w.ERROR_NO.EXCEED_BORROW_LIMIT_MONTHLY,"您本月已借满 6 门课程，请下个月再来哦~");function j(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function k(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?j(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):j(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var R=Object(c.b)({components:{CloseIcon:d.a,Thumb:f.a,BAlert:O.Alert},props:{bookInfo:{type:Object,default:function(){return{}}},teaParams:{type:Object,default:function(){return{}}}},emits:["closeVipBorrowModal","fetch"],setup:function(t,e){var r=Object(c.m)({}),n=Object(c.m)(0),o=Object(c.m)(!1),v=Object(c.m)(!1),d=Object(c.m)(!0),f=Object(c.m)(0),O=Object(c.m)(0),w=e.root.$getBean("eventBus"),j=Object(c.a)((function(){var t;return 2===(null===(t=r.value)||void 0===t?void 0:t.display_type)?r.value.discount||560:r.value.count||560})),R=function(){var c=Object(l.a)(regeneratorRuntime.mark((function l(){return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(d.value=!0,l.prev=1,!(f.value<=0)){l.next=9;break}return l.next=5,_.a.VipRedeem({lottery_type:6,got_channel:5,benefit_id:r.value.benefit_id});case 5:if(0===l.sent.err_no){l.next=9;break}return o.value=!0,l.abrupt("return");case 9:return l.next=11,h.a.BorrowBooklet({booklet_id:t.bookInfo.id});case 11:v.value=!0,e.root.$TEA("member_rent_result",k(k({},t.teaParams),{},{rent_count:t.bookInfo.borrowTimes+1})),setTimeout((function(){v.value=!1,E(),d.value=!1,w.emit(w.eventType.SHOW_VIP_FETCH)}),1e3),l.next=21;break;case 16:l.prev=16,l.t0=l.catch(1),o.value=!0,d.value=!1,n.value=(null===l.t0||void 0===l.t0?void 0:l.t0.statusCode)||0;case 21:case"end":return l.stop()}}),l,null,[[1,16]])})));return function(){return c.apply(this,arguments)}}();Object(c.j)(Object(l.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,d.value=!0,t.next=4,_.a.GetUserBorrowCondition();case 4:e=t.sent,f.value=e.data.borrow_card_num,O.value=e.data.get_all_point,f.value<=0&&(r.value=e.data.benefit.benefit_config),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),o.value=!0,n.value=(null===t.t0||void 0===t.t0?void 0:t.t0.statusCode)||0;case 14:d.value=!1;case 15:case"end":return t.stop()}}),t,null,[[0,10]])}))));var E=function(){e.emit("closeVipBorrowModal")};return{close:E,borrowCardNum:f,getAllPoint:O,borrow:R,defaultBookThumbUrl:m.c,loading:d,showError:o,showAlert:v,exchangePrice:j,titleMap:y,descriptMap:C,errorCode:n}}}),E=(r(4210),r(30)),component=Object(E.a)(R,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"masker"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"vip-borrow"},[n("div",{staticClass:"title",class:{"is-error":t.showError}},[t._v("\n      "+t._s(t.titleMap[t.errorCode]||"借阅失败")+"\n    ")]),t._v(" "),n("CloseIcon",{staticClass:"close",on:{click:t.close}}),t._v(" "),t.showError?n("div",{staticClass:"result-content content"},[n("div",{staticClass:"descript"},[t._v("\n        "+t._s(t.descriptMap[t.errorCode])+"\n      ")]),t._v(" "),n("div",{staticClass:"enter-button",on:{click:t.close}},[t._v("我知道了")])]):n("div",{staticClass:"content"},[t.borrowCardNum>0?n("div",{staticClass:"enough box"},[n("div",{staticClass:"words"},[t._v("\n          "+t._s("将消耗")+"\n          "),n("span",{staticClass:"num"},[t._v("1")]),t._v("\n          "+t._s("张课程借阅卡 （剩余:")+"\n          "),n("span",{staticClass:"num"},[t._v(t._s(t.borrowCardNum||0))]),t._v("\n          "+t._s("张）")+"\n        ")]),t._v(" "),n("div",{staticClass:"descript"},[t._v("\n          "+t._s("21天内畅读该课程全部章节")+"\n        ")])]):n("div",{staticClass:"not-enough box"},[n("div",{staticClass:"words"},[t._v("\n          "+t._s("借阅卡已用尽，是否消耗")+"\n          "),n("span",{staticClass:"num"},[t._v(t._s(t.exchangePrice))]),t._v(" "),n("img",{staticClass:"coral",attrs:{src:r(2567)}}),t._v("\n          "+t._s(" 兑换1张借阅卡?")+"\n        ")]),t._v(" "),n("div",{staticClass:"descript"},[t._v("\n          "+t._s("(剩余："+(t.getAllPoint||0))+"\n          "),n("img",{staticClass:"coral",attrs:{src:r(2567)}}),t._v("\n          "+t._s(")")+"\n        ")])]),t._v(" "),n("div",{staticClass:"img-container"},[n("thumb",{staticClass:"img",attrs:{alt:"「"+t.bookInfo.title+"」封面",url:t.bookInfo.cover,default:t.defaultBookThumbUrl,quality:95,width:100,height:140}}),t._v(" "),n("div",{staticClass:"mark"},[t._v("VIP")])],1),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"borrow-button",on:{click:t.borrow}},[t._v("\n        "+t._s(t.borrowCardNum>0?"确定借阅":"兑换并借阅")+"\n      ")])])],1),t._v(" "),t.showAlert?n("b-alert",{attrs:{type:"success","show-icon":!0}},[t._v("\n    借阅成功！21天内畅读课程，快来学习吧~\n  ")]):t._e()],1)}),[],!1,null,"6e72c201",null);e.default=component.exports},858:function(t,e,r){"use strict";r(135);var n=r(68),o=r(271),l=r(273),c=r(8),v=Object(c.d)({components:{Lazy:l.a},props:{url:{type:String},default:{type:String},quality:{type:Number},width:{type:Number,default:0},height:{type:Number,default:0},shrink:{type:Boolean},format:{type:String},alt:{type:String},blank:{type:String},hasMark:{type:Boolean,default:!1},lazy:{type:Boolean,default:!0}},computed:{defaultThumbUrl:function(){return this.default||n.h},thumbUrl:function(){var t=this.url||(this.blank?"":this.defaultThumbUrl);return this.shrink?Object(o.d)(t,this.width*n.l,this.height*n.l,{format:this.format,quality:this.quality},this.hasMark?"zoomCrop":"noMark"):Object(o.a)(t,this.width*n.l,this.height*n.l,{format:this.format,quality:this.quality},this.hasMark?"zoomCrop":"noMark")}}}),d=r(30),component=Object(d.a)(v,(function(){var t=this.$createElement;return(this._self._c||t)("lazy",{attrs:{url:this.thumbUrl,alt:this.alt,lazy:this.lazy,"loading-style":{aspectRatio:""+this.width/this.height}}})}),[],!1,null,null,null);e.a=component.exports}}]);